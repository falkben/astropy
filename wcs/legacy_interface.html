


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Legacy Interface &#8212; Astropy v5.2.dev96+g04a0cf8bb</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Supported projections" href="supported_projections.html" />
    <link rel="prev" title="Shared Python Interface for World Coordinate Systems" href="wcsapi.html" />
  
  <meta name="robots" content="noindex, nofollow">
  
  
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>


  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="supported_projections.html" title="Supported projections">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="wcsapi.html" title="Shared Python Interface for World Coordinate Systems">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">Astropy v5.2.dev96+g04a0cf8bb</a>
	 &#187;
      </li>
      <li><a href="index.html" accesskey="U">World Coordinate System (<code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.wcs</span></code>)</a> &#187;</li>
      
      <li>Legacy Interface</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="legacy-interface">
<span id="id1"></span><h1>Legacy Interface<a class="headerlink" href="#legacy-interface" title="Permalink to this headline">¶</a></h1>
<div class="section" id="astropy-wcs-api">
<h2>astropy.wcs API<a class="headerlink" href="#astropy-wcs-api" title="Permalink to this headline">¶</a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">Low</span> <span class="pre">Level</span> <span class="pre">API</span></code> or <code class="docutils literal notranslate"><span class="pre">Legacy</span> <span class="pre">Interface</span></code> is the original <a class="reference internal" href="reference_api.html#module-astropy.wcs" title="astropy.wcs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.wcs</span></code></a> API.
It supports three types of transforms:</p>
<ul class="simple">
<li><p>Core WCS, as defined in the <a class="reference external" href="https://fits.gsfc.nasa.gov/fits_wcs.html">FITS WCS standard</a>, based on Mark
Calabretta’s <a class="reference external" href="https://www.atnf.csiro.au/people/mcalabre/WCS/wcslib/index.html">wcslib</a>.  (Also includes <code class="docutils literal notranslate"><span class="pre">TPV</span></code> and <code class="docutils literal notranslate"><span class="pre">TPD</span></code>
distortion, but not <code class="docutils literal notranslate"><span class="pre">SIP</span></code>).</p></li>
<li><p>Simple Imaging Polynomial (<a class="reference external" href="https://irsa.ipac.caltech.edu/data/SPITZER/docs/files/spitzer/shupeADASS.pdf">SIP</a>) convention. (See <a class="reference internal" href="note_sip.html"><span class="doc">note about SIP in headers</span></a>.)</p></li>
<li><p>Table lookup distortions as defined in the FITS WCS <a class="reference external" href="https://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion paper</a>.</p></li>
</ul>
<p>Each of these transformations can be used independently or together in a standard pipeline.
All methods support scalar and array inputs. Note, that all methods require an additional
positional argument which is the <code class="docutils literal notranslate"><span class="pre">origin</span></code> of the inputs. It has two possible values - <code class="docutils literal notranslate"><span class="pre">0</span></code> -
for zero-based coordinates like numpy arrays or <code class="docutils literal notranslate"><span class="pre">1</span></code> - for 1-based coordinates, like
the FITS standard, or those coming from ds9.</p>
<p>The basic workflow is to create a WCS object calling the WCS constructor with an
<a class="reference internal" href="../io/fits/api/headers.html#astropy.io.fits.Header" title="astropy.io.fits.Header"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Header</span></code></a> and/or <a class="reference internal" href="../io/fits/api/hdulists.html#astropy.io.fits.HDUList" title="astropy.io.fits.HDUList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HDUList</span></code></a> object and calling
one of the methods below:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">wcs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.utils.data</span> <span class="kn">import</span> <span class="n">get_pkg_data_filename</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fn</span> <span class="o">=</span> <span class="n">get_pkg_data_filename</span><span class="p">(</span><span class="s1">&#39;data/j94f05bgq_flt.fits&#39;</span><span class="p">,</span> <span class="n">package</span><span class="o">=</span><span class="s1">&#39;astropy.wcs.tests&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wcsobj</span> <span class="o">=</span> <span class="n">wcs</span><span class="o">.</span><span class="n">WCS</span><span class="p">(</span><span class="n">f</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">f</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Optionally, if the FITS file uses any deprecated or non-standard features, you may need
to call one of the <a class="reference internal" href="../api/astropy.wcs.WCS.html#astropy.wcs.WCS.fix" title="astropy.wcs.wcs.WCS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fix</span></code></a> methods on the object.</p>
<p>Use one of the following transformation methods.</p>
<ol class="arabic simple">
<li><p>Between pixels and world coordinates using all distortions:</p></li>
</ol>
<blockquote>
<div><blockquote>
<div><ul>
<li><p><a class="reference internal" href="../api/astropy.wcs.WCS.html#astropy.wcs.WCS.all_pix2world" title="astropy.wcs.wcs.WCS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">all_pix2world</span></code></a>: Perform all three
transformations in series (core WCS, SIP and table lookup
distortions) from pixel to world coordinates.  Use this one
if you’re not sure which to use.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span> <span class="o">=</span> <span class="n">wcsobj</span><span class="o">.</span><span class="n">all_pix2world</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>  
<span class="go">5.528442425094046 -72.05207808966726</span>
</pre></div>
</div>
</li>
<li><dl>
<dt><a class="reference internal" href="../api/astropy.wcs.WCS.html#astropy.wcs.WCS.all_world2pix" title="astropy.wcs.wcs.WCS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">all_world2pix</span></code></a>: Perform all three</dt><dd><p>transformations (core WCS, SIP and table lookup
distortions) from world to pixel coordinates, using an
iterative method if necessary.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">wcsobj</span><span class="o">.</span><span class="n">all_world2pix</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span> <span class="c1"># </span>
<span class="go">30.00000214673885 39.999999958235094</span>
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
<ol class="arabic" start="2">
<li><p>Performing <a class="reference external" href="https://irsa.ipac.caltech.edu/data/SPITZER/docs/files/spitzer/shupeADASS.pdf">SIP</a> transformations only:</p>
<blockquote>
<div><ul>
<li><dl>
<dt><a class="reference internal" href="../api/astropy.wcs.WCS.html#astropy.wcs.WCS.sip_pix2foc" title="astropy.wcs.wcs.WCS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sip_pix2foc</span></code></a>: Convert from pixel to</dt><dd><p>focal plane coordinates using the <a class="reference external" href="https://irsa.ipac.caltech.edu/data/SPITZER/docs/files/spitzer/shupeADASS.pdf">SIP</a> polynomial
coefficients.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">xsip</span><span class="p">,</span> <span class="n">ysip</span> <span class="o">=</span> <span class="n">wcsobj</span><span class="o">.</span><span class="n">sip_pix2foc</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">xsip</span><span class="p">,</span> <span class="n">ysip</span><span class="p">)</span>  
<span class="go">-1985.8600487630586 -984.4223711273145</span>
</pre></div>
</div>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference internal" href="../api/astropy.wcs.WCS.html#astropy.wcs.WCS.sip_foc2pix" title="astropy.wcs.wcs.WCS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sip_foc2pix</span></code></a>: Convert from focal</dt><dd><p>plane to pixel coordinates using the <a class="reference external" href="https://irsa.ipac.caltech.edu/data/SPITZER/docs/files/spitzer/shupeADASS.pdf">SIP</a> polynomial
coefficients. Note that this method only works if the
inverse SIP distortion is specified in the header.</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</li>
<li><p>Performing <a class="reference external" href="https://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion paper</a> transformations only:</p>
<blockquote>
<div><ul class="simple">
<li><dl class="simple">
<dt><a class="reference internal" href="../api/astropy.wcs.WCS.html#astropy.wcs.WCS.p4_pix2foc" title="astropy.wcs.wcs.WCS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">p4_pix2foc</span></code></a>: Convert from pixel to</dt><dd><p>focal plane coordinates using the table lookup distortion
method described in the FITS WCS <a class="reference external" href="https://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion paper</a>.</p>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference internal" href="../api/astropy.wcs.WCS.html#astropy.wcs.WCS.det2im" title="astropy.wcs.wcs.WCS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">det2im</span></code></a>: Convert from detector</dt><dd><p>coordinates to image coordinates.  Commonly used for narrow
column correction.</p>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</li>
</ol>
</div></blockquote>
</div>
<div class="section" id="core-wcslib-api">
<h2>Core wcslib API<a class="headerlink" href="#core-wcslib-api" title="Permalink to this headline">¶</a></h2>
<p>The core wcslib API supports the FITS WCS standard defined in WCS
papers, I, II, III, IV. Note that distortions are not applied if
the functions in the core library are used.</p>
<ol class="arabic">
<li><p>From pixels to world coordinates:</p>
<blockquote>
<div><ul>
<li><dl>
<dt><a class="reference internal" href="../api/astropy.wcs.WCS.html#astropy.wcs.WCS.wcs_pix2world" title="astropy.wcs.wcs.WCS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">wcs_pix2world</span></code></a>: Perform just the core WCS</dt><dd><p>transformation from pixel to world coordinates.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span> <span class="o">=</span> <span class="n">wcsobj</span><span class="o">.</span><span class="n">wcs_pix2world</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">)</span>  
<span class="go">5.527103615238458 -72.0522441352217</span>
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</li>
<li><p>From world to pixel coordinates:</p>
<blockquote>
<div><ul>
<li><dl>
<dt><a class="reference internal" href="../api/astropy.wcs.WCS.html#astropy.wcs.WCS.wcs_world2pix" title="astropy.wcs.wcs.WCS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">wcs_world2pix</span></code></a>: Perform the core WCS transformation</dt><dd><p>from world to pixel coordinates.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">wcsobj</span><span class="o">.</span><span class="n">wcs_world2pix</span><span class="p">(</span><span class="n">lon</span><span class="p">,</span> <span class="n">lat</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>  
<span class="go">30.000000000223267 40.0000000003696</span>
</pre></div>
</div>
</dd>
</dl>
</li>
</ul>
</div></blockquote>
</li>
</ol>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Legacy Interface</a><ul>
<li><a class="reference internal" href="#astropy-wcs-api">astropy.wcs API</a></li>
<li><a class="reference internal" href="#core-wcslib-api">Core wcslib API</a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/wcs/legacy_interface.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011–2022, The Astropy Developers.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 3.5.4. &nbsp;
    Last built 09 May 2022. <br/>
  </p>
</footer>
  </body>
</html>