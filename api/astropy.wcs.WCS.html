


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>WCS &#8212; Astropy v5.2.dev94+gb1133d712.d20220509</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="WCSBase" href="astropy.wcs.WCSBase.html" />
    <link rel="prev" title="Tabprm" href="astropy.wcs.Tabprm.html" />
  
  <meta name="robots" content="noindex, nofollow">
  
  
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>


  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="astropy.wcs.WCSBase.html" title="WCSBase">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="astropy.wcs.Tabprm.html" title="Tabprm">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">Astropy v5.2.dev94+gb1133d712.d20220509</a>
	 &#187;
      </li>
      <li><a href="../wcs/index.html" >World Coordinate System (<code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.wcs</span></code>)</a> &#187;</li>
      <li><a href="../wcs/reference_api.html" accesskey="U">Reference/API</a> &#187;</li>
      
      <li>WCS</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="wcs">
<h1>WCS<a class="headerlink" href="#wcs" title="Permalink to this headline">¶</a></h1>
<dl class="py class">
<dt id="astropy.wcs.WCS">
<em class="property"><span class="pre">class</span> </em><code class="sig-prename descclassname"><span class="pre">astropy.wcs.</span></code><code class="sig-name descname"><span class="pre">WCS</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fobj</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'</span> <span class="pre">'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">minerr</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">relax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">naxis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">keysel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colsel</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fix</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">translate_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">_do_set</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astropy.wcs.WCS" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">astropy.wcs.wcsapi.fitswcs.FITSWCSAPIMixin</span></code>, <a class="reference internal" href="astropy.wcs.WCSBase.html#astropy.wcs.WCSBase" title="astropy.wcs.WCSBase"><code class="xref py py-class docutils literal notranslate"><span class="pre">astropy.wcs.WCSBase</span></code></a></p>
<p>WCS objects perform standard WCS transformations, and correct for
<a class="reference external" href="https://irsa.ipac.caltech.edu/data/SPITZER/docs/files/spitzer/shupeADASS.pdf">SIP</a> and <a class="reference external" href="https://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion paper</a> table-lookup transformations, based
on the WCS keywords and supplementary data read from a FITS file.</p>
<p>See also: <a class="reference external" href="https://docs.astropy.org/en/stable/wcs/">https://docs.astropy.org/en/stable/wcs/</a></p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>header</strong><span class="classifier"><a class="reference internal" href="../io/fits/api/headers.html#astropy.io.fits.Header" title="astropy.io.fits.Header"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Header</span></code></a>, <a class="reference internal" href="../io/fits/api/hdus.html#astropy.io.fits.PrimaryHDU" title="astropy.io.fits.hdu.image.PrimaryHDU"><code class="xref py py-obj docutils literal notranslate"><span class="pre">PrimaryHDU</span></code></a>, <a class="reference internal" href="../io/fits/api/images.html#astropy.io.fits.ImageHDU" title="astropy.io.fits.hdu.image.ImageHDU"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ImageHDU</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">str</span></code></a>, dict-like, or <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">None</span></code></a>, optional</span></dt><dd><p>If <em>header</em> is not provided or None, the object will be
initialized to default values.</p>
</dd>
<dt><strong>fobj</strong><span class="classifier"><a class="reference internal" href="../io/fits/api/hdulists.html#astropy.io.fits.HDUList" title="astropy.io.fits.HDUList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HDUList</span></code></a>, optional</span></dt><dd><p>It is needed when header keywords point to a <a class="reference external" href="https://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion
paper</a> lookup table stored in a different extension.</p>
</dd>
<dt><strong>key</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">str</span></code></a>, optional</span></dt><dd><p>The name of a particular WCS transform to use.  This may be
either <code class="docutils literal notranslate"><span class="pre">'</span> <span class="pre">'</span></code> or <code class="docutils literal notranslate"><span class="pre">'A'</span></code>-<code class="docutils literal notranslate"><span class="pre">'Z'</span></code> and corresponds to the
<code class="docutils literal notranslate"><span class="pre">&quot;a&quot;</span></code> part of the <code class="docutils literal notranslate"><span class="pre">CTYPEia</span></code> cards.  <em>key</em> may only be
provided if <em>header</em> is also provided.</p>
</dd>
<dt><strong>minerr</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">float</span></code></a>, optional</span></dt><dd><p>The minimum value a distortion correction must have in order
to be applied. If the value of <code class="docutils literal notranslate"><span class="pre">CQERRja</span></code> is smaller than
<em>minerr</em>, the corresponding distortion is not applied.</p>
</dd>
<dt><strong>relax</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bltin-boolean-values" title="(in Python v3.10)"><span class="xref std std-ref">bool</span></a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a>, optional</span></dt><dd><p>Degree of permissiveness:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> (default): Admit all recognized informal extensions
of the WCS standard.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>: Recognize only FITS keywords defined by the
published WCS standard.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>: a bit field selecting specific extensions to accept.
See <a class="reference internal" href="../wcs/relax.html#relaxread"><span class="std std-ref">Header-reading relaxation constants</span></a> for details.</p></li>
</ul>
</dd>
<dt><strong>naxis</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a> or <a class="reference external" href="https://docs.python.org/3/glossary.html#term-sequence" title="(in Python v3.10)"><span>sequence</span></a>, optional</span></dt><dd><p>Extracts specific coordinate axes using
<a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.sub" title="astropy.wcs.Wcsprm.sub"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sub()</span></code></a>.  If a header is provided, and
<em>naxis</em> is not <code class="docutils literal notranslate"><span class="pre">None</span></code>, <em>naxis</em> will be passed to
<a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.sub" title="astropy.wcs.Wcsprm.sub"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sub()</span></code></a> in order to select specific
axes from the header.  See <a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.sub" title="astropy.wcs.Wcsprm.sub"><code class="xref py py-meth docutils literal notranslate"><span class="pre">sub()</span></code></a> for
more details about this parameter.</p>
</dd>
<dt><strong>keysel</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/glossary.html#term-sequence" title="(in Python v3.10)"><span>sequence</span></a> of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">str</span></code></a>, optional</span></dt><dd><p>A sequence of flags used to select the keyword types
considered by wcslib.  When <code class="docutils literal notranslate"><span class="pre">None</span></code>, only the standard image
header keywords are considered (and the underlying wcspih() C
function is called).  To use binary table image array or pixel
list keywords, <em>keysel</em> must be set.</p>
<p>Each element in the list should be one of the following
strings:</p>
<ul class="simple">
<li><p>‘image’: Image header keywords</p></li>
<li><p>‘binary’: Binary table image array keywords</p></li>
<li><p>‘pixel’: Pixel list keywords</p></li>
</ul>
<p>Keywords such as <code class="docutils literal notranslate"><span class="pre">EQUIna</span></code> or <code class="docutils literal notranslate"><span class="pre">RFRQna</span></code> that are common to
binary table image arrays and pixel lists (including
<code class="docutils literal notranslate"><span class="pre">WCSNna</span></code> and <code class="docutils literal notranslate"><span class="pre">TWCSna</span></code>) are selected by both ‘binary’ and
‘pixel’.</p>
</dd>
<dt><strong>colsel</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/glossary.html#term-sequence" title="(in Python v3.10)"><span>sequence</span></a> of <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a>, optional</span></dt><dd><p>A sequence of table column numbers used to restrict the WCS
transformations considered to only those pertaining to the
specified columns.  If <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a>, there is no restriction.</p>
</dd>
<dt><strong>fix</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bltin-boolean-values" title="(in Python v3.10)"><span class="xref std std-ref">bool</span></a>, optional</span></dt><dd><p>When <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> (default), call <a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.fix" title="astropy.wcs.Wcsprm.fix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fix</span></code></a> on
the resulting object to fix any non-standard uses in the
header.  <a class="reference internal" href="astropy.wcs.FITSFixedWarning.html#astropy.wcs.FITSFixedWarning" title="astropy.wcs.FITSFixedWarning"><code class="xref py py-obj docutils literal notranslate"><span class="pre">FITSFixedWarning</span></code></a> Warnings will be emitted if any
changes were made.</p>
</dd>
<dt><strong>translate_units</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">str</span></code></a>, optional</span></dt><dd><p>Specify which potentially unsafe translations of non-standard
unit strings to perform.  By default, performs none.  See
<a class="reference internal" href="#astropy.wcs.WCS.fix" title="astropy.wcs.WCS.fix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WCS.fix</span></code></a> for more information about this parameter.  Only
effective when <code class="docutils literal notranslate"><span class="pre">fix</span></code> is <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><dl class="simple">
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#MemoryError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MemoryError</span></code></a></dt><dd><p>Memory allocation failed.</p>
</dd>
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ValueError</span></code></a></dt><dd><p>Invalid key.</p>
</dd>
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#KeyError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">KeyError</span></code></a></dt><dd><p>Key not found in FITS header.</p>
</dd>
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ValueError</span></code></a></dt><dd><p>Lookup table distortion present in the header but <em>fobj</em> was
not provided.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<ol class="arabic">
<li><p>astropy.wcs supports arbitrary <em>n</em> dimensions for the core WCS
(the transformations handled by WCSLIB).  However, the
<a class="reference external" href="https://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion paper</a> lookup table and <a class="reference external" href="https://irsa.ipac.caltech.edu/data/SPITZER/docs/files/spitzer/shupeADASS.pdf">SIP</a> distortions must be
two dimensional.  Therefore, if you try to create a WCS object
where the core WCS has a different number of dimensions than 2
and that object also contains a <a class="reference external" href="https://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion paper</a> lookup
table or <a class="reference external" href="https://irsa.ipac.caltech.edu/data/SPITZER/docs/files/spitzer/shupeADASS.pdf">SIP</a> distortion, a <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ValueError</span></code></a>
exception will be raised.  To avoid this, consider using the
<em>naxis</em> kwarg to select two dimensions from the core WCS.</p></li>
<li><p>The number of coordinate axes in the transformation is not
determined directly from the <code class="docutils literal notranslate"><span class="pre">NAXIS</span></code> keyword but instead from
the highest of:</p>
<blockquote>
<div><ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">NAXIS</span></code> keyword</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">WCSAXESa</span></code> keyword</p></li>
<li><p>The highest axis number in any parameterized WCS keyword.
The keyvalue, as well as the keyword, must be
syntactically valid otherwise it will not be considered.</p></li>
</ul>
</div></blockquote>
<p>If none of these keyword types is present, i.e. if the header
only contains auxiliary WCS keywords for a particular
coordinate representation, then no coordinate description is
constructed for it.</p>
<p>The number of axes, which is set as the <code class="docutils literal notranslate"><span class="pre">naxis</span></code> member, may
differ for different coordinate representations of the same
image.</p>
</li>
<li><p>When the header includes duplicate keywords, in most cases the
last encountered is used.</p></li>
<li><p><a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.set" title="astropy.wcs.Wcsprm.set"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set</span></code></a> is called immediately after
construction, so any invalid keywords or transformations will
be raised by the constructor, not when subsequently calling a
transformation method.</p></li>
</ol>
<p class="rubric">Attributes Summary</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#astropy.wcs.WCS.array_shape" title="astropy.wcs.WCS.array_shape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array_shape</span></code></a></p></td>
<td><p>The shape of the data that the WCS applies to as a tuple of length <a class="reference internal" href="astropy.wcs.wcsapi.BaseLowLevelWCS.html#astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_n_dim" title="astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_n_dim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pixel_n_dim</span></code></a> in <code class="docutils literal notranslate"><span class="pre">(row,</span> <span class="pre">column)</span></code> order (the convention for arrays in Python).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#astropy.wcs.WCS.axis_correlation_matrix" title="astropy.wcs.WCS.axis_correlation_matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">axis_correlation_matrix</span></code></a></p></td>
<td><p>Returns an (<a class="reference internal" href="astropy.wcs.wcsapi.BaseLowLevelWCS.html#astropy.wcs.wcsapi.BaseLowLevelWCS.world_n_dim" title="astropy.wcs.wcsapi.BaseLowLevelWCS.world_n_dim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">world_n_dim</span></code></a>, <a class="reference internal" href="astropy.wcs.wcsapi.BaseLowLevelWCS.html#astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_n_dim" title="astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_n_dim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pixel_n_dim</span></code></a>) matrix that indicates using booleans whether a given world coordinate depends on a given pixel coordinate.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#astropy.wcs.WCS.axis_type_names" title="astropy.wcs.WCS.axis_type_names"><code class="xref py py-obj docutils literal notranslate"><span class="pre">axis_type_names</span></code></a></p></td>
<td><p>World names for each coordinate axis</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#astropy.wcs.WCS.celestial" title="astropy.wcs.WCS.celestial"><code class="xref py py-obj docutils literal notranslate"><span class="pre">celestial</span></code></a></p></td>
<td><p>A copy of the current WCS with only the celestial axes included</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#astropy.wcs.WCS.cpdis1" title="astropy.wcs.WCS.cpdis1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cpdis1</span></code></a></p></td>
<td><p><a class="reference internal" href="astropy.wcs.DistortionLookupTable.html#astropy.wcs.DistortionLookupTable" title="astropy.wcs.DistortionLookupTable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DistortionLookupTable</span></code></a></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#astropy.wcs.WCS.cpdis2" title="astropy.wcs.WCS.cpdis2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cpdis2</span></code></a></p></td>
<td><p><a class="reference internal" href="astropy.wcs.DistortionLookupTable.html#astropy.wcs.DistortionLookupTable" title="astropy.wcs.DistortionLookupTable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DistortionLookupTable</span></code></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#astropy.wcs.WCS.det2im1" title="astropy.wcs.WCS.det2im1"><code class="xref py py-obj docutils literal notranslate"><span class="pre">det2im1</span></code></a></p></td>
<td><p>A <a class="reference internal" href="astropy.wcs.DistortionLookupTable.html#astropy.wcs.DistortionLookupTable" title="astropy.wcs.DistortionLookupTable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DistortionLookupTable</span></code></a> object for detector to image plane correction in the <em>x</em>-axis.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#astropy.wcs.WCS.det2im2" title="astropy.wcs.WCS.det2im2"><code class="xref py py-obj docutils literal notranslate"><span class="pre">det2im2</span></code></a></p></td>
<td><p>A <a class="reference internal" href="astropy.wcs.DistortionLookupTable.html#astropy.wcs.DistortionLookupTable" title="astropy.wcs.DistortionLookupTable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DistortionLookupTable</span></code></a> object for detector to image plane correction in the <em>y</em>-axis.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#astropy.wcs.WCS.has_celestial" title="astropy.wcs.WCS.has_celestial"><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_celestial</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#astropy.wcs.WCS.has_distortion" title="astropy.wcs.WCS.has_distortion"><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_distortion</span></code></a></p></td>
<td><p>Returns <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> if any distortion terms are present.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#astropy.wcs.WCS.has_spectral" title="astropy.wcs.WCS.has_spectral"><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_spectral</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#astropy.wcs.WCS.has_temporal" title="astropy.wcs.WCS.has_temporal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">has_temporal</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#astropy.wcs.WCS.is_celestial" title="astropy.wcs.WCS.is_celestial"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_celestial</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#astropy.wcs.WCS.is_spectral" title="astropy.wcs.WCS.is_spectral"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_spectral</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#astropy.wcs.WCS.is_temporal" title="astropy.wcs.WCS.is_temporal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">is_temporal</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#astropy.wcs.WCS.low_level_wcs" title="astropy.wcs.WCS.low_level_wcs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">low_level_wcs</span></code></a></p></td>
<td><p>Returns a reference to the underlying low-level WCS object.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#astropy.wcs.WCS.pixel_axis_names" title="astropy.wcs.WCS.pixel_axis_names"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pixel_axis_names</span></code></a></p></td>
<td><p>An iterable of strings describing the name for each pixel axis.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#astropy.wcs.WCS.pixel_bounds" title="astropy.wcs.WCS.pixel_bounds"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pixel_bounds</span></code></a></p></td>
<td><p>The bounds (in pixel coordinates) inside which the WCS is defined, as a list with <a class="reference internal" href="astropy.wcs.wcsapi.BaseLowLevelWCS.html#astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_n_dim" title="astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_n_dim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pixel_n_dim</span></code></a> <code class="docutils literal notranslate"><span class="pre">(min,</span> <span class="pre">max)</span></code> tuples.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#astropy.wcs.WCS.pixel_n_dim" title="astropy.wcs.WCS.pixel_n_dim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pixel_n_dim</span></code></a></p></td>
<td><p>The number of axes in the pixel coordinate system.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#astropy.wcs.WCS.pixel_scale_matrix" title="astropy.wcs.WCS.pixel_scale_matrix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pixel_scale_matrix</span></code></a></p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#astropy.wcs.WCS.pixel_shape" title="astropy.wcs.WCS.pixel_shape"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pixel_shape</span></code></a></p></td>
<td><p>The shape of the data that the WCS applies to as a tuple of length <a class="reference internal" href="astropy.wcs.wcsapi.BaseLowLevelWCS.html#astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_n_dim" title="astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_n_dim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pixel_n_dim</span></code></a> in <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code> order (where for an image, <code class="docutils literal notranslate"><span class="pre">x</span></code> is the horizontal coordinate and <code class="docutils literal notranslate"><span class="pre">y</span></code> is the vertical coordinate).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#astropy.wcs.WCS.serialized_classes" title="astropy.wcs.WCS.serialized_classes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">serialized_classes</span></code></a></p></td>
<td><p>Indicates whether Python objects are given in serialized form or as actual Python objects.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#astropy.wcs.WCS.sip" title="astropy.wcs.WCS.sip"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sip</span></code></a></p></td>
<td><p>Get/set the <a class="reference internal" href="astropy.wcs.Sip.html#astropy.wcs.Sip" title="astropy.wcs.Sip"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Sip</span></code></a> object for performing <a class="reference external" href="https://irsa.ipac.caltech.edu/data/SPITZER/docs/files/spitzer/shupeADASS.pdf">SIP</a> distortion correction.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#astropy.wcs.WCS.spectral" title="astropy.wcs.WCS.spectral"><code class="xref py py-obj docutils literal notranslate"><span class="pre">spectral</span></code></a></p></td>
<td><p>A copy of the current WCS with only the spectral axes included</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#astropy.wcs.WCS.temporal" title="astropy.wcs.WCS.temporal"><code class="xref py py-obj docutils literal notranslate"><span class="pre">temporal</span></code></a></p></td>
<td><p>A copy of the current WCS with only the time axes included</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#astropy.wcs.WCS.wcs" title="astropy.wcs.WCS.wcs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">wcs</span></code></a></p></td>
<td><p>A <a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm" title="astropy.wcs.Wcsprm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Wcsprm</span></code></a> object to perform the basic <a class="reference external" href="https://www.atnf.csiro.au/people/mcalabre/WCS/wcslib/index.html">wcslib</a> WCS transformation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#astropy.wcs.WCS.world_axis_names" title="astropy.wcs.WCS.world_axis_names"><code class="xref py py-obj docutils literal notranslate"><span class="pre">world_axis_names</span></code></a></p></td>
<td><p>An iterable of strings describing the name for each world axis.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#astropy.wcs.WCS.world_axis_object_classes" title="astropy.wcs.WCS.world_axis_object_classes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">world_axis_object_classes</span></code></a></p></td>
<td><p>A dictionary giving information on constructing high-level objects for the world coordinates.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#astropy.wcs.WCS.world_axis_object_components" title="astropy.wcs.WCS.world_axis_object_components"><code class="xref py py-obj docutils literal notranslate"><span class="pre">world_axis_object_components</span></code></a></p></td>
<td><p>A list with <a class="reference internal" href="astropy.wcs.wcsapi.BaseLowLevelWCS.html#astropy.wcs.wcsapi.BaseLowLevelWCS.world_n_dim" title="astropy.wcs.wcsapi.BaseLowLevelWCS.world_n_dim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">world_n_dim</span></code></a> elements giving information on constructing high-level objects for the world coordinates.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#astropy.wcs.WCS.world_axis_physical_types" title="astropy.wcs.WCS.world_axis_physical_types"><code class="xref py py-obj docutils literal notranslate"><span class="pre">world_axis_physical_types</span></code></a></p></td>
<td><p>An iterable of strings describing the physical type for each world axis.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#astropy.wcs.WCS.world_axis_units" title="astropy.wcs.WCS.world_axis_units"><code class="xref py py-obj docutils literal notranslate"><span class="pre">world_axis_units</span></code></a></p></td>
<td><p>An iterable of strings given the units of the world coordinates for each axis.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#astropy.wcs.WCS.world_n_dim" title="astropy.wcs.WCS.world_n_dim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">world_n_dim</span></code></a></p></td>
<td><p>The number of axes in the world coordinate system.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Methods Summary</p>
<table class="longtable docutils align-default">
<colgroup>
<col style="width: 10%" />
<col style="width: 90%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p><a class="reference internal" href="#astropy.wcs.WCS.all_pix2world" title="astropy.wcs.WCS.all_pix2world"><code class="xref py py-obj docutils literal notranslate"><span class="pre">all_pix2world</span></code></a>(*args, **kwargs)</p></td>
<td><p>Transforms pixel coordinates to world coordinates.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#astropy.wcs.WCS.all_world2pix" title="astropy.wcs.WCS.all_world2pix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">all_world2pix</span></code></a>(*arg[, tolerance, maxiter, …])</p></td>
<td><p>Transforms world coordinates to pixel coordinates, using numerical iteration to invert the full forward transformation <a class="reference internal" href="#astropy.wcs.WCS.all_pix2world" title="astropy.wcs.WCS.all_pix2world"><code class="xref py py-obj docutils literal notranslate"><span class="pre">all_pix2world</span></code></a> with complete distortion model.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#astropy.wcs.WCS.array_index_to_world" title="astropy.wcs.WCS.array_index_to_world"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array_index_to_world</span></code></a>(*index_arrays)</p></td>
<td><p>Convert array indices to world coordinates (represented by Astropy objects).</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#astropy.wcs.WCS.array_index_to_world_values" title="astropy.wcs.WCS.array_index_to_world_values"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array_index_to_world_values</span></code></a>(*index_arrays)</p></td>
<td><p>Convert array indices to world coordinates.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#astropy.wcs.WCS.calc_footprint" title="astropy.wcs.WCS.calc_footprint"><code class="xref py py-obj docutils literal notranslate"><span class="pre">calc_footprint</span></code></a>([header, undistort, axes, center])</p></td>
<td><p>Calculates the footprint of the image on the sky.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#astropy.wcs.WCS.copy" title="astropy.wcs.WCS.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a>()</p></td>
<td><p>Return a shallow copy of the object.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#astropy.wcs.WCS.deepcopy" title="astropy.wcs.WCS.deepcopy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">deepcopy</span></code></a>()</p></td>
<td><p>Return a deep copy of the object.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#astropy.wcs.WCS.det2im" title="astropy.wcs.WCS.det2im"><code class="xref py py-obj docutils literal notranslate"><span class="pre">det2im</span></code></a>(*args)</p></td>
<td><p>Convert detector coordinates to image plane coordinates using <a class="reference external" href="https://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion paper</a> table-lookup correction.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#astropy.wcs.WCS.dropaxis" title="astropy.wcs.WCS.dropaxis"><code class="xref py py-obj docutils literal notranslate"><span class="pre">dropaxis</span></code></a>(dropax)</p></td>
<td><p>Remove an axis from the WCS.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#astropy.wcs.WCS.fix" title="astropy.wcs.WCS.fix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fix</span></code></a>([translate_units, naxis])</p></td>
<td><p>Perform the fix operations from wcslib, and warn about any changes it has made.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#astropy.wcs.WCS.footprint_contains" title="astropy.wcs.WCS.footprint_contains"><code class="xref py py-obj docutils literal notranslate"><span class="pre">footprint_contains</span></code></a>(coord, **kwargs)</p></td>
<td><p>Determines if a given SkyCoord is contained in the wcs footprint.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#astropy.wcs.WCS.footprint_to_file" title="astropy.wcs.WCS.footprint_to_file"><code class="xref py py-obj docutils literal notranslate"><span class="pre">footprint_to_file</span></code></a>([filename, color, width, …])</p></td>
<td><p>Writes out a <a class="reference external" href="http://ds9.si.edu/">ds9</a> style regions file.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#astropy.wcs.WCS.get_axis_types" title="astropy.wcs.WCS.get_axis_types"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_axis_types</span></code></a>()</p></td>
<td><p>Similar to <a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.axis_types" title="astropy.wcs.Wcsprm.axis_types"><code class="xref py py-obj docutils literal notranslate"><span class="pre">self.wcsprm.axis_types</span></code></a> but provides the information in a more Python-friendly format.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#astropy.wcs.WCS.p4_pix2foc" title="astropy.wcs.WCS.p4_pix2foc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">p4_pix2foc</span></code></a>(*args)</p></td>
<td><p>Convert pixel coordinates to focal plane coordinates using <a class="reference external" href="https://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion paper</a> table-lookup correction.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#astropy.wcs.WCS.pix2foc" title="astropy.wcs.WCS.pix2foc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pix2foc</span></code></a>(*args)</p></td>
<td><p>Convert pixel coordinates to focal plane coordinates using the <a class="reference external" href="https://irsa.ipac.caltech.edu/data/SPITZER/docs/files/spitzer/shupeADASS.pdf">SIP</a> polynomial distortion convention and <a class="reference external" href="https://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion paper</a> table-lookup correction.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#astropy.wcs.WCS.pixel_to_world" title="astropy.wcs.WCS.pixel_to_world"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pixel_to_world</span></code></a>(*pixel_arrays)</p></td>
<td><p>Convert pixel coordinates to world coordinates (represented by high-level objects).</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#astropy.wcs.WCS.pixel_to_world_values" title="astropy.wcs.WCS.pixel_to_world_values"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pixel_to_world_values</span></code></a>(*pixel_arrays)</p></td>
<td><p>Convert pixel coordinates to world coordinates.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#astropy.wcs.WCS.printwcs" title="astropy.wcs.WCS.printwcs"><code class="xref py py-obj docutils literal notranslate"><span class="pre">printwcs</span></code></a>()</p></td>
<td><p></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#astropy.wcs.WCS.proj_plane_pixel_area" title="astropy.wcs.WCS.proj_plane_pixel_area"><code class="xref py py-obj docutils literal notranslate"><span class="pre">proj_plane_pixel_area</span></code></a>()</p></td>
<td><p>For a <strong>celestial</strong> WCS (see <a class="reference internal" href="#astropy.wcs.WCS.celestial" title="astropy.wcs.WCS.celestial"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.wcs.WCS.celestial</span></code></a>), returns pixel area of the image pixel at the <code class="docutils literal notranslate"><span class="pre">CRPIX</span></code> location once it is projected onto the “plane of intermediate world coordinates” as defined in <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2002A%26A...395.1061G">Greisen &amp; Calabretta 2002, A&amp;A, 395, 1061</a>.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#astropy.wcs.WCS.proj_plane_pixel_scales" title="astropy.wcs.WCS.proj_plane_pixel_scales"><code class="xref py py-obj docutils literal notranslate"><span class="pre">proj_plane_pixel_scales</span></code></a>()</p></td>
<td><p><p>Calculate pixel scales along each axis of the image pixel at the <code class="docutils literal notranslate"><span class="pre">CRPIX</span></code> location once it is projected onto the “plane of intermediate world coordinates” as defined in <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2002A%26A...395.1061G">Greisen &amp; Calabretta 2002, A&amp;A, 395, 1061</a>.</p>
</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#astropy.wcs.WCS.reorient_celestial_first" title="astropy.wcs.WCS.reorient_celestial_first"><code class="xref py py-obj docutils literal notranslate"><span class="pre">reorient_celestial_first</span></code></a>()</p></td>
<td><p>Reorient the WCS such that the celestial axes are first, followed by the spectral axis, followed by any others.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#astropy.wcs.WCS.sip_foc2pix" title="astropy.wcs.WCS.sip_foc2pix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sip_foc2pix</span></code></a>(*args)</p></td>
<td><p>Convert focal plane coordinates to pixel coordinates using the <a class="reference external" href="https://irsa.ipac.caltech.edu/data/SPITZER/docs/files/spitzer/shupeADASS.pdf">SIP</a> polynomial distortion convention.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#astropy.wcs.WCS.sip_pix2foc" title="astropy.wcs.WCS.sip_pix2foc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sip_pix2foc</span></code></a>(*args)</p></td>
<td><p>Convert pixel coordinates to focal plane coordinates using the <a class="reference external" href="https://irsa.ipac.caltech.edu/data/SPITZER/docs/files/spitzer/shupeADASS.pdf">SIP</a> polynomial distortion convention.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#astropy.wcs.WCS.slice" title="astropy.wcs.WCS.slice"><code class="xref py py-obj docutils literal notranslate"><span class="pre">slice</span></code></a>(view[, numpy_order])</p></td>
<td><p>Slice a WCS instance using a Numpy slice.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#astropy.wcs.WCS.sub" title="astropy.wcs.WCS.sub"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sub</span></code></a>(axes)</p></td>
<td><p>Extracts the coordinate description for a subimage from a <a class="reference internal" href="#astropy.wcs.WCS" title="astropy.wcs.WCS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WCS</span></code></a> object.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#astropy.wcs.WCS.swapaxes" title="astropy.wcs.WCS.swapaxes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">swapaxes</span></code></a>(ax0, ax1)</p></td>
<td><p>Swap axes in a WCS.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#astropy.wcs.WCS.to_fits" title="astropy.wcs.WCS.to_fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_fits</span></code></a>([relax, key])</p></td>
<td><p>Generate an <a class="reference internal" href="../io/fits/api/hdulists.html#astropy.io.fits.HDUList" title="astropy.io.fits.HDUList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HDUList</span></code></a> object with all of the information stored in this object.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#astropy.wcs.WCS.to_header" title="astropy.wcs.WCS.to_header"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_header</span></code></a>([relax, key])</p></td>
<td><p>Generate an <a class="reference internal" href="../io/fits/api/headers.html#astropy.io.fits.Header" title="astropy.io.fits.Header"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits.Header</span></code></a> object with the basic WCS and SIP information stored in this object.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#astropy.wcs.WCS.to_header_string" title="astropy.wcs.WCS.to_header_string"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_header_string</span></code></a>([relax])</p></td>
<td><p>Identical to <a class="reference internal" href="#astropy.wcs.WCS.to_header" title="astropy.wcs.WCS.to_header"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_header</span></code></a>, but returns a string containing the header cards.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#astropy.wcs.WCS.wcs_pix2world" title="astropy.wcs.WCS.wcs_pix2world"><code class="xref py py-obj docutils literal notranslate"><span class="pre">wcs_pix2world</span></code></a>(*args, **kwargs)</p></td>
<td><p>Transforms pixel coordinates to world coordinates by doing only the basic <a class="reference external" href="https://www.atnf.csiro.au/people/mcalabre/WCS/wcslib/index.html">wcslib</a> transformation.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#astropy.wcs.WCS.wcs_world2pix" title="astropy.wcs.WCS.wcs_world2pix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">wcs_world2pix</span></code></a>(*args, **kwargs)</p></td>
<td><p>Transforms world coordinates to pixel coordinates, using only the basic <a class="reference external" href="https://www.atnf.csiro.au/people/mcalabre/WCS/wcslib/index.html">wcslib</a> WCS transformation.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#astropy.wcs.WCS.world_to_array_index" title="astropy.wcs.WCS.world_to_array_index"><code class="xref py py-obj docutils literal notranslate"><span class="pre">world_to_array_index</span></code></a>(*world_objects)</p></td>
<td><p>Convert world coordinates (represented by Astropy objects) to array indices.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#astropy.wcs.WCS.world_to_array_index_values" title="astropy.wcs.WCS.world_to_array_index_values"><code class="xref py py-obj docutils literal notranslate"><span class="pre">world_to_array_index_values</span></code></a>(*world_arrays)</p></td>
<td><p>Convert world coordinates to array indices.</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="#astropy.wcs.WCS.world_to_pixel" title="astropy.wcs.WCS.world_to_pixel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">world_to_pixel</span></code></a>(*world_objects)</p></td>
<td><p>Convert world coordinates (represented by Astropy objects) to pixel coordinates.</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="#astropy.wcs.WCS.world_to_pixel_values" title="astropy.wcs.WCS.world_to_pixel_values"><code class="xref py py-obj docutils literal notranslate"><span class="pre">world_to_pixel_values</span></code></a>(*world_arrays)</p></td>
<td><p>Convert world coordinates to pixel coordinates.</p></td>
</tr>
</tbody>
</table>
<p class="rubric">Attributes Documentation</p>
<dl class="py attribute">
<dt id="astropy.wcs.WCS.array_shape">
<code class="sig-name descname"><span class="pre">array_shape</span></code><a class="headerlink" href="#astropy.wcs.WCS.array_shape" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="astropy.wcs.WCS.axis_correlation_matrix">
<code class="sig-name descname"><span class="pre">axis_correlation_matrix</span></code><a class="headerlink" href="#astropy.wcs.WCS.axis_correlation_matrix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="astropy.wcs.WCS.axis_type_names">
<code class="sig-name descname"><span class="pre">axis_type_names</span></code><a class="headerlink" href="#astropy.wcs.WCS.axis_type_names" title="Permalink to this definition">¶</a></dt>
<dd><p>World names for each coordinate axis</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl class="simple">
<dt><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">str</span></code></a></dt><dd><p>A list of names along each axis.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py attribute">
<dt id="astropy.wcs.WCS.celestial">
<code class="sig-name descname"><span class="pre">celestial</span></code><a class="headerlink" href="#astropy.wcs.WCS.celestial" title="Permalink to this definition">¶</a></dt>
<dd><p>A copy of the current WCS with only the celestial axes included</p>
</dd></dl>

<dl class="py attribute">
<dt id="astropy.wcs.WCS.cpdis1">
<code class="sig-name descname"><span class="pre">cpdis1</span></code><a class="headerlink" href="#astropy.wcs.WCS.cpdis1" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="astropy.wcs.DistortionLookupTable.html#astropy.wcs.DistortionLookupTable" title="astropy.wcs.DistortionLookupTable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DistortionLookupTable</span></code></a></p>
<p>The pre-linear transformation distortion lookup table, <code class="docutils literal notranslate"><span class="pre">CPDIS1</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt id="astropy.wcs.WCS.cpdis2">
<code class="sig-name descname"><span class="pre">cpdis2</span></code><a class="headerlink" href="#astropy.wcs.WCS.cpdis2" title="Permalink to this definition">¶</a></dt>
<dd><p><a class="reference internal" href="astropy.wcs.DistortionLookupTable.html#astropy.wcs.DistortionLookupTable" title="astropy.wcs.DistortionLookupTable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DistortionLookupTable</span></code></a></p>
<p>The pre-linear transformation distortion lookup table, <code class="docutils literal notranslate"><span class="pre">CPDIS2</span></code>.</p>
</dd></dl>

<dl class="py attribute">
<dt id="astropy.wcs.WCS.det2im1">
<code class="sig-name descname"><span class="pre">det2im1</span></code><a class="headerlink" href="#astropy.wcs.WCS.det2im1" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="astropy.wcs.DistortionLookupTable.html#astropy.wcs.DistortionLookupTable" title="astropy.wcs.DistortionLookupTable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DistortionLookupTable</span></code></a> object for detector to image plane
correction in the <em>x</em>-axis.</p>
</dd></dl>

<dl class="py attribute">
<dt id="astropy.wcs.WCS.det2im2">
<code class="sig-name descname"><span class="pre">det2im2</span></code><a class="headerlink" href="#astropy.wcs.WCS.det2im2" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="astropy.wcs.DistortionLookupTable.html#astropy.wcs.DistortionLookupTable" title="astropy.wcs.DistortionLookupTable"><code class="xref py py-obj docutils literal notranslate"><span class="pre">DistortionLookupTable</span></code></a> object for detector to image plane
correction in the <em>y</em>-axis.</p>
</dd></dl>

<dl class="py attribute">
<dt id="astropy.wcs.WCS.has_celestial">
<code class="sig-name descname"><span class="pre">has_celestial</span></code><a class="headerlink" href="#astropy.wcs.WCS.has_celestial" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="astropy.wcs.WCS.has_distortion">
<code class="sig-name descname"><span class="pre">has_distortion</span></code><a class="headerlink" href="#astropy.wcs.WCS.has_distortion" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> if any distortion terms are present.</p>
</dd></dl>

<dl class="py attribute">
<dt id="astropy.wcs.WCS.has_spectral">
<code class="sig-name descname"><span class="pre">has_spectral</span></code><a class="headerlink" href="#astropy.wcs.WCS.has_spectral" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="astropy.wcs.WCS.has_temporal">
<code class="sig-name descname"><span class="pre">has_temporal</span></code><a class="headerlink" href="#astropy.wcs.WCS.has_temporal" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="astropy.wcs.WCS.is_celestial">
<code class="sig-name descname"><span class="pre">is_celestial</span></code><a class="headerlink" href="#astropy.wcs.WCS.is_celestial" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="astropy.wcs.WCS.is_spectral">
<code class="sig-name descname"><span class="pre">is_spectral</span></code><a class="headerlink" href="#astropy.wcs.WCS.is_spectral" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="astropy.wcs.WCS.is_temporal">
<code class="sig-name descname"><span class="pre">is_temporal</span></code><a class="headerlink" href="#astropy.wcs.WCS.is_temporal" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="astropy.wcs.WCS.low_level_wcs">
<code class="sig-name descname"><span class="pre">low_level_wcs</span></code><a class="headerlink" href="#astropy.wcs.WCS.low_level_wcs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="astropy.wcs.WCS.pixel_axis_names">
<code class="sig-name descname"><span class="pre">pixel_axis_names</span></code><a class="headerlink" href="#astropy.wcs.WCS.pixel_axis_names" title="Permalink to this definition">¶</a></dt>
<dd><p>An iterable of strings describing the name for each pixel axis.</p>
<p>If an axis does not have a name, an empty string should be returned
(this is the default behavior for all axes if a subclass does not
override this property). Note that these names are just for display
purposes and are not standardized.</p>
</dd></dl>

<dl class="py attribute">
<dt id="astropy.wcs.WCS.pixel_bounds">
<code class="sig-name descname"><span class="pre">pixel_bounds</span></code><a class="headerlink" href="#astropy.wcs.WCS.pixel_bounds" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="astropy.wcs.WCS.pixel_n_dim">
<code class="sig-name descname"><span class="pre">pixel_n_dim</span></code><a class="headerlink" href="#astropy.wcs.WCS.pixel_n_dim" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="astropy.wcs.WCS.pixel_scale_matrix">
<code class="sig-name descname"><span class="pre">pixel_scale_matrix</span></code><a class="headerlink" href="#astropy.wcs.WCS.pixel_scale_matrix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="astropy.wcs.WCS.pixel_shape">
<code class="sig-name descname"><span class="pre">pixel_shape</span></code><a class="headerlink" href="#astropy.wcs.WCS.pixel_shape" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="astropy.wcs.WCS.serialized_classes">
<code class="sig-name descname"><span class="pre">serialized_classes</span></code><a class="headerlink" href="#astropy.wcs.WCS.serialized_classes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="astropy.wcs.WCS.sip">
<code class="sig-name descname"><span class="pre">sip</span></code><a class="headerlink" href="#astropy.wcs.WCS.sip" title="Permalink to this definition">¶</a></dt>
<dd><p>Get/set the <a class="reference internal" href="astropy.wcs.Sip.html#astropy.wcs.Sip" title="astropy.wcs.Sip"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Sip</span></code></a> object for performing <a class="reference external" href="https://irsa.ipac.caltech.edu/data/SPITZER/docs/files/spitzer/shupeADASS.pdf">SIP</a> distortion
correction.</p>
</dd></dl>

<dl class="py attribute">
<dt id="astropy.wcs.WCS.spectral">
<code class="sig-name descname"><span class="pre">spectral</span></code><a class="headerlink" href="#astropy.wcs.WCS.spectral" title="Permalink to this definition">¶</a></dt>
<dd><p>A copy of the current WCS with only the spectral axes included</p>
</dd></dl>

<dl class="py attribute">
<dt id="astropy.wcs.WCS.temporal">
<code class="sig-name descname"><span class="pre">temporal</span></code><a class="headerlink" href="#astropy.wcs.WCS.temporal" title="Permalink to this definition">¶</a></dt>
<dd><p>A copy of the current WCS with only the time axes included</p>
</dd></dl>

<dl class="py attribute">
<dt id="astropy.wcs.WCS.wcs">
<code class="sig-name descname"><span class="pre">wcs</span></code><a class="headerlink" href="#astropy.wcs.WCS.wcs" title="Permalink to this definition">¶</a></dt>
<dd><p>A <a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm" title="astropy.wcs.Wcsprm"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Wcsprm</span></code></a> object to perform the basic <a class="reference external" href="https://www.atnf.csiro.au/people/mcalabre/WCS/wcslib/index.html">wcslib</a> WCS
transformation.</p>
</dd></dl>

<dl class="py attribute">
<dt id="astropy.wcs.WCS.world_axis_names">
<code class="sig-name descname"><span class="pre">world_axis_names</span></code><a class="headerlink" href="#astropy.wcs.WCS.world_axis_names" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="astropy.wcs.WCS.world_axis_object_classes">
<code class="sig-name descname"><span class="pre">world_axis_object_classes</span></code><a class="headerlink" href="#astropy.wcs.WCS.world_axis_object_classes" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="astropy.wcs.WCS.world_axis_object_components">
<code class="sig-name descname"><span class="pre">world_axis_object_components</span></code><a class="headerlink" href="#astropy.wcs.WCS.world_axis_object_components" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="astropy.wcs.WCS.world_axis_physical_types">
<code class="sig-name descname"><span class="pre">world_axis_physical_types</span></code><a class="headerlink" href="#astropy.wcs.WCS.world_axis_physical_types" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="astropy.wcs.WCS.world_axis_units">
<code class="sig-name descname"><span class="pre">world_axis_units</span></code><a class="headerlink" href="#astropy.wcs.WCS.world_axis_units" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py attribute">
<dt id="astropy.wcs.WCS.world_n_dim">
<code class="sig-name descname"><span class="pre">world_n_dim</span></code><a class="headerlink" href="#astropy.wcs.WCS.world_n_dim" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<p class="rubric">Methods Documentation</p>
<dl class="py method">
<dt id="astropy.wcs.WCS.all_pix2world">
<code class="sig-name descname"><span class="pre">all_pix2world</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.all_pix2world"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astropy.wcs.WCS.all_pix2world" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms pixel coordinates to world coordinates.</p>
<p>Performs all of the following in series:</p>
<blockquote>
<div><ul class="simple">
<li><p>Detector to image plane correction (if present in the
FITS file)</p></li>
<li><p><a class="reference external" href="https://irsa.ipac.caltech.edu/data/SPITZER/docs/files/spitzer/shupeADASS.pdf">SIP</a> distortion correction (if present in the FITS
file)</p></li>
<li><p><a class="reference external" href="https://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion paper</a> table-lookup correction (if present
in the FITS file)</p></li>
<li><p><a class="reference external" href="https://www.atnf.csiro.au/people/mcalabre/WCS/wcslib/index.html">wcslib</a> “core” WCS transformation</p></li>
</ul>
</div></blockquote>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>*args</strong></dt><dd><p>There are two accepted forms for the positional arguments:</p>
<blockquote>
<div><ul class="simple">
<li><p>2 arguments: An <em>N</em> x <em>naxis</em> array of coordinates, and an
<em>origin</em>.</p></li>
<li><p>more than 2 arguments: An array for each axis, followed by
an <em>origin</em>.  These arrays must be broadcastable to one
another.</p></li>
</ul>
</div></blockquote>
<p>Here, <em>origin</em> is the coordinate in the upper left corner of the
image.  In FITS and Fortran standards, this is 1.  In Numpy and C
standards this is 0.</p>
<p>For a transformation that is not two-dimensional, the
two-argument form must be used.</p>
</dd>
<dt><strong>ra_dec_order</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bltin-boolean-values" title="(in Python v3.10)"><span class="xref std std-ref">bool</span></a>, optional</span></dt><dd><p>When <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> will ensure that world coordinates are always given
and returned in as (<em>ra</em>, <em>dec</em>) pairs, regardless of the order of
the axes specified by the in the <code class="docutils literal notranslate"><span class="pre">CTYPE</span></code> keywords.  Default is
<a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a></span></dt><dd><p>Returns the sky coordinates, in degrees.  If the input was a single array and
origin, a single array is returned, otherwise a tuple of arrays is
returned.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#MemoryError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MemoryError</span></code></a></dt><dd><p>Memory allocation failed.</p>
</dd>
<dt><a class="reference internal" href="astropy.wcs.SingularMatrixError.html#astropy.wcs.SingularMatrixError" title="astropy.wcs.SingularMatrixError"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SingularMatrixError</span></code></a></dt><dd><p>Linear transformation matrix is singular.</p>
</dd>
<dt><a class="reference internal" href="astropy.wcs.InconsistentAxisTypesError.html#astropy.wcs.InconsistentAxisTypesError" title="astropy.wcs.InconsistentAxisTypesError"><code class="xref py py-obj docutils literal notranslate"><span class="pre">InconsistentAxisTypesError</span></code></a></dt><dd><p>Inconsistent or unrecognized coordinate axis types.</p>
</dd>
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ValueError</span></code></a></dt><dd><p>Invalid parameter value.</p>
</dd>
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ValueError</span></code></a></dt><dd><p>Invalid coordinate transformation parameters.</p>
</dd>
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ValueError</span></code></a></dt><dd><p>x- and y-coordinate arrays are not the same size.</p>
</dd>
<dt><a class="reference internal" href="astropy.wcs.InvalidTransformError.html#astropy.wcs.InvalidTransformError" title="astropy.wcs.InvalidTransformError"><code class="xref py py-obj docutils literal notranslate"><span class="pre">InvalidTransformError</span></code></a></dt><dd><p>Invalid coordinate transformation parameters.</p>
</dd>
<dt><a class="reference internal" href="astropy.wcs.InvalidTransformError.html#astropy.wcs.InvalidTransformError" title="astropy.wcs.InvalidTransformError"><code class="xref py py-obj docutils literal notranslate"><span class="pre">InvalidTransformError</span></code></a></dt><dd><p>Ill-conditioned coordinate transformation parameters.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The order of the axes for the result is determined by the
<code class="docutils literal notranslate"><span class="pre">CTYPEia</span></code> keywords in the FITS header, therefore it may not
always be of the form (<em>ra</em>, <em>dec</em>).  The
<a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.lat" title="astropy.wcs.Wcsprm.lat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lat</span></code></a>, <a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.lng" title="astropy.wcs.Wcsprm.lng"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lng</span></code></a>,
<a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.lattyp" title="astropy.wcs.Wcsprm.lattyp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lattyp</span></code></a> and <a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.lngtyp" title="astropy.wcs.Wcsprm.lngtyp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lngtyp</span></code></a>
members can be used to determine the order of the axes.</p>
</dd></dl>

<dl class="py method">
<dt id="astropy.wcs.WCS.all_world2pix">
<code class="sig-name descname"><span class="pre">all_world2pix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">arg</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tolerance</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1.0e-4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxiter</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adaptive</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">detect_divergence</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">quiet</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.all_world2pix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astropy.wcs.WCS.all_world2pix" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms world coordinates to pixel coordinates, using
numerical iteration to invert the full forward transformation
<a class="reference internal" href="#astropy.wcs.WCS.all_pix2world" title="astropy.wcs.WCS.all_pix2world"><code class="xref py py-obj docutils literal notranslate"><span class="pre">all_pix2world</span></code></a> with complete
distortion model.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>*args</strong></dt><dd><p>There are two accepted forms for the positional arguments:</p>
<blockquote>
<div><ul class="simple">
<li><p>2 arguments: An <em>N</em> x <em>naxis</em> array of coordinates, and an
<em>origin</em>.</p></li>
<li><p>more than 2 arguments: An array for each axis, followed by
an <em>origin</em>.  These arrays must be broadcastable to one
another.</p></li>
</ul>
</div></blockquote>
<p>Here, <em>origin</em> is the coordinate in the upper left corner of the
image.  In FITS and Fortran standards, this is 1.  In Numpy and C
standards this is 0.</p>
<p>For a transformation that is not two-dimensional, the
two-argument form must be used.</p>
</dd>
<dt><strong>ra_dec_order</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bltin-boolean-values" title="(in Python v3.10)"><span class="xref std std-ref">bool</span></a>, optional</span></dt><dd><p>When <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> will ensure that world coordinates are always given
and returned in as (<em>ra</em>, <em>dec</em>) pairs, regardless of the order of
the axes specified by the in the <code class="docutils literal notranslate"><span class="pre">CTYPE</span></code> keywords.  Default is
<a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>.</p>
</dd>
<dt><strong>tolerance</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">float</span></code></a>, optional (default = 1.0e-4)</span></dt><dd><p>Tolerance of solution. Iteration terminates when the
iterative solver estimates that the “true solution” is
within this many pixels current estimate, more
specifically, when the correction to the solution found
during the previous iteration is smaller
(in the sense of the L2 norm) than <code class="docutils literal notranslate"><span class="pre">tolerance</span></code>.</p>
</dd>
<dt><strong>maxiter</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a>, optional (default = 20)</span></dt><dd><p>Maximum number of iterations allowed to reach a solution.</p>
</dd>
<dt><strong>quiet</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bltin-boolean-values" title="(in Python v3.10)"><span class="xref std std-ref">bool</span></a>, optional (default = <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">False</span></code></a>)</span></dt><dd><p>Do not throw <a class="reference internal" href="astropy.wcs.NoConvergence.html#astropy.wcs.NoConvergence" title="astropy.wcs.NoConvergence"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoConvergence</span></code></a> exceptions when
the method does not converge to a solution with the
required accuracy within a specified number of maximum
iterations set by <code class="docutils literal notranslate"><span class="pre">maxiter</span></code> parameter. Instead,
simply return the found solution.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a></span></dt><dd><p>Returns the pixel coordinates.  If the input was a single array and
origin, a single array is returned, otherwise a tuple of arrays is
returned.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Other Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>adaptive</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bltin-boolean-values" title="(in Python v3.10)"><span class="xref std std-ref">bool</span></a>, optional (default = <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">False</span></code></a>)</span></dt><dd><p>Specifies whether to adaptively select only points that
did not converge to a solution within the required
accuracy for the next iteration. Default is recommended
for HST as well as most other instruments.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <a class="reference internal" href="#astropy.wcs.WCS.all_world2pix" title="astropy.wcs.WCS.all_world2pix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">all_world2pix()</span></code></a> uses a vectorized
implementation of the method of consecutive
approximations (see <code class="docutils literal notranslate"><span class="pre">Notes</span></code> section below) in which it
iterates over <em>all</em> input points <em>regardless</em> until
the required accuracy has been reached for <em>all</em> input
points. In some cases it may be possible that
<em>almost all</em> points have reached the required accuracy
but there are only a few of input data points for
which additional iterations may be needed (this
depends mostly on the characteristics of the geometric
distortions for a given instrument). In this situation
it may be advantageous to set <code class="docutils literal notranslate"><span class="pre">adaptive</span></code> = <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> in
which case <a class="reference internal" href="#astropy.wcs.WCS.all_world2pix" title="astropy.wcs.WCS.all_world2pix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">all_world2pix()</span></code></a> will continue
iterating <em>only</em> over the points that have not yet
converged to the required accuracy. However, for the
HST’s ACS/WFC detector, which has the strongest
distortions of all HST instruments, testing has
shown that enabling this option would lead to a about
50-100% penalty in computational time (depending on
specifics of the image, geometric distortions, and
number of input points to be converted). Therefore,
for HST and possibly instruments, it is recommended
to set <code class="docutils literal notranslate"><span class="pre">adaptive</span></code> = <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>. The only danger in
getting this setting wrong will be a performance
penalty.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When <code class="docutils literal notranslate"><span class="pre">detect_divergence</span></code> is <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>,
<a class="reference internal" href="#astropy.wcs.WCS.all_world2pix" title="astropy.wcs.WCS.all_world2pix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">all_world2pix()</span></code></a> will automatically switch
to the adaptive algorithm once divergence has been
detected.</p>
</div>
</dd>
<dt><strong>detect_divergence</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bltin-boolean-values" title="(in Python v3.10)"><span class="xref std std-ref">bool</span></a>, optional (default = <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">True</span></code></a>)</span></dt><dd><p>Specifies whether to perform a more detailed analysis
of the convergence to a solution. Normally
<a class="reference internal" href="#astropy.wcs.WCS.all_world2pix" title="astropy.wcs.WCS.all_world2pix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">all_world2pix()</span></code></a> may not achieve the required
accuracy if either the <code class="docutils literal notranslate"><span class="pre">tolerance</span></code> or <code class="docutils literal notranslate"><span class="pre">maxiter</span></code> arguments
are too low. However, it may happen that for some
geometric distortions the conditions of convergence for
the the method of consecutive approximations used by
<a class="reference internal" href="#astropy.wcs.WCS.all_world2pix" title="astropy.wcs.WCS.all_world2pix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">all_world2pix()</span></code></a> may not be satisfied, in which
case consecutive approximations to the solution will
diverge regardless of the <code class="docutils literal notranslate"><span class="pre">tolerance</span></code> or <code class="docutils literal notranslate"><span class="pre">maxiter</span></code>
settings.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">detect_divergence</span></code> is <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, these divergent
points will be detected as not having achieved the
required accuracy (without further details). In addition,
if <code class="docutils literal notranslate"><span class="pre">adaptive</span></code> is <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a> then the algorithm will not
know that the solution (for specific points) is diverging
and will continue iterating and trying to “improve”
diverging solutions. This may result in <code class="docutils literal notranslate"><span class="pre">NaN</span></code> or
<code class="docutils literal notranslate"><span class="pre">Inf</span></code> values in the return results (in addition to a
performance penalties). Even when <code class="docutils literal notranslate"><span class="pre">detect_divergence</span></code>
is <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, <a class="reference internal" href="#astropy.wcs.WCS.all_world2pix" title="astropy.wcs.WCS.all_world2pix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">all_world2pix()</span></code></a>, at the end of the
iterative process, will identify invalid results
(<code class="docutils literal notranslate"><span class="pre">NaN</span></code> or <code class="docutils literal notranslate"><span class="pre">Inf</span></code>) as “diverging” solutions and will
raise <a class="reference internal" href="astropy.wcs.NoConvergence.html#astropy.wcs.NoConvergence" title="astropy.wcs.NoConvergence"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoConvergence</span></code></a> unless the <code class="docutils literal notranslate"><span class="pre">quiet</span></code>
parameter is set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>.</p>
<p>When <code class="docutils literal notranslate"><span class="pre">detect_divergence</span></code> is <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>,
<a class="reference internal" href="#astropy.wcs.WCS.all_world2pix" title="astropy.wcs.WCS.all_world2pix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">all_world2pix()</span></code></a> will detect points for which
current correction to the coordinates is larger than
the correction applied during the previous iteration
<strong>if</strong> the requested accuracy <strong>has not yet been
achieved</strong>. In this case, if <code class="docutils literal notranslate"><span class="pre">adaptive</span></code> is <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>,
these points will be excluded from further iterations and
if <code class="docutils literal notranslate"><span class="pre">adaptive</span></code> is <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, <a class="reference internal" href="#astropy.wcs.WCS.all_world2pix" title="astropy.wcs.WCS.all_world2pix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">all_world2pix()</span></code></a> will
automatically switch to the adaptive algorithm. Thus, the
reported divergent solution will be the latest converging
solution computed immediately <em>before</em> divergence
has been detected.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When accuracy has been achieved, small increases in
current corrections may be possible due to rounding
errors (when <code class="docutils literal notranslate"><span class="pre">adaptive</span></code> is <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>) and such
increases will be ignored.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Based on our testing using HST ACS/WFC images, setting
<code class="docutils literal notranslate"><span class="pre">detect_divergence</span></code> to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> will incur about 5-20%
performance penalty with the larger penalty
corresponding to <code class="docutils literal notranslate"><span class="pre">adaptive</span></code> set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>.
Because the benefits of enabling this
feature outweigh the small performance penalty,
especially when <code class="docutils literal notranslate"><span class="pre">adaptive</span></code> = <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, it is
recommended to set <code class="docutils literal notranslate"><span class="pre">detect_divergence</span></code> to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>,
unless extensive testing of the distortion models for
images from specific instruments show a good stability
of the numerical method for a wide range of
coordinates (even outside the image itself).</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Indices of the diverging inverse solutions will be
reported in the <code class="docutils literal notranslate"><span class="pre">divergent</span></code> attribute of the
raised <a class="reference internal" href="astropy.wcs.NoConvergence.html#astropy.wcs.NoConvergence" title="astropy.wcs.NoConvergence"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoConvergence</span></code></a> exception object.</p>
</div>
</dd>
</dl>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><dl>
<dt><a class="reference internal" href="astropy.wcs.NoConvergence.html#astropy.wcs.NoConvergence" title="astropy.wcs.NoConvergence"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NoConvergence</span></code></a></dt><dd><p>The method did not converge to a
solution to the required accuracy within a specified
number of maximum iterations set by the <code class="docutils literal notranslate"><span class="pre">maxiter</span></code>
parameter. To turn off this exception, set <code class="docutils literal notranslate"><span class="pre">quiet</span></code> to
<a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>. Indices of the points for which the requested
accuracy was not achieved (if any) will be listed in the
<code class="docutils literal notranslate"><span class="pre">slow_conv</span></code> attribute of the
raised <a class="reference internal" href="astropy.wcs.NoConvergence.html#astropy.wcs.NoConvergence" title="astropy.wcs.NoConvergence"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoConvergence</span></code></a> exception object.</p>
<p>See <a class="reference internal" href="astropy.wcs.NoConvergence.html#astropy.wcs.NoConvergence" title="astropy.wcs.NoConvergence"><code class="xref py py-class docutils literal notranslate"><span class="pre">NoConvergence</span></code></a> documentation for
more details.</p>
</dd>
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#MemoryError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MemoryError</span></code></a></dt><dd><p>Memory allocation failed.</p>
</dd>
<dt><a class="reference internal" href="astropy.wcs.SingularMatrixError.html#astropy.wcs.SingularMatrixError" title="astropy.wcs.SingularMatrixError"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SingularMatrixError</span></code></a></dt><dd><p>Linear transformation matrix is singular.</p>
</dd>
<dt><a class="reference internal" href="astropy.wcs.InconsistentAxisTypesError.html#astropy.wcs.InconsistentAxisTypesError" title="astropy.wcs.InconsistentAxisTypesError"><code class="xref py py-obj docutils literal notranslate"><span class="pre">InconsistentAxisTypesError</span></code></a></dt><dd><p>Inconsistent or unrecognized coordinate axis types.</p>
</dd>
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ValueError</span></code></a></dt><dd><p>Invalid parameter value.</p>
</dd>
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ValueError</span></code></a></dt><dd><p>Invalid coordinate transformation parameters.</p>
</dd>
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ValueError</span></code></a></dt><dd><p>x- and y-coordinate arrays are not the same size.</p>
</dd>
<dt><a class="reference internal" href="astropy.wcs.InvalidTransformError.html#astropy.wcs.InvalidTransformError" title="astropy.wcs.InvalidTransformError"><code class="xref py py-obj docutils literal notranslate"><span class="pre">InvalidTransformError</span></code></a></dt><dd><p>Invalid coordinate transformation parameters.</p>
</dd>
<dt><a class="reference internal" href="astropy.wcs.InvalidTransformError.html#astropy.wcs.InvalidTransformError" title="astropy.wcs.InvalidTransformError"><code class="xref py py-obj docutils literal notranslate"><span class="pre">InvalidTransformError</span></code></a></dt><dd><p>Ill-conditioned coordinate transformation parameters.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The order of the axes for the input world array is determined by
the <code class="docutils literal notranslate"><span class="pre">CTYPEia</span></code> keywords in the FITS header, therefore it may
not always be of the form (<em>ra</em>, <em>dec</em>).  The
<a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.lat" title="astropy.wcs.Wcsprm.lat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lat</span></code></a>, <a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.lng" title="astropy.wcs.Wcsprm.lng"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lng</span></code></a>,
<a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.lattyp" title="astropy.wcs.Wcsprm.lattyp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lattyp</span></code></a>, and
<a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.lngtyp" title="astropy.wcs.Wcsprm.lngtyp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lngtyp</span></code></a>
members can be used to determine the order of the axes.</p>
<p>Using the method of fixed-point iterations approximations we
iterate starting with the initial approximation, which is
computed using the non-distortion-aware
<a class="reference internal" href="#astropy.wcs.WCS.wcs_world2pix" title="astropy.wcs.WCS.wcs_world2pix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">wcs_world2pix()</span></code></a> (or equivalent).</p>
<p>The <a class="reference internal" href="#astropy.wcs.WCS.all_world2pix" title="astropy.wcs.WCS.all_world2pix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">all_world2pix()</span></code></a> function uses a vectorized
implementation of the method of consecutive approximations and
therefore it is highly efficient (&gt;30x) when <em>all</em> data points
that need to be converted from sky coordinates to image
coordinates are passed at <em>once</em>. Therefore, it is advisable,
whenever possible, to pass as input a long array of all points
that need to be converted to <a class="reference internal" href="#astropy.wcs.WCS.all_world2pix" title="astropy.wcs.WCS.all_world2pix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">all_world2pix()</span></code></a> instead
of calling <a class="reference internal" href="#astropy.wcs.WCS.all_world2pix" title="astropy.wcs.WCS.all_world2pix"><code class="xref py py-meth docutils literal notranslate"><span class="pre">all_world2pix()</span></code></a> for each data point. Also
see the note to the <code class="docutils literal notranslate"><span class="pre">adaptive</span></code> parameter.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.io.fits</span> <span class="k">as</span> <span class="nn">fits</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.wcs</span> <span class="k">as</span> <span class="nn">wcs</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">os</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">wcs</span><span class="o">.</span><span class="n">__path__</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="s1">&#39;tests/data/j94f05bgq_flt.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdulist</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">w</span> <span class="o">=</span> <span class="n">wcs</span><span class="o">.</span><span class="n">WCS</span><span class="p">(</span><span class="n">hdulist</span><span class="p">[(</span><span class="s1">&#39;sci&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">)]</span><span class="o">.</span><span class="n">header</span><span class="p">,</span> <span class="n">hdulist</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdulist</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">all_pix2world</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ra</span><span class="p">)</span>  
<span class="go">[ 5.52645627  5.52649663  5.52653698]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">dec</span><span class="p">)</span>  
<span class="go">[-72.05171757 -72.05171276 -72.05170795]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">radec</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">all_pix2world</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">]],</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">radec</span><span class="p">)</span>  
<span class="go">[[  5.52645627 -72.05171757]</span>
<span class="go"> [  5.52649663 -72.05171276]</span>
<span class="go"> [  5.52653698 -72.05170795]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">all_world2pix</span><span class="p">(</span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>  
<span class="go">[ 1.00000238  2.00000237  3.00000236]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>  
<span class="go">[ 0.99999996  0.99999997  0.99999997]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">all_world2pix</span><span class="p">(</span><span class="n">radec</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">xy</span><span class="p">)</span>  
<span class="go">[[ 1.00000238  0.99999996]</span>
<span class="go"> [ 2.00000237  0.99999997]</span>
<span class="go"> [ 3.00000236  0.99999997]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">xy</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">all_world2pix</span><span class="p">(</span><span class="n">radec</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">tolerance</span><span class="o">=</span><span class="mf">1.0e-10</span><span class="p">,</span> <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NoConvergence</span>: <span class="n">&#39;WCS.all_world2pix&#39; failed to converge to the</span>
<span class="go">requested accuracy. After 3 iterations, the solution is</span>
<span class="go">diverging at least for one input point.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Now try to use some diverging data:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">divradec</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">all_pix2world</span><span class="p">([[</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="p">[</span><span class="mf">10000.0</span><span class="p">,</span> <span class="mf">50000.0</span><span class="p">],</span>
<span class="gp">... </span>                            <span class="p">[</span><span class="mf">3.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">]],</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">divradec</span><span class="p">)</span>  
<span class="go">[[  5.52645627 -72.05171757]</span>
<span class="go"> [  7.15976932 -70.8140779 ]</span>
<span class="go"> [  5.52653698 -72.05170795]]</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># First, turn detect_divergence on:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>  
<span class="gp">... </span>  <span class="n">xy</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">all_world2pix</span><span class="p">(</span><span class="n">divradec</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<span class="gp">... </span>                       <span class="n">tolerance</span><span class="o">=</span><span class="mf">1.0e-4</span><span class="p">,</span> <span class="n">adaptive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">... </span>                       <span class="n">detect_divergence</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>                       <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">... </span><span class="k">except</span> <span class="n">wcs</span><span class="o">.</span><span class="n">wcs</span><span class="o">.</span><span class="n">NoConvergence</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="gp">... </span>  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Indices of diverging points: </span><span class="si">{0}</span><span class="s2">&quot;</span>
<span class="gp">... </span>        <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">divergent</span><span class="p">))</span>
<span class="gp">... </span>  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Indices of poorly converging points: </span><span class="si">{0}</span><span class="s2">&quot;</span>
<span class="gp">... </span>        <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">slow_conv</span><span class="p">))</span>
<span class="gp">... </span>  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best solution:</span><span class="se">\n</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">best_solution</span><span class="p">))</span>
<span class="gp">... </span>  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Achieved accuracy:</span><span class="se">\n</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">accuracy</span><span class="p">))</span>
<span class="go">Indices of diverging points: [1]</span>
<span class="go">Indices of poorly converging points: None</span>
<span class="go">Best solution:</span>
<span class="go">[[  1.00000238e+00   9.99999965e-01]</span>
<span class="go"> [ -1.99441636e+06   1.44309097e+06]</span>
<span class="go"> [  3.00000236e+00   9.99999966e-01]]</span>
<span class="go">Achieved accuracy:</span>
<span class="go">[[  6.13968380e-05   8.59638593e-07]</span>
<span class="go"> [  8.59526812e+11   6.61713548e+11]</span>
<span class="go"> [  6.09398446e-05   8.38759724e-07]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">raise</span> <span class="n">e</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NoConvergence</span>: <span class="n">&#39;WCS.all_world2pix&#39; failed to converge to the</span>
<span class="go">requested accuracy.  After 5 iterations, the solution is</span>
<span class="go">diverging at least for one input point.</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># This time turn detect_divergence off:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">try</span><span class="p">:</span>  
<span class="gp">... </span>  <span class="n">xy</span> <span class="o">=</span> <span class="n">w</span><span class="o">.</span><span class="n">all_world2pix</span><span class="p">(</span><span class="n">divradec</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">maxiter</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
<span class="gp">... </span>                       <span class="n">tolerance</span><span class="o">=</span><span class="mf">1.0e-4</span><span class="p">,</span> <span class="n">adaptive</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">... </span>                       <span class="n">detect_divergence</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
<span class="gp">... </span>                       <span class="n">quiet</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">... </span><span class="k">except</span> <span class="n">wcs</span><span class="o">.</span><span class="n">wcs</span><span class="o">.</span><span class="n">NoConvergence</span> <span class="k">as</span> <span class="n">e</span><span class="p">:</span>
<span class="gp">... </span>  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Indices of diverging points: </span><span class="si">{0}</span><span class="s2">&quot;</span>
<span class="gp">... </span>        <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">divergent</span><span class="p">))</span>
<span class="gp">... </span>  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Indices of poorly converging points: </span><span class="si">{0}</span><span class="s2">&quot;</span>
<span class="gp">... </span>        <span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">slow_conv</span><span class="p">))</span>
<span class="gp">... </span>  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Best solution:</span><span class="se">\n</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">best_solution</span><span class="p">))</span>
<span class="gp">... </span>  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Achieved accuracy:</span><span class="se">\n</span><span class="si">{0}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">e</span><span class="o">.</span><span class="n">accuracy</span><span class="p">))</span>
<span class="go">Indices of diverging points: [1]</span>
<span class="go">Indices of poorly converging points: None</span>
<span class="go">Best solution:</span>
<span class="go">[[ 1.00000009  1.        ]</span>
<span class="go"> [        nan         nan]</span>
<span class="go"> [ 3.00000009  1.        ]]</span>
<span class="go">Achieved accuracy:</span>
<span class="go">[[  2.29417358e-06   3.21222995e-08]</span>
<span class="go"> [             nan              nan]</span>
<span class="go"> [  2.27407877e-06   3.13005639e-08]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">raise</span> <span class="n">e</span>
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">NoConvergence</span>: <span class="n">&#39;WCS.all_world2pix&#39; failed to converge to the</span>
<span class="go">requested accuracy.  After 6 iterations, the solution is</span>
<span class="go">diverging at least for one input point.</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt id="astropy.wcs.WCS.array_index_to_world">
<code class="sig-name descname"><span class="pre">array_index_to_world</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">index_arrays</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#astropy.wcs.WCS.array_index_to_world" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert array indices to world coordinates (represented by Astropy
objects).</p>
<p>If a single high-level object is used to represent the world coordinates
(i.e., if <code class="docutils literal notranslate"><span class="pre">len(wcs.world_axis_object_classes)</span> <span class="pre">==</span> <span class="pre">1</span></code>), it is returned
as-is (not in a tuple/list), otherwise a tuple of high-level objects is
returned. See
<a class="reference internal" href="astropy.wcs.wcsapi.BaseLowLevelWCS.html#astropy.wcs.wcsapi.BaseLowLevelWCS.array_index_to_world_values" title="astropy.wcs.wcsapi.BaseLowLevelWCS.array_index_to_world_values"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array_index_to_world_values</span></code></a> for
pixel indexing and ordering conventions.</p>
</dd></dl>

<dl class="py method">
<dt id="astropy.wcs.WCS.array_index_to_world_values">
<code class="sig-name descname"><span class="pre">array_index_to_world_values</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">index_arrays</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#astropy.wcs.WCS.array_index_to_world_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert array indices to world coordinates.</p>
<p>This is the same as <a class="reference internal" href="astropy.wcs.wcsapi.BaseLowLevelWCS.html#astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_to_world_values" title="astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_to_world_values"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pixel_to_world_values</span></code></a> except that
the indices should be given in <code class="docutils literal notranslate"><span class="pre">(i,</span> <span class="pre">j)</span></code> order, where for an image
<code class="docutils literal notranslate"><span class="pre">i</span></code> is the row and <code class="docutils literal notranslate"><span class="pre">j</span></code> is the column (i.e. the opposite order to
<a class="reference internal" href="astropy.wcs.wcsapi.BaseLowLevelWCS.html#astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_to_world_values" title="astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_to_world_values"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pixel_to_world_values</span></code></a>).</p>
<p>If <a class="reference internal" href="astropy.wcs.wcsapi.BaseLowLevelWCS.html#astropy.wcs.wcsapi.BaseLowLevelWCS.world_n_dim" title="astropy.wcs.wcsapi.BaseLowLevelWCS.world_n_dim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">world_n_dim</span></code></a> is <code class="docutils literal notranslate"><span class="pre">1</span></code>, this
method returns a single scalar or array, otherwise a tuple of scalars or
arrays is returned.</p>
</dd></dl>

<dl class="py method">
<dt id="astropy.wcs.WCS.calc_footprint">
<code class="sig-name descname"><span class="pre">calc_footprint</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">undistort</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">axes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">center</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.calc_footprint"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astropy.wcs.WCS.calc_footprint" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the footprint of the image on the sky.</p>
<p>A footprint is defined as the positions of the corners of the
image on the sky after all available distortions have been
applied.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>header</strong><span class="classifier"><a class="reference internal" href="../io/fits/api/headers.html#astropy.io.fits.Header" title="astropy.io.fits.Header"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Header</span></code></a> <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">object</span></code></a>, optional</span></dt><dd><p>Used to get <code class="docutils literal notranslate"><span class="pre">NAXIS1</span></code> and <code class="docutils literal notranslate"><span class="pre">NAXIS2</span></code>
header and axes are mutually exclusive, alternative ways
to provide the same information.</p>
</dd>
<dt><strong>undistort</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bltin-boolean-values" title="(in Python v3.10)"><span class="xref std std-ref">bool</span></a>, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>, take SIP and distortion lookup table into
account</p>
</dd>
<dt><strong>axes</strong><span class="classifier">(<a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a>, <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a>), optional</span></dt><dd><p>If provided, use the given sequence as the shape of the
image.  Otherwise, use the <code class="docutils literal notranslate"><span class="pre">NAXIS1</span></code> and <code class="docutils literal notranslate"><span class="pre">NAXIS2</span></code>
keywords from the header that was used to create this
<a class="reference internal" href="#astropy.wcs.WCS" title="astropy.wcs.WCS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WCS</span></code></a> object.</p>
</dd>
<dt><strong>center</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bltin-boolean-values" title="(in Python v3.10)"><span class="xref std std-ref">bool</span></a>, optional</span></dt><dd><p>If <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> use the center of the pixel, otherwise use the corner.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>coord</strong><span class="classifier">(4, 2) <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a> of (<em>x</em>, <em>y</em>) coordinates.</span></dt><dd><p>The order is clockwise starting with the bottom left corner.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astropy.wcs.WCS.copy">
<code class="sig-name descname"><span class="pre">copy</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.copy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astropy.wcs.WCS.copy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a shallow copy of the object.</p>
<p>Convenience method so user doesn’t have to import the
<a class="reference external" href="https://docs.python.org/3/library/copy.html#module-copy" title="(in Python v3.10)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">copy</span></code></a> stdlib module.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Use <a class="reference internal" href="#astropy.wcs.WCS.deepcopy" title="astropy.wcs.WCS.deepcopy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">deepcopy</span></code></a> instead of <a class="reference internal" href="#astropy.wcs.WCS.copy" title="astropy.wcs.WCS.copy"><code class="xref py py-obj docutils literal notranslate"><span class="pre">copy</span></code></a> unless you know why you need a
shallow copy.</p>
</div>
</dd></dl>

<dl class="py method">
<dt id="astropy.wcs.WCS.deepcopy">
<code class="sig-name descname"><span class="pre">deepcopy</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.deepcopy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astropy.wcs.WCS.deepcopy" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a deep copy of the object.</p>
<p>Convenience method so user doesn’t have to import the
<a class="reference external" href="https://docs.python.org/3/library/copy.html#module-copy" title="(in Python v3.10)"><code class="xref py py-mod docutils literal notranslate"><span class="pre">copy</span></code></a> stdlib module.</p>
</dd></dl>

<dl class="py method">
<dt id="astropy.wcs.WCS.det2im">
<code class="sig-name descname"><span class="pre">det2im</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.det2im"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astropy.wcs.WCS.det2im" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert detector coordinates to image plane coordinates using
<a class="reference external" href="https://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion paper</a> table-lookup correction.</p>
<p>The output is in absolute pixel coordinates, not relative to
<code class="docutils literal notranslate"><span class="pre">CRPIX</span></code>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>*args</strong></dt><dd><p>There are two accepted forms for the positional arguments:</p>
<blockquote>
<div><ul class="simple">
<li><p>2 arguments: An <em>N</em> x <em>2</em> array of coordinates, and an
<em>origin</em>.</p></li>
<li><p>more than 2 arguments: An array for each axis, followed by
an <em>origin</em>.  These arrays must be broadcastable to one
another.</p></li>
</ul>
</div></blockquote>
<p>Here, <em>origin</em> is the coordinate in the upper left corner of the
image.  In FITS and Fortran standards, this is 1.  In Numpy and C
standards this is 0.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a></span></dt><dd><p>Returns the pixel coordinates.  If the input was a single array and
origin, a single array is returned, otherwise a tuple of arrays is
returned.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#MemoryError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MemoryError</span></code></a></dt><dd><p>Memory allocation failed.</p>
</dd>
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ValueError</span></code></a></dt><dd><p>Invalid coordinate transformation parameters.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astropy.wcs.WCS.dropaxis">
<code class="sig-name descname"><span class="pre">dropaxis</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dropax</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.dropaxis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astropy.wcs.WCS.dropaxis" title="Permalink to this definition">¶</a></dt>
<dd><p>Remove an axis from the WCS.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>wcs</strong><span class="classifier"><a class="reference internal" href="#astropy.wcs.WCS" title="astropy.wcs.WCS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WCS</span></code></a></span></dt><dd><p>The WCS with naxis to be chopped to naxis-1</p>
</dd>
<dt><strong>dropax</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>The index of the WCS to drop, counting from 0 (i.e., python convention,
not FITS convention)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><a class="reference internal" href="#astropy.wcs.WCS" title="astropy.wcs.WCS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WCS</span></code></a></dt><dd><p>A new <a class="reference internal" href="#astropy.wcs.WCS" title="astropy.wcs.WCS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WCS</span></code></a> instance with one axis fewer</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astropy.wcs.WCS.fix">
<code class="sig-name descname"><span class="pre">fix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">translate_units</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">naxis</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.fix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astropy.wcs.WCS.fix" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform the fix operations from wcslib, and warn about any
changes it has made.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>translate_units</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">str</span></code></a>, optional</span></dt><dd><p>Specify which potentially unsafe translations of
non-standard unit strings to perform.  By default,
performs none.</p>
<p>Although <code class="docutils literal notranslate"><span class="pre">&quot;S&quot;</span></code> is commonly used to represent seconds,
its translation to <code class="docutils literal notranslate"><span class="pre">&quot;s&quot;</span></code> is potentially unsafe since the
standard recognizes <code class="docutils literal notranslate"><span class="pre">&quot;S&quot;</span></code> formally as Siemens, however
rarely that may be used.  The same applies to <code class="docutils literal notranslate"><span class="pre">&quot;H&quot;</span></code> for
hours (Henry), and <code class="docutils literal notranslate"><span class="pre">&quot;D&quot;</span></code> for days (Debye).</p>
<p>This string controls what to do in such cases, and is
case-insensitive.</p>
<ul class="simple">
<li><p>If the string contains <code class="docutils literal notranslate"><span class="pre">&quot;s&quot;</span></code>, translate <code class="docutils literal notranslate"><span class="pre">&quot;S&quot;</span></code> to
<code class="docutils literal notranslate"><span class="pre">&quot;s&quot;</span></code>.</p></li>
<li><p>If the string contains <code class="docutils literal notranslate"><span class="pre">&quot;h&quot;</span></code>, translate <code class="docutils literal notranslate"><span class="pre">&quot;H&quot;</span></code> to
<code class="docutils literal notranslate"><span class="pre">&quot;h&quot;</span></code>.</p></li>
<li><p>If the string contains <code class="docutils literal notranslate"><span class="pre">&quot;d&quot;</span></code>, translate <code class="docutils literal notranslate"><span class="pre">&quot;D&quot;</span></code> to
<code class="docutils literal notranslate"><span class="pre">&quot;d&quot;</span></code>.</p></li>
</ul>
<p>Thus <code class="docutils literal notranslate"><span class="pre">''</span></code> doesn’t do any unsafe translations, whereas
<code class="docutils literal notranslate"><span class="pre">'shd'</span></code> does all of them.</p>
</dd>
<dt><strong>naxis</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a> <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a>, optional</span></dt><dd><p>Image axis lengths.  If this array is set to zero or
<code class="docutils literal notranslate"><span class="pre">None</span></code>, then <a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.cylfix" title="astropy.wcs.Wcsprm.cylfix"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cylfix</span></code></a> will not be
invoked.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astropy.wcs.WCS.footprint_contains">
<code class="sig-name descname"><span class="pre">footprint_contains</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">coord</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.footprint_contains"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astropy.wcs.WCS.footprint_contains" title="Permalink to this definition">¶</a></dt>
<dd><p>Determines if a given SkyCoord is contained in the wcs footprint.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>coord</strong><span class="classifier"><a class="reference internal" href="astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord" title="astropy.coordinates.SkyCoord"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SkyCoord</span></code></a></span></dt><dd><p>The coordinate to check if it is within the wcs coordinate.</p>
</dd>
<dt><strong>**kwargs</strong></dt><dd><p>Additional arguments to pass to <a class="reference internal" href="astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord.to_pixel" title="astropy.coordinates.SkyCoord.to_pixel"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_pixel</span></code></a></p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>response</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bltin-boolean-values" title="(in Python v3.10)"><span class="xref std std-ref">bool</span></a></span></dt><dd><p>True means the WCS footprint contains the coordinate, False means it does not.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astropy.wcs.WCS.footprint_to_file">
<code class="sig-name descname"><span class="pre">footprint_to_file</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">filename</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'footprint.reg'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'green'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">width</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">coordsys</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.footprint_to_file"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astropy.wcs.WCS.footprint_to_file" title="Permalink to this definition">¶</a></dt>
<dd><p>Writes out a <a class="reference external" href="http://ds9.si.edu/">ds9</a> style regions file. It can be loaded
directly by <a class="reference external" href="http://ds9.si.edu/">ds9</a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>filename</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">str</span></code></a>, optional</span></dt><dd><p>Output file name - default is <code class="docutils literal notranslate"><span class="pre">'footprint.reg'</span></code></p>
</dd>
<dt><strong>color</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">str</span></code></a>, optional</span></dt><dd><p>Color to use when plotting the line.</p>
</dd>
<dt><strong>width</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a>, optional</span></dt><dd><p>Width of the region line.</p>
</dd>
<dt><strong>coordsys</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">str</span></code></a>, optional</span></dt><dd><p>Coordinate system. If not specified (default), the <code class="docutils literal notranslate"><span class="pre">radesys</span></code>
value is used. For all possible values, see
<a class="reference external" href="http://ds9.si.edu/doc/ref/region.html#RegionFileFormat">http://ds9.si.edu/doc/ref/region.html#RegionFileFormat</a></p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astropy.wcs.WCS.get_axis_types">
<code class="sig-name descname"><span class="pre">get_axis_types</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.get_axis_types"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astropy.wcs.WCS.get_axis_types" title="Permalink to this definition">¶</a></dt>
<dd><p>Similar to <a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.axis_types" title="astropy.wcs.Wcsprm.axis_types"><code class="xref py py-obj docutils literal notranslate"><span class="pre">self.wcsprm.axis_types</span></code></a>
but provides the information in a more Python-friendly format.</p>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl>
<dt><strong>result</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">dict</span></code></a></span></dt><dd><p>Returns a list of dictionaries, one for each axis, each
containing attributes about the type of that axis.</p>
<p>Each dictionary has the following keys:</p>
<ul class="simple">
<li><p>‘coordinate_type’:</p>
<ul>
<li><p>None: Non-specific coordinate type.</p></li>
<li><p>‘stokes’: Stokes coordinate.</p></li>
<li><p>‘celestial’: Celestial coordinate (including <code class="docutils literal notranslate"><span class="pre">CUBEFACE</span></code>).</p></li>
<li><p>‘spectral’: Spectral coordinate.</p></li>
</ul>
</li>
<li><p>‘scale’:</p>
<ul>
<li><p>‘linear’: Linear axis.</p></li>
<li><p>‘quantized’: Quantized axis (<code class="docutils literal notranslate"><span class="pre">STOKES</span></code>, <code class="docutils literal notranslate"><span class="pre">CUBEFACE</span></code>).</p></li>
<li><p>‘non-linear celestial’: Non-linear celestial axis.</p></li>
<li><p>‘non-linear spectral’: Non-linear spectral axis.</p></li>
<li><p>‘logarithmic’: Logarithmic axis.</p></li>
<li><p>‘tabular’: Tabular axis.</p></li>
</ul>
</li>
<li><p>‘group’</p>
<ul>
<li><p>Group number, e.g. lookup table number</p></li>
</ul>
</li>
<li><p>‘number’</p>
<ul>
<li><p>For celestial axes:</p>
<ul>
<li><p>0: Longitude coordinate.</p></li>
<li><p>1: Latitude coordinate.</p></li>
<li><p>2: <code class="docutils literal notranslate"><span class="pre">CUBEFACE</span></code> number.</p></li>
</ul>
</li>
<li><p>For lookup tables:</p>
<ul>
<li><p>the axis number in a multidimensional table.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">CTYPEia</span></code> in <code class="docutils literal notranslate"><span class="pre">&quot;4-3&quot;</span></code> form with unrecognized algorithm code will
generate an error.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astropy.wcs.WCS.p4_pix2foc">
<code class="sig-name descname"><span class="pre">p4_pix2foc</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.p4_pix2foc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astropy.wcs.WCS.p4_pix2foc" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert pixel coordinates to focal plane coordinates using
<a class="reference external" href="https://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion paper</a> table-lookup correction.</p>
<p>The output is in absolute pixel coordinates, not relative to
<code class="docutils literal notranslate"><span class="pre">CRPIX</span></code>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>*args</strong></dt><dd><p>There are two accepted forms for the positional arguments:</p>
<blockquote>
<div><ul class="simple">
<li><p>2 arguments: An <em>N</em> x <em>2</em> array of coordinates, and an
<em>origin</em>.</p></li>
<li><p>more than 2 arguments: An array for each axis, followed by
an <em>origin</em>.  These arrays must be broadcastable to one
another.</p></li>
</ul>
</div></blockquote>
<p>Here, <em>origin</em> is the coordinate in the upper left corner of the
image.  In FITS and Fortran standards, this is 1.  In Numpy and C
standards this is 0.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a></span></dt><dd><p>Returns the focal coordinates.  If the input was a single array and
origin, a single array is returned, otherwise a tuple of arrays is
returned.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#MemoryError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MemoryError</span></code></a></dt><dd><p>Memory allocation failed.</p>
</dd>
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ValueError</span></code></a></dt><dd><p>Invalid coordinate transformation parameters.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astropy.wcs.WCS.pix2foc">
<code class="sig-name descname"><span class="pre">pix2foc</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.pix2foc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astropy.wcs.WCS.pix2foc" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert pixel coordinates to focal plane coordinates using the
<a class="reference external" href="https://irsa.ipac.caltech.edu/data/SPITZER/docs/files/spitzer/shupeADASS.pdf">SIP</a> polynomial distortion convention and <a class="reference external" href="https://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion
paper</a> table-lookup correction.</p>
<p>The output is in absolute pixel coordinates, not relative to
<code class="docutils literal notranslate"><span class="pre">CRPIX</span></code>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>*args</strong></dt><dd><p>There are two accepted forms for the positional arguments:</p>
<blockquote>
<div><ul class="simple">
<li><p>2 arguments: An <em>N</em> x <em>2</em> array of coordinates, and an
<em>origin</em>.</p></li>
<li><p>more than 2 arguments: An array for each axis, followed by
an <em>origin</em>.  These arrays must be broadcastable to one
another.</p></li>
</ul>
</div></blockquote>
<p>Here, <em>origin</em> is the coordinate in the upper left corner of the
image.  In FITS and Fortran standards, this is 1.  In Numpy and C
standards this is 0.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a></span></dt><dd><p>Returns the focal coordinates.  If the input was a single array and
origin, a single array is returned, otherwise a tuple of arrays is
returned.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#MemoryError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MemoryError</span></code></a></dt><dd><p>Memory allocation failed.</p>
</dd>
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ValueError</span></code></a></dt><dd><p>Invalid coordinate transformation parameters.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astropy.wcs.WCS.pixel_to_world">
<code class="sig-name descname"><span class="pre">pixel_to_world</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">pixel_arrays</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#astropy.wcs.WCS.pixel_to_world" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert pixel coordinates to world coordinates (represented by
high-level objects).</p>
<p>If a single high-level object is used to represent the world coordinates
(i.e., if <code class="docutils literal notranslate"><span class="pre">len(wcs.world_axis_object_classes)</span> <span class="pre">==</span> <span class="pre">1</span></code>), it is returned
as-is (not in a tuple/list), otherwise a tuple of high-level objects is
returned. See
<a class="reference internal" href="astropy.wcs.wcsapi.BaseLowLevelWCS.html#astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_to_world_values" title="astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_to_world_values"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pixel_to_world_values</span></code></a> for pixel
indexing and ordering conventions.</p>
</dd></dl>

<dl class="py method">
<dt id="astropy.wcs.WCS.pixel_to_world_values">
<code class="sig-name descname"><span class="pre">pixel_to_world_values</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">pixel_arrays</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#astropy.wcs.WCS.pixel_to_world_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert pixel coordinates to world coordinates.</p>
<p>This method takes <a class="reference internal" href="astropy.wcs.wcsapi.BaseLowLevelWCS.html#astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_n_dim" title="astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_n_dim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pixel_n_dim</span></code></a> scalars or arrays as
input, and pixel coordinates should be zero-based. Returns
<a class="reference internal" href="astropy.wcs.wcsapi.BaseLowLevelWCS.html#astropy.wcs.wcsapi.BaseLowLevelWCS.world_n_dim" title="astropy.wcs.wcsapi.BaseLowLevelWCS.world_n_dim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">world_n_dim</span></code></a> scalars or arrays in units given by
<a class="reference internal" href="astropy.wcs.wcsapi.BaseLowLevelWCS.html#astropy.wcs.wcsapi.BaseLowLevelWCS.world_axis_units" title="astropy.wcs.wcsapi.BaseLowLevelWCS.world_axis_units"><code class="xref py py-obj docutils literal notranslate"><span class="pre">world_axis_units</span></code></a>. Note that pixel coordinates are
assumed to be 0 at the center of the first pixel in each dimension. If a
pixel is in a region where the WCS is not defined, NaN can be returned.
The coordinates should be specified in the <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code> order, where for
an image, <code class="docutils literal notranslate"><span class="pre">x</span></code> is the horizontal coordinate and <code class="docutils literal notranslate"><span class="pre">y</span></code> is the vertical
coordinate.</p>
<p>If <a class="reference internal" href="astropy.wcs.wcsapi.BaseLowLevelWCS.html#astropy.wcs.wcsapi.BaseLowLevelWCS.world_n_dim" title="astropy.wcs.wcsapi.BaseLowLevelWCS.world_n_dim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">world_n_dim</span></code></a> is <code class="docutils literal notranslate"><span class="pre">1</span></code>, this
method returns a single scalar or array, otherwise a tuple of scalars or
arrays is returned.</p>
</dd></dl>

<dl class="py method">
<dt id="astropy.wcs.WCS.printwcs">
<code class="sig-name descname"><span class="pre">printwcs</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.printwcs"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astropy.wcs.WCS.printwcs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="py method">
<dt id="astropy.wcs.WCS.proj_plane_pixel_area">
<code class="sig-name descname"><span class="pre">proj_plane_pixel_area</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.proj_plane_pixel_area"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astropy.wcs.WCS.proj_plane_pixel_area" title="Permalink to this definition">¶</a></dt>
<dd><p>For a <strong>celestial</strong> WCS (see <a class="reference internal" href="#astropy.wcs.WCS.celestial" title="astropy.wcs.WCS.celestial"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.wcs.WCS.celestial</span></code></a>), returns pixel
area of the image pixel at the <code class="docutils literal notranslate"><span class="pre">CRPIX</span></code> location once it is projected
onto the “plane of intermediate world coordinates” as defined in
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2002A%26A...395.1061G">Greisen &amp; Calabretta 2002, A&amp;A, 395, 1061</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is concerned <strong>only</strong> about the transformation
“image plane”-&gt;”projection plane” and <strong>not</strong> about the
transformation “celestial sphere”-&gt;”projection plane”-&gt;”image plane”.
Therefore, this function ignores distortions arising due to
non-linear nature of most projections.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method only returns sensible answers if the WCS contains
celestial axes, i.e., the <a class="reference internal" href="#astropy.wcs.WCS.celestial" title="astropy.wcs.WCS.celestial"><code class="xref py py-obj docutils literal notranslate"><span class="pre">celestial</span></code></a> WCS object.</p>
</div>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl>
<dt><strong>area</strong><span class="classifier"><a class="reference internal" href="astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Quantity</span></code></a></span></dt><dd><p>Area (in the projection plane) of the pixel at <code class="docutils literal notranslate"><span class="pre">CRPIX</span></code> location.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><dl class="simple">
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ValueError</span></code></a></dt><dd><p>Pixel area is defined only for 2D pixels. Most likely the
<a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.cd" title="astropy.wcs.Wcsprm.cd"><code class="xref py py-obj docutils literal notranslate"><span class="pre">cd</span></code></a> matrix of the <a class="reference internal" href="#astropy.wcs.WCS.celestial" title="astropy.wcs.WCS.celestial"><code class="xref py py-obj docutils literal notranslate"><span class="pre">celestial</span></code></a>
WCS is not a square matrix of second order.</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="astropy.wcs.utils.proj_plane_pixel_area.html#astropy.wcs.utils.proj_plane_pixel_area" title="astropy.wcs.utils.proj_plane_pixel_area"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.wcs.utils.proj_plane_pixel_area</span></code></a></dt><dd></dd>
</dl>
</div>
<p class="rubric">Notes</p>
<p>Depending on the application, square root of the pixel area can be used to
represent a single pixel scale of an equivalent square pixel
whose area is equal to the area of a generally non-square pixel.</p>
</dd></dl>

<dl class="py method">
<dt id="astropy.wcs.WCS.proj_plane_pixel_scales">
<code class="sig-name descname"><span class="pre">proj_plane_pixel_scales</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.proj_plane_pixel_scales"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astropy.wcs.WCS.proj_plane_pixel_scales" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate pixel scales along each axis of the image pixel at
the <code class="docutils literal notranslate"><span class="pre">CRPIX</span></code> location once it is projected onto the
“plane of intermediate world coordinates” as defined in
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2002A%26A...395.1061G">Greisen &amp; Calabretta 2002, A&amp;A, 395, 1061</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method is concerned <strong>only</strong> about the transformation
“image plane”-&gt;”projection plane” and <strong>not</strong> about the
transformation “celestial sphere”-&gt;”projection plane”-&gt;”image plane”.
Therefore, this function ignores distortions arising due to
non-linear nature of most projections.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This method only returns sensible answers if the WCS contains
celestial axes, i.e., the <a class="reference internal" href="#astropy.wcs.WCS.celestial" title="astropy.wcs.WCS.celestial"><code class="xref py py-obj docutils literal notranslate"><span class="pre">celestial</span></code></a> WCS object.</p>
</div>
<dl class="field-list">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><dl>
<dt><strong>scale</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">list</span></code></a> of <a class="reference internal" href="astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Quantity</span></code></a></span></dt><dd><p>A vector of projection plane increments corresponding to each
pixel side (axis).</p>
</dd>
</dl>
</dd>
</dl>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<dl class="simple">
<dt><a class="reference internal" href="astropy.wcs.utils.proj_plane_pixel_scales.html#astropy.wcs.utils.proj_plane_pixel_scales" title="astropy.wcs.utils.proj_plane_pixel_scales"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.wcs.utils.proj_plane_pixel_scales</span></code></a></dt><dd></dd>
</dl>
</div>
</dd></dl>

<dl class="py method">
<dt id="astropy.wcs.WCS.reorient_celestial_first">
<code class="sig-name descname"><span class="pre">reorient_celestial_first</span></code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.reorient_celestial_first"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astropy.wcs.WCS.reorient_celestial_first" title="Permalink to this definition">¶</a></dt>
<dd><p>Reorient the WCS such that the celestial axes are first, followed by
the spectral axis, followed by any others.
Assumes at least celestial axes are present.</p>
</dd></dl>

<dl class="py method">
<dt id="astropy.wcs.WCS.sip_foc2pix">
<code class="sig-name descname"><span class="pre">sip_foc2pix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.sip_foc2pix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astropy.wcs.WCS.sip_foc2pix" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert focal plane coordinates to pixel coordinates using the
<a class="reference external" href="https://irsa.ipac.caltech.edu/data/SPITZER/docs/files/spitzer/shupeADASS.pdf">SIP</a> polynomial distortion convention.</p>
<p>FITS WCS <a class="reference external" href="https://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion paper</a> table lookup distortion
correction is not applied, even if that information existed in
the FITS file that initialized this <a class="reference internal" href="#astropy.wcs.WCS" title="astropy.wcs.WCS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WCS</span></code></a> object.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>*args</strong></dt><dd><p>There are two accepted forms for the positional arguments:</p>
<blockquote>
<div><ul class="simple">
<li><p>2 arguments: An <em>N</em> x <em>2</em> array of coordinates, and an
<em>origin</em>.</p></li>
<li><p>more than 2 arguments: An array for each axis, followed by
an <em>origin</em>.  These arrays must be broadcastable to one
another.</p></li>
</ul>
</div></blockquote>
<p>Here, <em>origin</em> is the coordinate in the upper left corner of the
image.  In FITS and Fortran standards, this is 1.  In Numpy and C
standards this is 0.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a></span></dt><dd><p>Returns the pixel coordinates.  If the input was a single array and
origin, a single array is returned, otherwise a tuple of arrays is
returned.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#MemoryError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MemoryError</span></code></a></dt><dd><p>Memory allocation failed.</p>
</dd>
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ValueError</span></code></a></dt><dd><p>Invalid coordinate transformation parameters.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astropy.wcs.WCS.sip_pix2foc">
<code class="sig-name descname"><span class="pre">sip_pix2foc</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.sip_pix2foc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astropy.wcs.WCS.sip_pix2foc" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert pixel coordinates to focal plane coordinates using the
<a class="reference external" href="https://irsa.ipac.caltech.edu/data/SPITZER/docs/files/spitzer/shupeADASS.pdf">SIP</a> polynomial distortion convention.</p>
<p>The output is in pixel coordinates, relative to <code class="docutils literal notranslate"><span class="pre">CRPIX</span></code>.</p>
<p>FITS WCS <a class="reference external" href="https://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion paper</a> table lookup correction is not
applied, even if that information existed in the FITS file
that initialized this <a class="reference internal" href="#astropy.wcs.WCS" title="astropy.wcs.WCS"><code class="xref py py-class docutils literal notranslate"><span class="pre">WCS</span></code></a> object.  To
correct for that, use <a class="reference internal" href="#astropy.wcs.WCS.pix2foc" title="astropy.wcs.WCS.pix2foc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pix2foc</span></code></a> or
<a class="reference internal" href="#astropy.wcs.WCS.p4_pix2foc" title="astropy.wcs.WCS.p4_pix2foc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">p4_pix2foc</span></code></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>*args</strong></dt><dd><p>There are two accepted forms for the positional arguments:</p>
<blockquote>
<div><ul class="simple">
<li><p>2 arguments: An <em>N</em> x <em>2</em> array of coordinates, and an
<em>origin</em>.</p></li>
<li><p>more than 2 arguments: An array for each axis, followed by
an <em>origin</em>.  These arrays must be broadcastable to one
another.</p></li>
</ul>
</div></blockquote>
<p>Here, <em>origin</em> is the coordinate in the upper left corner of the
image.  In FITS and Fortran standards, this is 1.  In Numpy and C
standards this is 0.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a></span></dt><dd><p>Returns the focal coordinates.  If the input was a single array and
origin, a single array is returned, otherwise a tuple of arrays is
returned.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#MemoryError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MemoryError</span></code></a></dt><dd><p>Memory allocation failed.</p>
</dd>
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ValueError</span></code></a></dt><dd><p>Invalid coordinate transformation parameters.</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astropy.wcs.WCS.slice">
<code class="sig-name descname"><span class="pre">slice</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">view</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">numpy_order</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.slice"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astropy.wcs.WCS.slice" title="Permalink to this definition">¶</a></dt>
<dd><p>Slice a WCS instance using a Numpy slice. The order of the slice should
be reversed (as for the data) compared to the natural WCS order.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>view</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#tuple" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">tuple</span></code></a></span></dt><dd><p>A tuple containing the same number of slices as the WCS system.
The <code class="docutils literal notranslate"><span class="pre">step</span></code> method, the third argument to a slice, is not
presently supported.</p>
</dd>
<dt><strong>numpy_order</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bltin-boolean-values" title="(in Python v3.10)"><span class="xref std std-ref">bool</span></a></span></dt><dd><p>Use numpy order, i.e. slice the WCS so that an identical slice
applied to a numpy array will slice the array and WCS in the same
way. If set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>, the WCS will be sliced in FITS order,
meaning the first slice will be applied to the <em>last</em> numpy index
but the <em>first</em> WCS axis.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>wcs_new</strong><span class="classifier"><a class="reference internal" href="#astropy.wcs.WCS" title="astropy.wcs.WCS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WCS</span></code></a></span></dt><dd><p>A new resampled WCS axis</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astropy.wcs.WCS.sub">
<code class="sig-name descname"><span class="pre">sub</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">axes</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.sub"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astropy.wcs.WCS.sub" title="Permalink to this definition">¶</a></dt>
<dd><p>Extracts the coordinate description for a subimage from a
<a class="reference internal" href="#astropy.wcs.WCS" title="astropy.wcs.WCS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WCS</span></code></a> object.</p>
<p>The world coordinate system of the subimage must be separable in the
sense that the world coordinates at any point in the subimage must
depend only on the pixel coordinates of the axes extracted.  In
practice, this means that the <code class="docutils literal notranslate"><span class="pre">PCi_ja</span></code> matrix of the original image
must not contain non-zero off-diagonal terms that associate any of the
subimage axes with any of the non-subimage axes.</p>
<p><a class="reference internal" href="#astropy.wcs.WCS.sub" title="astropy.wcs.WCS.sub"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sub</span></code></a> can also add axes to a wcsprm object.  The new axes will be
created using the defaults set by the Wcsprm constructor which produce
a simple, unnamed, linear axis with world coordinates equal to the
pixel coordinate.  These default values can be changed before
invoking <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#set" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">set</span></code></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>axes</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a> or <code class="xref py py-obj docutils literal notranslate"><span class="pre">a</span></code> sequence.</span></dt><dd><ul class="simple">
<li><p>If an int, include the first <em>N</em> axes in their original order.</p></li>
<li><p>If a sequence, may contain a combination of image axis numbers
(1-relative) or special axis identifiers (see below).  Order is
significant; <code class="docutils literal notranslate"><span class="pre">axes[0]</span></code> is the axis number of the input image
that corresponds to the first axis in the subimage, etc.  Use an
axis number of 0 to create a new axis using the defaults.</p></li>
<li><p>If <code class="docutils literal notranslate"><span class="pre">0</span></code>, <code class="docutils literal notranslate"><span class="pre">[]</span></code> or <code class="docutils literal notranslate"><span class="pre">None</span></code>, do a deep copy.</p></li>
</ul>
<p>Coordinate axes types may be specified using either strings or
special integer constants.  The available types are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'longitude'</span></code> / <code class="docutils literal notranslate"><span class="pre">WCSSUB_LONGITUDE</span></code>: Celestial longitude</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'latitude'</span></code> / <code class="docutils literal notranslate"><span class="pre">WCSSUB_LATITUDE</span></code>: Celestial latitude</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'cubeface'</span></code> / <code class="docutils literal notranslate"><span class="pre">WCSSUB_CUBEFACE</span></code>: Quadcube <code class="docutils literal notranslate"><span class="pre">CUBEFACE</span></code> axis</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'spectral'</span></code> / <code class="docutils literal notranslate"><span class="pre">WCSSUB_SPECTRAL</span></code>: Spectral axis</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'stokes'</span></code> / <code class="docutils literal notranslate"><span class="pre">WCSSUB_STOKES</span></code>: Stokes axis</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'temporal'</span></code> / <code class="docutils literal notranslate"><span class="pre">WCSSUB_TIME</span></code>: Time axis (requires <code class="docutils literal notranslate"><span class="pre">WCSLIB</span></code> version 7.8 or greater)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'celestial'</span></code> / <code class="docutils literal notranslate"><span class="pre">WCSSUB_CELESTIAL</span></code>: An alias for the
combination of <code class="docutils literal notranslate"><span class="pre">'longitude'</span></code>, <code class="docutils literal notranslate"><span class="pre">'latitude'</span></code> and <code class="docutils literal notranslate"><span class="pre">'cubeface'</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>new_wcs</strong><span class="classifier"><a class="reference internal" href="#astropy.wcs.WCS" title="astropy.wcs.WCS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WCS</span></code></a> <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">object</span></code></a></span></dt><dd></dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#MemoryError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MemoryError</span></code></a></dt><dd><p>Memory allocation failed.</p>
</dd>
<dt><a class="reference internal" href="astropy.wcs.InvalidSubimageSpecificationError.html#astropy.wcs.InvalidSubimageSpecificationError" title="astropy.wcs.InvalidSubimageSpecificationError"><code class="xref py py-obj docutils literal notranslate"><span class="pre">InvalidSubimageSpecificationError</span></code></a></dt><dd><p>Invalid subimage specification (no spectral axis).</p>
</dd>
<dt><a class="reference internal" href="astropy.wcs.NonseparableSubimageCoordinateSystemError.html#astropy.wcs.NonseparableSubimageCoordinateSystemError" title="astropy.wcs.NonseparableSubimageCoordinateSystemError"><code class="xref py py-obj docutils literal notranslate"><span class="pre">NonseparableSubimageCoordinateSystemError</span></code></a></dt><dd><p>Non-separable subimage coordinate system.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>Combinations of subimage axes of particular types may be extracted in
the same order as they occur in the input image by combining the
integer constants with the ‘binary or’ (<code class="docutils literal notranslate"><span class="pre">|</span></code>) operator.  For
example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wcs</span><span class="o">.</span><span class="n">sub</span><span class="p">([</span><span class="n">WCSSUB_LONGITUDE</span> <span class="o">|</span> <span class="n">WCSSUB_LATITUDE</span> <span class="o">|</span> <span class="n">WCSSUB_SPECTRAL</span><span class="p">])</span>
</pre></div>
</div>
<p>would extract the longitude, latitude, and spectral axes in the same
order as the input image.  If one of each were present, the resulting
object would have three dimensions.</p>
<p>For convenience, <code class="docutils literal notranslate"><span class="pre">WCSSUB_CELESTIAL</span></code> is defined as the combination
<code class="docutils literal notranslate"><span class="pre">WCSSUB_LONGITUDE</span> <span class="pre">|</span> <span class="pre">WCSSUB_LATITUDE</span> <span class="pre">|</span> <span class="pre">WCSSUB_CUBEFACE</span></code>.</p>
<p>The codes may also be negated to extract all but the types specified,
for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">wcs</span><span class="o">.</span><span class="n">sub</span><span class="p">([</span>
  <span class="n">WCSSUB_LONGITUDE</span><span class="p">,</span>
  <span class="n">WCSSUB_LATITUDE</span><span class="p">,</span>
  <span class="n">WCSSUB_CUBEFACE</span><span class="p">,</span>
  <span class="o">-</span><span class="p">(</span><span class="n">WCSSUB_SPECTRAL</span> <span class="o">|</span> <span class="n">WCSSUB_STOKES</span><span class="p">)])</span>
</pre></div>
</div>
<p>The last of these specifies all axis types other than spectral or
Stokes.  Extraction is done in the order specified by <code class="docutils literal notranslate"><span class="pre">axes</span></code>, i.e. a
longitude axis (if present) would be extracted first (via <code class="docutils literal notranslate"><span class="pre">axes[0]</span></code>)
and not subsequently (via <code class="docutils literal notranslate"><span class="pre">axes[3]</span></code>).  Likewise for the latitude and
cubeface axes in this example.</p>
<p>The number of dimensions in the returned object may be less than or
greater than the length of <code class="docutils literal notranslate"><span class="pre">axes</span></code>.  However, it will never exceed the
number of axes in the input image.</p>
</dd></dl>

<dl class="py method">
<dt id="astropy.wcs.WCS.swapaxes">
<code class="sig-name descname"><span class="pre">swapaxes</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ax0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.swapaxes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astropy.wcs.WCS.swapaxes" title="Permalink to this definition">¶</a></dt>
<dd><p>Swap axes in a WCS.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>wcs</strong><span class="classifier"><a class="reference internal" href="#astropy.wcs.WCS" title="astropy.wcs.WCS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WCS</span></code></a></span></dt><dd><p>The WCS to have its axes swapped</p>
</dd>
<dt><strong>ax0</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd></dd>
<dt><strong>ax1</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a></span></dt><dd><p>The indices of the WCS to be swapped, counting from 0 (i.e., python
convention, not FITS convention)</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl class="simple">
<dt><a class="reference internal" href="#astropy.wcs.WCS" title="astropy.wcs.WCS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WCS</span></code></a></dt><dd><p>A new <a class="reference internal" href="#astropy.wcs.WCS" title="astropy.wcs.WCS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WCS</span></code></a> instance with the same number of axes,
but two swapped</p>
</dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astropy.wcs.WCS.to_fits">
<code class="sig-name descname"><span class="pre">to_fits</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">relax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.to_fits"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astropy.wcs.WCS.to_fits" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate an <a class="reference internal" href="../io/fits/api/hdulists.html#astropy.io.fits.HDUList" title="astropy.io.fits.HDUList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HDUList</span></code></a> object with all of the
information stored in this object.  This should be logically identical
to the input FITS file, but it will be normalized in a number of ways.</p>
<p>See <a class="reference internal" href="#astropy.wcs.WCS.to_header" title="astropy.wcs.WCS.to_header"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_header</span></code></a> for some warnings about the output produced.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>relax</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bltin-boolean-values" title="(in Python v3.10)"><span class="xref std std-ref">bool</span></a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a>, optional</span></dt><dd><p>Degree of permissiveness:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a> (default): Write all extensions that are
considered to be safe and recommended.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>: Write all recognized informal extensions of the
WCS standard.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>: a bit field selecting specific extensions to
write.  See <a class="reference internal" href="../wcs/relax.html#relaxwrite"><span class="std std-ref">Header-writing relaxation constants</span></a> for details.</p></li>
</ul>
</dd>
<dt><strong>key</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">str</span></code></a></span></dt><dd><p>The name of a particular WCS transform to use.  This may be
either <code class="docutils literal notranslate"><span class="pre">'</span> <span class="pre">'</span></code> or <code class="docutils literal notranslate"><span class="pre">'A'</span></code>-<code class="docutils literal notranslate"><span class="pre">'Z'</span></code> and corresponds to the <code class="docutils literal notranslate"><span class="pre">&quot;a&quot;</span></code>
part of the <code class="docutils literal notranslate"><span class="pre">CTYPEia</span></code> cards.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>hdulist</strong><span class="classifier"><a class="reference internal" href="../io/fits/api/hdulists.html#astropy.io.fits.HDUList" title="astropy.io.fits.HDUList"><code class="xref py py-obj docutils literal notranslate"><span class="pre">HDUList</span></code></a></span></dt><dd></dd>
</dl>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt id="astropy.wcs.WCS.to_header">
<code class="sig-name descname"><span class="pre">to_header</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">relax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.to_header"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astropy.wcs.WCS.to_header" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate an <a class="reference internal" href="../io/fits/api/headers.html#astropy.io.fits.Header" title="astropy.io.fits.Header"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits.Header</span></code></a> object with the basic WCS
and SIP information stored in this object.  This should be
logically identical to the input FITS file, but it will be
normalized in a number of ways.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This function does not write out FITS WCS <a class="reference external" href="https://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion
paper</a> information, since that requires multiple FITS
header data units.  To get a full representation of
everything in this object, use <a class="reference internal" href="#astropy.wcs.WCS.to_fits" title="astropy.wcs.WCS.to_fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_fits</span></code></a>.</p>
</div>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>relax</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bltin-boolean-values" title="(in Python v3.10)"><span class="xref std std-ref">bool</span></a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a>, optional</span></dt><dd><p>Degree of permissiveness:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a> (default): Write all extensions that are
considered to be safe and recommended.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a>: Write all recognized informal extensions of the
WCS standard.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">int</span></code></a>: a bit field selecting specific extensions to
write.  See <a class="reference internal" href="../wcs/relax.html#relaxwrite"><span class="std std-ref">Header-writing relaxation constants</span></a> for details.</p></li>
</ul>
<p>If the <code class="docutils literal notranslate"><span class="pre">relax</span></code> keyword argument is not given and any
keywords were omitted from the output, an
<a class="reference internal" href="astropy.utils.exceptions.AstropyWarning.html#astropy.utils.exceptions.AstropyWarning" title="astropy.utils.exceptions.AstropyWarning"><code class="xref py py-obj docutils literal notranslate"><span class="pre">AstropyWarning</span></code></a> is displayed.
To override this, explicitly pass a value to <code class="docutils literal notranslate"><span class="pre">relax</span></code>.</p>
</dd>
<dt><strong>key</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">str</span></code></a></span></dt><dd><p>The name of a particular WCS transform to use.  This may be
either <code class="docutils literal notranslate"><span class="pre">'</span> <span class="pre">'</span></code> or <code class="docutils literal notranslate"><span class="pre">'A'</span></code>-<code class="docutils literal notranslate"><span class="pre">'Z'</span></code> and corresponds to the <code class="docutils literal notranslate"><span class="pre">&quot;a&quot;</span></code>
part of the <code class="docutils literal notranslate"><span class="pre">CTYPEia</span></code> cards.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>header</strong><span class="classifier"><a class="reference internal" href="../io/fits/api/headers.html#astropy.io.fits.Header" title="astropy.io.fits.Header"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits.Header</span></code></a></span></dt><dd></dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The output header will almost certainly differ from the input in a
number of respects:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>The output header only contains WCS-related keywords.  In
particular, it does not contain syntactically-required
keywords such as <code class="docutils literal notranslate"><span class="pre">SIMPLE</span></code>, <code class="docutils literal notranslate"><span class="pre">NAXIS</span></code>, <code class="docutils literal notranslate"><span class="pre">BITPIX</span></code>, or
<code class="docutils literal notranslate"><span class="pre">END</span></code>.</p></li>
<li><p>Deprecated (e.g. <code class="docutils literal notranslate"><span class="pre">CROTAn</span></code>) or non-standard usage will
be translated to standard (this is partially dependent on
whether <code class="docutils literal notranslate"><span class="pre">fix</span></code> was applied).</p></li>
<li><p>Quantities will be converted to the units used internally,
basically SI with the addition of degrees.</p></li>
<li><p>Floating-point quantities may be given to a different decimal
precision.</p></li>
<li><p>Elements of the <code class="docutils literal notranslate"><span class="pre">PCi_j</span></code> matrix will be written if and
only if they differ from the unit matrix.  Thus, if the
matrix is unity then no elements will be written.</p></li>
<li><p>Additional keywords such as <code class="docutils literal notranslate"><span class="pre">WCSAXES</span></code>, <code class="docutils literal notranslate"><span class="pre">CUNITia</span></code>,
<code class="docutils literal notranslate"><span class="pre">LONPOLEa</span></code> and <code class="docutils literal notranslate"><span class="pre">LATPOLEa</span></code> may appear.</p></li>
<li><p>The original keycomments will be lost, although
<a class="reference internal" href="#astropy.wcs.WCS.to_header" title="astropy.wcs.WCS.to_header"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_header</span></code></a> tries hard to write meaningful comments.</p></li>
<li><p>Keyword order may be changed.</p></li>
</ol>
</div></blockquote>
</dd></dl>

<dl class="py method">
<dt id="astropy.wcs.WCS.to_header_string">
<code class="sig-name descname"><span class="pre">to_header_string</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">relax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.to_header_string"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astropy.wcs.WCS.to_header_string" title="Permalink to this definition">¶</a></dt>
<dd><p>Identical to <a class="reference internal" href="#astropy.wcs.WCS.to_header" title="astropy.wcs.WCS.to_header"><code class="xref py py-obj docutils literal notranslate"><span class="pre">to_header</span></code></a>, but returns a string containing the
header cards.</p>
</dd></dl>

<dl class="py method">
<dt id="astropy.wcs.WCS.wcs_pix2world">
<code class="sig-name descname"><span class="pre">wcs_pix2world</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.wcs_pix2world"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astropy.wcs.WCS.wcs_pix2world" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms pixel coordinates to world coordinates by doing
only the basic <a class="reference external" href="https://www.atnf.csiro.au/people/mcalabre/WCS/wcslib/index.html">wcslib</a> transformation.</p>
<p>No <a class="reference external" href="https://irsa.ipac.caltech.edu/data/SPITZER/docs/files/spitzer/shupeADASS.pdf">SIP</a> or <a class="reference external" href="https://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion paper</a> table lookup correction is
applied.  To perform distortion correction, see
<a class="reference internal" href="#astropy.wcs.WCS.all_pix2world" title="astropy.wcs.WCS.all_pix2world"><code class="xref py py-obj docutils literal notranslate"><span class="pre">all_pix2world</span></code></a>,
<a class="reference internal" href="#astropy.wcs.WCS.sip_pix2foc" title="astropy.wcs.WCS.sip_pix2foc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">sip_pix2foc</span></code></a>, <a class="reference internal" href="#astropy.wcs.WCS.p4_pix2foc" title="astropy.wcs.WCS.p4_pix2foc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">p4_pix2foc</span></code></a>,
or <a class="reference internal" href="#astropy.wcs.WCS.pix2foc" title="astropy.wcs.WCS.pix2foc"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pix2foc</span></code></a>.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>*args</strong></dt><dd><p>There are two accepted forms for the positional arguments:</p>
<blockquote>
<div><ul class="simple">
<li><p>2 arguments: An <em>N</em> x <em>naxis</em> array of coordinates, and an
<em>origin</em>.</p></li>
<li><p>more than 2 arguments: An array for each axis, followed by
an <em>origin</em>.  These arrays must be broadcastable to one
another.</p></li>
</ul>
</div></blockquote>
<p>Here, <em>origin</em> is the coordinate in the upper left corner of the
image.  In FITS and Fortran standards, this is 1.  In Numpy and C
standards this is 0.</p>
<p>For a transformation that is not two-dimensional, the
two-argument form must be used.</p>
</dd>
<dt><strong>ra_dec_order</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bltin-boolean-values" title="(in Python v3.10)"><span class="xref std std-ref">bool</span></a>, optional</span></dt><dd><p>When <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> will ensure that world coordinates are always given
and returned in as (<em>ra</em>, <em>dec</em>) pairs, regardless of the order of
the axes specified by the in the <code class="docutils literal notranslate"><span class="pre">CTYPE</span></code> keywords.  Default is
<a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a></span></dt><dd><p>Returns the world coordinates, in degrees.  If the input was a single array and
origin, a single array is returned, otherwise a tuple of arrays is
returned.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#MemoryError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MemoryError</span></code></a></dt><dd><p>Memory allocation failed.</p>
</dd>
<dt><a class="reference internal" href="astropy.wcs.SingularMatrixError.html#astropy.wcs.SingularMatrixError" title="astropy.wcs.SingularMatrixError"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SingularMatrixError</span></code></a></dt><dd><p>Linear transformation matrix is singular.</p>
</dd>
<dt><a class="reference internal" href="astropy.wcs.InconsistentAxisTypesError.html#astropy.wcs.InconsistentAxisTypesError" title="astropy.wcs.InconsistentAxisTypesError"><code class="xref py py-obj docutils literal notranslate"><span class="pre">InconsistentAxisTypesError</span></code></a></dt><dd><p>Inconsistent or unrecognized coordinate axis types.</p>
</dd>
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ValueError</span></code></a></dt><dd><p>Invalid parameter value.</p>
</dd>
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ValueError</span></code></a></dt><dd><p>Invalid coordinate transformation parameters.</p>
</dd>
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ValueError</span></code></a></dt><dd><p>x- and y-coordinate arrays are not the same size.</p>
</dd>
<dt><a class="reference internal" href="astropy.wcs.InvalidTransformError.html#astropy.wcs.InvalidTransformError" title="astropy.wcs.InvalidTransformError"><code class="xref py py-obj docutils literal notranslate"><span class="pre">InvalidTransformError</span></code></a></dt><dd><p>Invalid coordinate transformation parameters.</p>
</dd>
<dt><a class="reference internal" href="astropy.wcs.InvalidTransformError.html#astropy.wcs.InvalidTransformError" title="astropy.wcs.InvalidTransformError"><code class="xref py py-obj docutils literal notranslate"><span class="pre">InvalidTransformError</span></code></a></dt><dd><p>Ill-conditioned coordinate transformation parameters.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The order of the axes for the result is determined by the
<code class="docutils literal notranslate"><span class="pre">CTYPEia</span></code> keywords in the FITS header, therefore it may not
always be of the form (<em>ra</em>, <em>dec</em>).  The
<a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.lat" title="astropy.wcs.Wcsprm.lat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lat</span></code></a>, <a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.lng" title="astropy.wcs.Wcsprm.lng"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lng</span></code></a>,
<a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.lattyp" title="astropy.wcs.Wcsprm.lattyp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lattyp</span></code></a> and <a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.lngtyp" title="astropy.wcs.Wcsprm.lngtyp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lngtyp</span></code></a>
members can be used to determine the order of the axes.</p>
</dd></dl>

<dl class="py method">
<dt id="astropy.wcs.WCS.wcs_world2pix">
<code class="sig-name descname"><span class="pre">wcs_world2pix</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/astropy/wcs/wcs.html#WCS.wcs_world2pix"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astropy.wcs.WCS.wcs_world2pix" title="Permalink to this definition">¶</a></dt>
<dd><p>Transforms world coordinates to pixel coordinates, using only
the basic <a class="reference external" href="https://www.atnf.csiro.au/people/mcalabre/WCS/wcslib/index.html">wcslib</a> WCS transformation.  No <a class="reference external" href="https://irsa.ipac.caltech.edu/data/SPITZER/docs/files/spitzer/shupeADASS.pdf">SIP</a> or
<a class="reference external" href="https://www.atnf.csiro.au/people/mcalabre/WCS/dcs_20040422.pdf">distortion paper</a> table lookup transformation is applied.</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>*args</strong></dt><dd><p>There are two accepted forms for the positional arguments:</p>
<blockquote>
<div><ul class="simple">
<li><p>2 arguments: An <em>N</em> x <em>naxis</em> array of coordinates, and an
<em>origin</em>.</p></li>
<li><p>more than 2 arguments: An array for each axis, followed by
an <em>origin</em>.  These arrays must be broadcastable to one
another.</p></li>
</ul>
</div></blockquote>
<p>Here, <em>origin</em> is the coordinate in the upper left corner of the
image.  In FITS and Fortran standards, this is 1.  In Numpy and C
standards this is 0.</p>
<p>For a transformation that is not two-dimensional, the
two-argument form must be used.</p>
</dd>
<dt><strong>ra_dec_order</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bltin-boolean-values" title="(in Python v3.10)"><span class="xref std std-ref">bool</span></a>, optional</span></dt><dd><p>When <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> will ensure that world coordinates are always given
and returned in as (<em>ra</em>, <em>dec</em>) pairs, regardless of the order of
the axes specified by the in the <code class="docutils literal notranslate"><span class="pre">CTYPE</span></code> keywords.  Default is
<a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>result</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a></span></dt><dd><p>Returns the pixel coordinates.  If the input was a single array and
origin, a single array is returned, otherwise a tuple of arrays is
returned.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#MemoryError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">MemoryError</span></code></a></dt><dd><p>Memory allocation failed.</p>
</dd>
<dt><a class="reference internal" href="astropy.wcs.SingularMatrixError.html#astropy.wcs.SingularMatrixError" title="astropy.wcs.SingularMatrixError"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SingularMatrixError</span></code></a></dt><dd><p>Linear transformation matrix is singular.</p>
</dd>
<dt><a class="reference internal" href="astropy.wcs.InconsistentAxisTypesError.html#astropy.wcs.InconsistentAxisTypesError" title="astropy.wcs.InconsistentAxisTypesError"><code class="xref py py-obj docutils literal notranslate"><span class="pre">InconsistentAxisTypesError</span></code></a></dt><dd><p>Inconsistent or unrecognized coordinate axis types.</p>
</dd>
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ValueError</span></code></a></dt><dd><p>Invalid parameter value.</p>
</dd>
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ValueError</span></code></a></dt><dd><p>Invalid coordinate transformation parameters.</p>
</dd>
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ValueError</span></code></a></dt><dd><p>x- and y-coordinate arrays are not the same size.</p>
</dd>
<dt><a class="reference internal" href="astropy.wcs.InvalidTransformError.html#astropy.wcs.InvalidTransformError" title="astropy.wcs.InvalidTransformError"><code class="xref py py-obj docutils literal notranslate"><span class="pre">InvalidTransformError</span></code></a></dt><dd><p>Invalid coordinate transformation parameters.</p>
</dd>
<dt><a class="reference internal" href="astropy.wcs.InvalidTransformError.html#astropy.wcs.InvalidTransformError" title="astropy.wcs.InvalidTransformError"><code class="xref py py-obj docutils literal notranslate"><span class="pre">InvalidTransformError</span></code></a></dt><dd><p>Ill-conditioned coordinate transformation parameters.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The order of the axes for the input world array is determined by
the <code class="docutils literal notranslate"><span class="pre">CTYPEia</span></code> keywords in the FITS header, therefore it may
not always be of the form (<em>ra</em>, <em>dec</em>).  The
<a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.lat" title="astropy.wcs.Wcsprm.lat"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lat</span></code></a>, <a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.lng" title="astropy.wcs.Wcsprm.lng"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lng</span></code></a>,
<a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.lattyp" title="astropy.wcs.Wcsprm.lattyp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lattyp</span></code></a> and <a class="reference internal" href="astropy.wcs.Wcsprm.html#astropy.wcs.Wcsprm.lngtyp" title="astropy.wcs.Wcsprm.lngtyp"><code class="xref py py-obj docutils literal notranslate"><span class="pre">lngtyp</span></code></a>
members can be used to determine the order of the axes.</p>
</dd></dl>

<dl class="py method">
<dt id="astropy.wcs.WCS.world_to_array_index">
<code class="sig-name descname"><span class="pre">world_to_array_index</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">world_objects</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#astropy.wcs.WCS.world_to_array_index" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert world coordinates (represented by Astropy objects) to array
indices.</p>
<p>If <a class="reference internal" href="astropy.wcs.wcsapi.BaseLowLevelWCS.html#astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_n_dim" title="astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_n_dim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pixel_n_dim</span></code></a> is <code class="docutils literal notranslate"><span class="pre">1</span></code>, this
method returns a single scalar or array, otherwise a tuple of scalars or
arrays is returned. See
<a class="reference internal" href="astropy.wcs.wcsapi.BaseLowLevelWCS.html#astropy.wcs.wcsapi.BaseLowLevelWCS.world_to_array_index_values" title="astropy.wcs.wcsapi.BaseLowLevelWCS.world_to_array_index_values"><code class="xref py py-obj docutils literal notranslate"><span class="pre">world_to_array_index_values</span></code></a> for
pixel indexing and ordering conventions. The indices should be returned
as rounded integers.</p>
</dd></dl>

<dl class="py method">
<dt id="astropy.wcs.WCS.world_to_array_index_values">
<code class="sig-name descname"><span class="pre">world_to_array_index_values</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">world_arrays</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#astropy.wcs.WCS.world_to_array_index_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert world coordinates to array indices.</p>
<p>This is the same as <a class="reference internal" href="astropy.wcs.wcsapi.BaseLowLevelWCS.html#astropy.wcs.wcsapi.BaseLowLevelWCS.world_to_pixel_values" title="astropy.wcs.wcsapi.BaseLowLevelWCS.world_to_pixel_values"><code class="xref py py-obj docutils literal notranslate"><span class="pre">world_to_pixel_values</span></code></a> except that
the indices should be returned in <code class="docutils literal notranslate"><span class="pre">(i,</span> <span class="pre">j)</span></code> order, where for an image
<code class="docutils literal notranslate"><span class="pre">i</span></code> is the row and <code class="docutils literal notranslate"><span class="pre">j</span></code> is the column (i.e. the opposite order to
<a class="reference internal" href="astropy.wcs.wcsapi.BaseLowLevelWCS.html#astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_to_world_values" title="astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_to_world_values"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pixel_to_world_values</span></code></a>). The indices should be
returned as rounded integers.</p>
<p>If <a class="reference internal" href="astropy.wcs.wcsapi.BaseLowLevelWCS.html#astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_n_dim" title="astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_n_dim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pixel_n_dim</span></code></a> is <code class="docutils literal notranslate"><span class="pre">1</span></code>, this
method returns a single scalar or array, otherwise a tuple of scalars or
arrays is returned.</p>
</dd></dl>

<dl class="py method">
<dt id="astropy.wcs.WCS.world_to_pixel">
<code class="sig-name descname"><span class="pre">world_to_pixel</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">world_objects</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#astropy.wcs.WCS.world_to_pixel" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert world coordinates (represented by Astropy objects) to pixel
coordinates.</p>
<p>If <a class="reference internal" href="astropy.wcs.wcsapi.BaseLowLevelWCS.html#astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_n_dim" title="astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_n_dim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pixel_n_dim</span></code></a> is <code class="docutils literal notranslate"><span class="pre">1</span></code>, this
method returns a single scalar or array, otherwise a tuple of scalars or
arrays is returned. See
<a class="reference internal" href="astropy.wcs.wcsapi.BaseLowLevelWCS.html#astropy.wcs.wcsapi.BaseLowLevelWCS.world_to_pixel_values" title="astropy.wcs.wcsapi.BaseLowLevelWCS.world_to_pixel_values"><code class="xref py py-obj docutils literal notranslate"><span class="pre">world_to_pixel_values</span></code></a> for pixel
indexing and ordering conventions.</p>
</dd></dl>

<dl class="py method">
<dt id="astropy.wcs.WCS.world_to_pixel_values">
<code class="sig-name descname"><span class="pre">world_to_pixel_values</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">world_arrays</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#astropy.wcs.WCS.world_to_pixel_values" title="Permalink to this definition">¶</a></dt>
<dd><p>Convert world coordinates to pixel coordinates.</p>
<p>This method takes <a class="reference internal" href="astropy.wcs.wcsapi.BaseLowLevelWCS.html#astropy.wcs.wcsapi.BaseLowLevelWCS.world_n_dim" title="astropy.wcs.wcsapi.BaseLowLevelWCS.world_n_dim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">world_n_dim</span></code></a> scalars or arrays as
input in units given by <a class="reference internal" href="astropy.wcs.wcsapi.BaseLowLevelWCS.html#astropy.wcs.wcsapi.BaseLowLevelWCS.world_axis_units" title="astropy.wcs.wcsapi.BaseLowLevelWCS.world_axis_units"><code class="xref py py-obj docutils literal notranslate"><span class="pre">world_axis_units</span></code></a>. Returns
<a class="reference internal" href="astropy.wcs.wcsapi.BaseLowLevelWCS.html#astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_n_dim" title="astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_n_dim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pixel_n_dim</span></code></a> scalars or arrays. Note that pixel
coordinates are assumed to be 0 at the center of the first pixel in each
dimension. If a world coordinate does not have a matching pixel
coordinate, NaN can be returned.  The coordinates should be returned in
the <code class="docutils literal notranslate"><span class="pre">(x,</span> <span class="pre">y)</span></code> order, where for an image, <code class="docutils literal notranslate"><span class="pre">x</span></code> is the horizontal
coordinate and <code class="docutils literal notranslate"><span class="pre">y</span></code> is the vertical coordinate.</p>
<p>If <a class="reference internal" href="astropy.wcs.wcsapi.BaseLowLevelWCS.html#astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_n_dim" title="astropy.wcs.wcsapi.BaseLowLevelWCS.pixel_n_dim"><code class="xref py py-obj docutils literal notranslate"><span class="pre">pixel_n_dim</span></code></a> is <code class="docutils literal notranslate"><span class="pre">1</span></code>, this
method returns a single scalar or array, otherwise a tuple of scalars or
arrays is returned.</p>
</dd></dl>

</dd></dl>

</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">WCS</a></li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/astropy.wcs.WCS.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011–2022, The Astropy Developers.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 3.5.4. &nbsp;
    Last built 09 May 2022. <br/>
  </p>
</footer>
  </body>
</html>