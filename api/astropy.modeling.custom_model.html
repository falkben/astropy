


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>custom_model &#8212; Astropy v5.2.dev96+g04a0cf8bb</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="fix_inputs" href="astropy.modeling.fix_inputs.html" />
    <link rel="prev" title="bind_compound_bounding_box" href="astropy.modeling.bind_compound_bounding_box.html" />
  
  <meta name="robots" content="noindex, nofollow">
  
  
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>


  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="astropy.modeling.fix_inputs.html" title="fix_inputs">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="astropy.modeling.bind_compound_bounding_box.html" title="bind_compound_bounding_box">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">Astropy v5.2.dev96+g04a0cf8bb</a>
	 &#187;
      </li>
      <li><a href="../modeling/index.html" >Models and Fitting (<code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.modeling</span></code>)</a> &#187;</li>
      <li><a href="../modeling/reference_api.html" accesskey="U">Reference/API</a> &#187;</li>
      
      <li>custom_model</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="custom-model">
<h1>custom_model<a class="headerlink" href="#custom-model" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="astropy.modeling.custom_model">
<code class="sig-prename descclassname"><span class="pre">astropy.modeling.</span></code><code class="sig-name descname"><span class="pre">custom_model</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fit_deriv</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/astropy/modeling/core.html#custom_model"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astropy.modeling.custom_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Create a model from a user defined function. The inputs and parameters of
the model will be inferred from the arguments of the function.</p>
<p>This can be used either as a function or as a decorator.  See below for
examples of both usages.</p>
<p>The model is separable only if there is a single input.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>All model parameters have to be defined as keyword arguments with
default values in the model function.  Use <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a> as a default argument
value if you do not want to have a default value for that parameter.</p>
<p>The standard settable model properties can be configured by default
using keyword arguments matching the name of the property; however,
these values are not set as model “parameters”. Moreover, users
cannot use keyword arguments matching non-settable model properties,
with the exception of <code class="docutils literal notranslate"><span class="pre">n_outputs</span></code> which should be set to the number of
outputs of your function.</p>
</div>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>func</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/glossary.html#term-function" title="(in Python v3.10)"><span>function</span></a></span></dt><dd><p>Function which defines the model.  It should take N positional
arguments where <code class="docutils literal notranslate"><span class="pre">N</span></code> is dimensions of the model (the number of
independent variable in the model), and any number of keyword arguments
(the parameters).  It must return the value of the model (typically as
an array, but can also be a scalar for scalar inputs).  This
corresponds to the <a class="reference internal" href="astropy.modeling.Model.html#astropy.modeling.Model.evaluate" title="astropy.modeling.Model.evaluate"><code class="xref py py-obj docutils literal notranslate"><span class="pre">evaluate</span></code></a> method.</p>
</dd>
<dt><strong>fit_deriv</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/glossary.html#term-function" title="(in Python v3.10)"><span>function</span></a>, optional</span></dt><dd><p>Function which defines the Jacobian derivative of the model. I.e., the
derivative with respect to the <em>parameters</em> of the model.  It should
have the same argument signature as <code class="docutils literal notranslate"><span class="pre">func</span></code>, but should return a
sequence where each element of the sequence is the derivative
with respect to the corresponding argument. This corresponds to the
<a class="reference internal" href="astropy.modeling.FittableModel.html#astropy.modeling.FittableModel.fit_deriv" title="astropy.modeling.FittableModel.fit_deriv"><code class="xref py py-meth docutils literal notranslate"><span class="pre">fit_deriv()</span></code></a> method.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Define a sinusoidal model function as a custom 1D model:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.modeling.models</span> <span class="kn">import</span> <span class="n">custom_model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">sine_model</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">amplitude</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="mf">1.</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">amplitude</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">frequency</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">sine_deriv</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">amplitude</span><span class="o">=</span><span class="mf">1.</span><span class="p">,</span> <span class="n">frequency</span><span class="o">=</span><span class="mf">1.</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">amplitude</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">frequency</span> <span class="o">*</span> <span class="n">x</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">SineModel</span> <span class="o">=</span> <span class="n">custom_model</span><span class="p">(</span><span class="n">sine_model</span><span class="p">,</span> <span class="n">fit_deriv</span><span class="o">=</span><span class="n">sine_deriv</span><span class="p">)</span>
</pre></div>
</div>
<p>Create an instance of the custom model and evaluate it:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">SineModel</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
<span class="go">1.0</span>
</pre></div>
</div>
<p>This model instance can now be used like a usual astropy model.</p>
<p>The next example demonstrates a 2D Moffat function model, and also
demonstrates the support for docstrings (this example could also include
a derivative, but it has been omitted for simplicity):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@custom_model</span>
<span class="gp">... </span><span class="k">def</span> <span class="nf">Moffat2D</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">amplitude</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">x_0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">y_0</span><span class="o">=</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">gamma</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">alpha</span><span class="o">=</span><span class="mf">1.0</span><span class="p">):</span>
<span class="gp">... </span>    <span class="sd">&quot;&quot;&quot;Two dimensional Moffat function.&quot;&quot;&quot;</span>
<span class="gp">... </span>    <span class="n">rr_gg</span> <span class="o">=</span> <span class="p">((</span><span class="n">x</span> <span class="o">-</span> <span class="n">x_0</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">y</span> <span class="o">-</span> <span class="n">y_0</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">/</span> <span class="n">gamma</span> <span class="o">**</span> <span class="mi">2</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">amplitude</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">rr_gg</span><span class="p">)</span> <span class="o">**</span> <span class="p">(</span><span class="o">-</span><span class="n">alpha</span><span class="p">)</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">Moffat2D</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
<span class="go">Two dimensional Moffat function.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">Moffat2D</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>  
<span class="go">0.3333333333333333</span>
</pre></div>
</div>
</dd></dl>

</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">custom_model</a></li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/astropy.modeling.custom_model.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011–2022, The Astropy Developers.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 3.5.4. &nbsp;
    Last built 09 May 2022. <br/>
  </p>
</footer>
  </body>
</html>