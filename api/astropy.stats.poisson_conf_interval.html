


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>poisson_conf_interval &#8212; Astropy v5.2.dev104+gcdd6a1f81.d20220509</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="median_absolute_deviation" href="astropy.stats.median_absolute_deviation.html" />
    <link rel="prev" title="binned_binom_proportion" href="astropy.stats.binned_binom_proportion.html" />
  
  <meta name="robots" content="noindex, nofollow">
  
  
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>


  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="astropy.stats.median_absolute_deviation.html" title="median_absolute_deviation">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="astropy.stats.binned_binom_proportion.html" title="binned_binom_proportion">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">Astropy v5.2.dev104+gcdd6a1f81.d20220509</a>
	 &#187;
      </li>
      <li><a href="../stats/index.html" accesskey="U">Astrostatistics Tools (<code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.stats</span></code>)</a> &#187;</li>
      
      <li>poisson_conf_interval</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="poisson-conf-interval">
<h1>poisson_conf_interval<a class="headerlink" href="#poisson-conf-interval" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="astropy.stats.poisson_conf_interval">
<code class="sig-prename descclassname"><span class="pre">astropy.stats.</span></code><code class="sig-name descname"><span class="pre">poisson_conf_interval</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">n</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'root-n'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sigma</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">background</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">confidence_level</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/astropy/stats/funcs.html#poisson_conf_interval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astropy.stats.poisson_conf_interval" title="Permalink to this definition">¶</a></dt>
<dd><p>Poisson parameter confidence interval given observed counts</p>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>n</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a> or <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a></span></dt><dd><p>Number of counts (0 &lt;= <code class="docutils literal notranslate"><span class="pre">n</span></code>).</p>
</dd>
<dt><strong>interval</strong><span class="classifier">{‘root-n’,’root-n-0’,’pearson’,’sherpagehrels’,’frequentist-confidence’, ‘kraft-burrows-nousek’}, optional</span></dt><dd><p>Formula used for confidence interval. See notes for details.
Default is <code class="docutils literal notranslate"><span class="pre">'root-n'</span></code>.</p>
</dd>
<dt><strong>sigma</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">float</span></code></a>, optional</span></dt><dd><p>Number of sigma for confidence interval; only supported for
the ‘frequentist-confidence’ mode.</p>
</dd>
<dt><strong>background</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">float</span></code></a>, optional</span></dt><dd><p>Number of counts expected from the background; only supported for
the ‘kraft-burrows-nousek’ mode. This number is assumed to be determined
from a large region so that the uncertainty on its value is negligible.</p>
</dd>
<dt><strong>confidence_level</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">float</span></code></a>, optional</span></dt><dd><p>Confidence level between 0 and 1; only supported for the
‘kraft-burrows-nousek’ mode.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>conf_interval</strong><span class="classifier"><a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code></a></span></dt><dd><p><code class="docutils literal notranslate"><span class="pre">conf_interval[0]</span></code> and <code class="docutils literal notranslate"><span class="pre">conf_interval[1]</span></code> correspond to the lower
and upper limits, respectively, for each element in <code class="docutils literal notranslate"><span class="pre">n</span></code>.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The “right” confidence interval to use for Poisson data is a
matter of debate. The CDF working group <a class="reference external" href="https://web.archive.org/web/20210222093249/https://www-cdf.fnal.gov/physics/statistics/notes/pois_eb.txt">recommends</a>
using root-n throughout, largely in the interest of
comprehensibility, but discusses other possibilities. The ATLAS
group also discusses several
possibilities but concludes that no single representation is
suitable for all cases.  The suggestion has also been <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2012EPJP..127...24A">floated</a> that error
bars should be attached to theoretical predictions instead of
observed data, which this function will not help with (but it’s
easy; then you really should use the square root of the theoretical
prediction).</p>
<p>The intervals implemented here are:</p>
<p><strong>1. ‘root-n’</strong> This is a very widely used standard rule derived
from the maximum-likelihood estimator for the mean of the Poisson
process. While it produces questionable results for small n and
outright wrong results for n=0, it is standard enough that people are
(supposedly) used to interpreting these wonky values. The interval is</p>
<div class="math notranslate nohighlight">
\[CI = (n-\sqrt{n}, n+\sqrt{n})\]</div>
<p><strong>2. ‘root-n-0’</strong> This is identical to the above except that where
n is zero the interval returned is (0,1).</p>
<p><strong>3. ‘pearson’</strong> This is an only-slightly-more-complicated rule
based on Pearson’s chi-squared rule (as <a class="reference external" href="https://web.archive.org/web/20210222093249/https://www-cdf.fnal.gov/physics/statistics/notes/pois_eb.txt">explained</a> by
the CDF working group). It also has the nice feature that if your
theory curve touches an endpoint of the interval, then your data
point is indeed one sigma away. The interval is</p>
<div class="math notranslate nohighlight">
\[CI = (n+0.5-\sqrt{n+0.25}, n+0.5+\sqrt{n+0.25})\]</div>
<p><strong>4. ‘sherpagehrels’</strong> This rule is used by default in the fitting
package ‘sherpa’. The <a class="reference external" href="https://cxc.harvard.edu/sherpa4.4/statistics/#chigehrels">documentation</a> claims
it is based on a numerical approximation published in <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1986ApJ...303..336G">Gehrels
(1986)</a> but it
does not actually appear there.  It is symmetrical, and while the
upper limits are within about 1% of those given by
‘frequentist-confidence’, the lower limits can be badly wrong. The
interval is</p>
<div class="math notranslate nohighlight">
\[CI = (n-1-\sqrt{n+0.75}, n+1+\sqrt{n+0.75})\]</div>
<p><strong>5. ‘frequentist-confidence’</strong> These are frequentist central
confidence intervals:</p>
<div class="math notranslate nohighlight">
\[CI = (0.5 F_{\chi^2}^{-1}(\alpha;2n),
      0.5 F_{\chi^2}^{-1}(1-\alpha;2(n+1)))\]</div>
<p>where <span class="math notranslate nohighlight">\(F_{\chi^2}^{-1}\)</span> is the quantile of the chi-square
distribution with the indicated number of degrees of freedom and
<span class="math notranslate nohighlight">\(\alpha\)</span> is the one-tailed probability of the normal
distribution (at the point given by the parameter ‘sigma’). See
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2011arXiv1102.0822M">Maxwell (2011)</a> for further
details.</p>
<p><strong>6. ‘kraft-burrows-nousek’</strong> This is a Bayesian approach which allows
for the presence of a known background <span class="math notranslate nohighlight">\(B\)</span> in the source signal
<span class="math notranslate nohighlight">\(N\)</span>.
For a given confidence level <span class="math notranslate nohighlight">\(CL\)</span> the confidence interval
<span class="math notranslate nohighlight">\([S_\mathrm{min}, S_\mathrm{max}]\)</span> is given by:</p>
<div class="math notranslate nohighlight">
\[CL = \int^{S_\mathrm{max}}_{S_\mathrm{min}} f_{N,B}(S)dS\]</div>
<p>where the function <span class="math notranslate nohighlight">\(f_{N,B}\)</span> is:</p>
<div class="math notranslate nohighlight">
\[f_{N,B}(S) = C \frac{e^{-(S+B)}(S+B)^N}{N!}\]</div>
<p>and the normalization constant <span class="math notranslate nohighlight">\(C\)</span>:</p>
<div class="math notranslate nohighlight">
\[C = \left[ \int_0^\infty \frac{e^{-(S+B)}(S+B)^N}{N!} dS \right] ^{-1}
= \left( \sum^N_{n=0} \frac{e^{-B}B^n}{n!}  \right)^{-1}\]</div>
<p>See <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1991ApJ...374..344K">Kraft, Burrows, and Nousek (1991)</a> for further
details.</p>
<p>These formulas implement a positive, uniform prior.
<a class="reference external" href="https://ui.adsabs.harvard.edu/abs/1991ApJ...374..344K">Kraft, Burrows, and Nousek (1991)</a> discuss this
choice in more detail and show that the problem is relatively
insensitive to the choice of prior.</p>
<p>This function has an optional dependency: Either <a class="reference external" href="https://www.scipy.org/">Scipy</a> or <a class="reference external" href="http://mpmath.org/">mpmath</a>  need
to be available (Scipy works only for N &lt; 100).
This code is very intense numerically, which makes it much slower than
the other methods, in particular for large count numbers (above 1000
even with <code class="docutils literal notranslate"><span class="pre">mpmath</span></code>). Fortunately, some of the other methods or a
Gaussian approximation usually work well in this regime.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">poisson_conf_interval</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">interval</span><span class="o">=</span><span class="s1">&#39;root-n&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="go">array([[  0.        ,   0.        ],</span>
<span class="go">       [  0.        ,   2.        ],</span>
<span class="go">       [  0.58578644,   3.41421356],</span>
<span class="go">       [  1.26794919,   4.73205081],</span>
<span class="go">       [  2.        ,   6.        ],</span>
<span class="go">       [  2.76393202,   7.23606798],</span>
<span class="go">       [  3.55051026,   8.44948974],</span>
<span class="go">       [  4.35424869,   9.64575131],</span>
<span class="go">       [  5.17157288,  10.82842712],</span>
<span class="go">       [  6.        ,  12.        ]])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">poisson_conf_interval</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">interval</span><span class="o">=</span><span class="s1">&#39;root-n-0&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="go">array([[  0.        ,   1.        ],</span>
<span class="go">       [  0.        ,   2.        ],</span>
<span class="go">       [  0.58578644,   3.41421356],</span>
<span class="go">       [  1.26794919,   4.73205081],</span>
<span class="go">       [  2.        ,   6.        ],</span>
<span class="go">       [  2.76393202,   7.23606798],</span>
<span class="go">       [  3.55051026,   8.44948974],</span>
<span class="go">       [  4.35424869,   9.64575131],</span>
<span class="go">       [  5.17157288,  10.82842712],</span>
<span class="go">       [  6.        ,  12.        ]])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">poisson_conf_interval</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">interval</span><span class="o">=</span><span class="s1">&#39;pearson&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="go">array([[  0.        ,   1.        ],</span>
<span class="go">       [  0.38196601,   2.61803399],</span>
<span class="go">       [  1.        ,   4.        ],</span>
<span class="go">       [  1.69722436,   5.30277564],</span>
<span class="go">       [  2.43844719,   6.56155281],</span>
<span class="go">       [  3.20871215,   7.79128785],</span>
<span class="go">       [  4.        ,   9.        ],</span>
<span class="go">       [  4.8074176 ,  10.1925824 ],</span>
<span class="go">       [  5.62771868,  11.37228132],</span>
<span class="go">       [  6.45861873,  12.54138127]])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">poisson_conf_interval</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">10</span><span class="p">),</span> <span class="n">interval</span><span class="o">=</span><span class="s1">&#39;frequentist-confidence&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="go">array([[  0.        ,   1.84102165],</span>
<span class="go">       [  0.17275378,   3.29952656],</span>
<span class="go">       [  0.70818544,   4.63785962],</span>
<span class="go">       [  1.36729531,   5.91818583],</span>
<span class="go">       [  2.08566081,   7.16275317],</span>
<span class="go">       [  2.84030886,   8.38247265],</span>
<span class="go">       [  3.62006862,   9.58364155],</span>
<span class="go">       [  4.41852954,  10.77028072],</span>
<span class="go">       [  5.23161394,  11.94514152],</span>
<span class="go">       [  6.05653896,  13.11020414]])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">poisson_conf_interval</span><span class="p">(</span>
<span class="gp">... </span>    <span class="mi">7</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="s1">&#39;frequentist-confidence&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>
<span class="go">array([  4.41852954,  10.77028072])</span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">poisson_conf_interval</span><span class="p">(</span>
<span class="gp">... </span>    <span class="mi">10</span><span class="p">,</span> <span class="n">background</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">confidence_level</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">interval</span><span class="o">=</span><span class="s1">&#39;kraft-burrows-nousek&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">T</span>  
<span class="go">array([[ 3.47894005, 16.113329533]])</span>
</pre></div>
</div>
</dd></dl>

</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">poisson_conf_interval</a></li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/astropy.stats.poisson_conf_interval.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011–2022, The Astropy Developers.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 3.5.4. &nbsp;
    Last built 09 May 2022. <br/>
  </p>
</footer>
  </body>
</html>