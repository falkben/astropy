


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>z_at_value &#8212; Astropy v5.2.dev94+gb1133d712.d20220509</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Cosmology" href="astropy.cosmology.Cosmology.html" />
    <link rel="prev" title="Cosmology For Developers" href="../cosmology/dev.html" />
  
  <meta name="robots" content="noindex, nofollow">
  
  
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>


  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="astropy.cosmology.Cosmology.html" title="Cosmology">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="../cosmology/dev.html" title="Cosmology For Developers">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">Astropy v5.2.dev94+gb1133d712.d20220509</a>
	 &#187;
      </li>
      <li><a href="../cosmology/index.html" accesskey="U">Cosmological Calculations (<code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.cosmology</span></code>)</a> &#187;</li>
      
      <li>z_at_value</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="z-at-value">
<h1>z_at_value<a class="headerlink" href="#z-at-value" title="Permalink to this headline">¶</a></h1>
<dl class="py function">
<dt id="astropy.cosmology.z_at_value">
<code class="sig-prename descclassname"><span class="pre">astropy.cosmology.</span></code><code class="sig-name descname"><span class="pre">z_at_value</span></code><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zmin</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">zmax</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ztol</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-08</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">maxfun</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">500</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'Brent'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bracket</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/astropy/cosmology/funcs.html#z_at_value"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#astropy.cosmology.z_at_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Find the redshift <code class="docutils literal notranslate"><span class="pre">z</span></code> at which <code class="docutils literal notranslate"><span class="pre">func(z)</span> <span class="pre">=</span> <span class="pre">fval</span></code>.</p>
<p>This finds the redshift at which one of the cosmology functions or
methods (for example Planck13.distmod) is equal to a known value.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Make sure you understand the behavior of the function that you are
trying to invert! Depending on the cosmology, there may not be a
unique solution. For example, in the standard Lambda CDM cosmology,
there are two redshifts which give an angular diameter distance of
1500 Mpc, z ~ 0.7 and z ~ 3.8. To force <code class="docutils literal notranslate"><span class="pre">z_at_value</span></code> to find the
solution you are interested in, use the <code class="docutils literal notranslate"><span class="pre">zmin</span></code> and <code class="docutils literal notranslate"><span class="pre">zmax</span></code> keywords
to limit the search range (see the example below).</p>
</div>
<dl class="field-list">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><dl>
<dt><strong>func</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/glossary.html#term-function" title="(in Python v3.10)"><span>function</span></a> or method</span></dt><dd><p>A function that takes a redshift as input.</p>
</dd>
<dt><strong>fval</strong><span class="classifier"><a class="reference internal" href="astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Quantity</span></code></a></span></dt><dd><p>The (scalar or array) value of <code class="docutils literal notranslate"><span class="pre">func(z)</span></code> to recover.</p>
</dd>
<dt><strong>zmin</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">float</span></code></a> or <a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-array_like" title="(in NumPy v1.22)"><span>array_like</span></a>[<a class="reference internal" href="../units/index.html#dimensionless"><span class="std std-ref">:ref: ‘dimensionless’</span></a>] or <a class="reference internal" href="../glossary.html#term-quantity-like"><span class="xref std std-term">astropy:quantity-like</span></a>, optional</span></dt><dd><p>The lower search limit for <code class="docutils literal notranslate"><span class="pre">z</span></code>.  Beware of divergences
in some cosmological functions, such as distance moduli,
at z=0 (default 1e-8).</p>
</dd>
<dt><strong>zmax</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">float</span></code></a> or <a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-array_like" title="(in NumPy v1.22)"><span>array_like</span></a>[<a class="reference internal" href="../units/index.html#dimensionless"><span class="std std-ref">:ref: ‘dimensionless’</span></a>] or <a class="reference internal" href="../glossary.html#term-quantity-like"><span class="xref std std-term">astropy:quantity-like</span></a>, optional</span></dt><dd><p>The upper search limit for <code class="docutils literal notranslate"><span class="pre">z</span></code> (default 1000).</p>
</dd>
<dt><strong>ztol</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">float</span></code></a> or <a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-array_like" title="(in NumPy v1.22)"><span>array_like</span></a>[<a class="reference internal" href="../units/index.html#dimensionless"><span class="std std-ref">:ref: ‘dimensionless’</span></a>], optional</span></dt><dd><p>The relative error in <code class="docutils literal notranslate"><span class="pre">z</span></code> acceptable for convergence.</p>
</dd>
<dt><strong>maxfun</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/functions.html#int" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">int</span></code></a> or <a class="reference external" href="https://numpy.org/doc/stable/glossary.html#term-array_like" title="(in NumPy v1.22)"><span>array_like</span></a>, optional</span></dt><dd><p>The maximum number of function evaluations allowed in the
optimization routine (default 500).</p>
</dd>
<dt><strong>method</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#str" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">str</span></code></a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#callable" title="(in Python v3.10)"><code class="docutils literal notranslate"><span class="pre">callable()</span></code></a>, optional</span></dt><dd><p>Type of solver to pass to the minimizer. The built-in options provided
by <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize_scalar.html#scipy.optimize.minimize_scalar" title="(in SciPy v1.8.0)"><code class="xref py py-func docutils literal notranslate"><span class="pre">minimize_scalar()</span></code></a> are ‘Brent’ (default),
‘Golden’ and ‘Bounded’ with names case insensitive - see documentation
there for details. It also accepts a custom solver by passing any
user-provided callable object that meets the requirements listed
therein under the Notes on “Custom minimizers” - or in more detail in
<a class="reference external" href="https://docs.scipy.org/doc/scipy/tutorial/optimize.html" title="(in SciPy v1.8.0)"><span>Optimization (scipy.optimize)</span></a> - although their use is currently
untested.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 4.3.</span></p>
</div>
</dd>
<dt><strong>bracket</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/glossary.html#term-sequence" title="(in Python v3.10)"><span>sequence</span></a> or <a class="reference external" href="https://docs.python.org/3/library/functions.html#object" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">object</span></code></a> <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a>[<a class="reference external" href="https://docs.python.org/3/glossary.html#term-sequence" title="(in Python v3.10)"><span>sequence</span></a>], optional</span></dt><dd><p>For methods ‘Brent’ and ‘Golden’, <code class="docutils literal notranslate"><span class="pre">bracket</span></code> defines the bracketing
interval and can either have three items (z1, z2, z3) so that
z1 &lt; z2 &lt; z3 and <code class="docutils literal notranslate"><span class="pre">func(z2)</span> <span class="pre">&lt;</span> <span class="pre">func</span> <span class="pre">(z1),</span> <span class="pre">func(z3)</span></code> or two items z1
and z3 which are assumed to be a starting interval for a downhill
bracket search. For non-monotonic functions such as angular diameter
distance this may be used to start the search on the desired side of
the maximum, but see Examples below for usage notes.</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 4.3.</span></p>
</div>
</dd>
<dt><strong>verbose</strong><span class="classifier"><a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#bltin-boolean-values" title="(in Python v3.10)"><span class="xref std std-ref">bool</span></a>, optional</span></dt><dd><p>Print diagnostic output from solver (default <a class="reference external" href="https://docs.python.org/3/library/constants.html#False" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">False</span></code></a>).</p>
<div class="versionadded">
<p><span class="versionmodified added">New in version 4.3.</span></p>
</div>
</dd>
</dl>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><dl>
<dt><strong>z</strong><span class="classifier"><a class="reference internal" href="astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Quantity</span></code></a> [‘redshift’]</span></dt><dd><p>The redshift <code class="docutils literal notranslate"><span class="pre">z</span></code> satisfying <code class="docutils literal notranslate"><span class="pre">zmin</span> <span class="pre">&lt;</span> <span class="pre">z</span> <span class="pre">&lt;</span> <span class="pre">zmax</span></code> and <code class="docutils literal notranslate"><span class="pre">func(z)</span> <span class="pre">=</span>
<span class="pre">fval</span></code> within <code class="docutils literal notranslate"><span class="pre">ztol</span></code>. Has units of cosmological redshift.</p>
</dd>
</dl>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><dl class="simple">
<dt><a class="reference internal" href="astropy.cosmology.CosmologyError.html#astropy.cosmology.CosmologyError" title="astropy.cosmology.CosmologyError"><code class="xref py py-class docutils literal notranslate"><span class="pre">astropy.cosmology.CosmologyError</span></code></a></dt><dd><p>If the result is very close to either <code class="docutils literal notranslate"><span class="pre">zmin</span></code> or <code class="docutils literal notranslate"><span class="pre">zmax</span></code>.</p>
</dd>
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#ValueError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ValueError</span></code></a></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">bracket</span></code> is not an array nor a 2 (or 3) element sequence.</p>
</dd>
<dt><a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TypeError</span></code></a></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">bracket</span></code> is not an object array. 2 (or 3) element sequences will
be turned into object arrays, so this error should only occur if a
non-object array is used for <code class="docutils literal notranslate"><span class="pre">bracket</span></code>.</p>
</dd>
</dl>
</dd>
<dt class="field-even">Warns</dt>
<dd class="field-even"><dl>
<dt><a class="reference internal" href="astropy.utils.exceptions.AstropyUserWarning.html#astropy.utils.exceptions.AstropyUserWarning" title="astropy.utils.exceptions.AstropyUserWarning"><code class="xref py py-class docutils literal notranslate"><span class="pre">AstropyUserWarning</span></code></a></dt><dd><p>If <code class="docutils literal notranslate"><span class="pre">fval</span></code> is not bracketed by <code class="docutils literal notranslate"><span class="pre">func(zmin)=fval(zmin)</span></code> and
<code class="docutils literal notranslate"><span class="pre">func(zmax)=fval(zmax)</span></code>.</p>
<p>If the solver was not successful.</p>
</dd>
</dl>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This works for any arbitrary input cosmology, but is inefficient if you
want to invert a large number of values for the same cosmology. In this
case, it is faster to instead generate an array of values at many
closely-spaced redshifts that cover the relevant redshift range, and then
use interpolation to find the redshift at each value you are interested
in. For example, to efficiently find the redshifts corresponding to 10^6
values of the distance modulus in a Planck13 cosmology, you could do the
following:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.cosmology</span> <span class="kn">import</span> <span class="n">Planck13</span><span class="p">,</span> <span class="n">z_at_value</span>
</pre></div>
</div>
<p>Generate 10^6 distance moduli between 24 and 44 for which we
want to find the corresponding redshifts:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">Dvals</span> <span class="o">=</span> <span class="p">(</span><span class="mi">24</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000000</span><span class="p">)</span> <span class="o">*</span> <span class="mi">20</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">mag</span>
</pre></div>
</div>
<p>Make a grid of distance moduli covering the redshift range we
need using 50 equally log-spaced values between zmin and
zmax. We use log spacing to adequately sample the steep part of
the curve at low distance moduli:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">zmin</span> <span class="o">=</span> <span class="n">z_at_value</span><span class="p">(</span><span class="n">Planck13</span><span class="o">.</span><span class="n">distmod</span><span class="p">,</span> <span class="n">Dvals</span><span class="o">.</span><span class="n">min</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zmax</span> <span class="o">=</span> <span class="n">z_at_value</span><span class="p">(</span><span class="n">Planck13</span><span class="o">.</span><span class="n">distmod</span><span class="p">,</span> <span class="n">Dvals</span><span class="o">.</span><span class="n">max</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">zgrid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">geomspace</span><span class="p">(</span><span class="n">zmin</span><span class="p">,</span> <span class="n">zmax</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">Dgrid</span> <span class="o">=</span> <span class="n">Planck13</span><span class="o">.</span><span class="n">distmod</span><span class="p">(</span><span class="n">zgrid</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally interpolate to find the redshift at each distance modulus:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">zvals</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">interp</span><span class="p">(</span><span class="n">Dvals</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">Dgrid</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">zgrid</span><span class="p">)</span>
</pre></div>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.cosmology</span> <span class="kn">import</span> <span class="n">Planck13</span><span class="p">,</span> <span class="n">Planck18</span><span class="p">,</span> <span class="n">z_at_value</span>
</pre></div>
</div>
<p>The age and lookback time are monotonic with redshift, and so a
unique solution can be found:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">z_at_value</span><span class="p">(</span><span class="n">Planck13</span><span class="o">.</span><span class="n">age</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Gyr</span><span class="p">)</span>               
<span class="go">&lt;Quantity 3.19812268 redshift&gt;</span>
</pre></div>
</div>
<p>The angular diameter is not monotonic however, and there are two
redshifts that give a value of 1500 Mpc. You can use the zmin and
zmax keywords to find the one you are interested in:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">z_at_value</span><span class="p">(</span><span class="n">Planck18</span><span class="o">.</span><span class="n">angular_diameter_distance</span><span class="p">,</span>
<span class="gp">... </span>           <span class="mi">1500</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Mpc</span><span class="p">,</span> <span class="n">zmax</span><span class="o">=</span><span class="mf">1.5</span><span class="p">)</span>                
<span class="go">&lt;Quantity 0.68044452 redshift&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z_at_value</span><span class="p">(</span><span class="n">Planck18</span><span class="o">.</span><span class="n">angular_diameter_distance</span><span class="p">,</span>
<span class="gp">... </span>           <span class="mi">1500</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Mpc</span><span class="p">,</span> <span class="n">zmin</span><span class="o">=</span><span class="mf">2.5</span><span class="p">)</span>                
<span class="go">&lt;Quantity 3.7823268 redshift&gt;</span>
</pre></div>
</div>
<p>Alternatively the <code class="docutils literal notranslate"><span class="pre">bracket</span></code> option may be used to initialize the
function solver on a desired region, but one should be aware that this
does not guarantee it will remain close to this starting bracket.
For the example of angular diameter distance, which has a maximum near
a redshift of 1.6 in this cosmology, defining a bracket on either side
of this maximum will often return a solution on the same side:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">z_at_value</span><span class="p">(</span><span class="n">Planck18</span><span class="o">.</span><span class="n">angular_diameter_distance</span><span class="p">,</span>
<span class="gp">... </span>           <span class="mi">1500</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Mpc</span><span class="p">,</span> <span class="n">bracket</span><span class="o">=</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">))</span>  
<span class="go">&lt;Quantity 0.68044452 redshift&gt;</span>
</pre></div>
</div>
<p>But this is not ascertained especially if the bracket is chosen too wide
and/or too close to the turning point:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">z_at_value</span><span class="p">(</span><span class="n">Planck18</span><span class="o">.</span><span class="n">angular_diameter_distance</span><span class="p">,</span>
<span class="gp">... </span>           <span class="mi">1500</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Mpc</span><span class="p">,</span> <span class="n">bracket</span><span class="o">=</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">))</span>           
<span class="go">&lt;Quantity 3.7823268 redshift&gt;                              </span>
</pre></div>
</div>
<p>Likewise, even for the same minimizer and same starting conditions different
results can be found depending on architecture or library versions:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">z_at_value</span><span class="p">(</span><span class="n">Planck18</span><span class="o">.</span><span class="n">angular_diameter_distance</span><span class="p">,</span>
<span class="gp">... </span>           <span class="mi">1500</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Mpc</span><span class="p">,</span> <span class="n">bracket</span><span class="o">=</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">))</span>           
<span class="go">&lt;Quantity 3.7823268 redshift&gt;                              </span>
</pre></div>
</div>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">z_at_value</span><span class="p">(</span><span class="n">Planck18</span><span class="o">.</span><span class="n">angular_diameter_distance</span><span class="p">,</span>
<span class="gp">... </span>           <span class="mi">1500</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Mpc</span><span class="p">,</span> <span class="n">bracket</span><span class="o">=</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">))</span>           
<span class="go">&lt;Quantity 0.68044452 redshift&gt;                             </span>
</pre></div>
</div>
<p>It is therefore generally safer to use the 3-parameter variant to ensure
the solution stays within the bracketing limits:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">z_at_value</span><span class="p">(</span><span class="n">Planck18</span><span class="o">.</span><span class="n">angular_diameter_distance</span><span class="p">,</span> <span class="mi">1500</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Mpc</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">bracket</span><span class="o">=</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">))</span>               
<span class="go">&lt;Quantity 0.68044452 redshift&gt;</span>
</pre></div>
</div>
<p>Also note that the luminosity distance and distance modulus (two
other commonly inverted quantities) are monotonic in flat and open
universes, but not in closed universes.</p>
<p>All the arguments except <code class="docutils literal notranslate"><span class="pre">func</span></code>, <code class="docutils literal notranslate"><span class="pre">method</span></code> and <code class="docutils literal notranslate"><span class="pre">verbose</span></code> accept array
inputs. This does NOT use interpolation tables or any method to speed up
evaluations, rather providing a convenient means to broadcast arguments
over an element-wise scalar evaluation.</p>
<p>The most common use case for non-scalar input is to evaluate ‘func’ for an
array of <code class="docutils literal notranslate"><span class="pre">fval</span></code>:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">z_at_value</span><span class="p">(</span><span class="n">Planck13</span><span class="o">.</span><span class="n">age</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Gyr</span><span class="p">)</span>          
<span class="go">&lt;Quantity [3.19812061, 0.75620443] redshift&gt;</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">fval</span></code> can be any shape:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">z_at_value</span><span class="p">(</span><span class="n">Planck13</span><span class="o">.</span><span class="n">age</span><span class="p">,</span> <span class="p">[[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">7</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">]]</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">Gyr</span><span class="p">)</span>  
<span class="go">&lt;Quantity [[3.19812061, 0.75620443],</span>
<span class="go">           [5.67661227, 2.19131955]] redshift&gt;</span>
</pre></div>
</div>
<p>Other arguments can be arrays. For non-monotic functions  – for example,
the angular diameter distance – this can be useful to find all solutions.</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">z_at_value</span><span class="p">(</span><span class="n">Planck13</span><span class="o">.</span><span class="n">angular_diameter_distance</span><span class="p">,</span> <span class="mi">1500</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Mpc</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">zmin</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">],</span> <span class="n">zmax</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>            
<span class="go">&lt;Quantity [0.68127747, 3.79149062] redshift&gt;</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">bracket</span></code> argument can likewise be be an array. However, since
bracket must already be a sequence (or None), it MUST be given as an
object <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.ndarray</span></code></a>. Importantly, the depth of the array must be such
that each bracket subsequence is an object. Errors or unexpected results
will happen otherwise. A convenient means to ensure the right depth is by
including a length-0 tuple as a bracket and then truncating the object
array to remove the placeholder. This can be seen in the following
example:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">bracket</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">),(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">2.5</span><span class="p">),</span> <span class="p">()],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">object</span><span class="p">)[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">z_at_value</span><span class="p">(</span><span class="n">Planck18</span><span class="o">.</span><span class="n">angular_diameter_distance</span><span class="p">,</span> <span class="mi">1500</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Mpc</span><span class="p">,</span>
<span class="gp">... </span>           <span class="n">bracket</span><span class="o">=</span><span class="n">bracket</span><span class="p">)</span>  
<span class="go">&lt;Quantity [0.68044452, 3.7823268] redshift&gt;</span>
</pre></div>
</div>
</dd></dl>

</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">z_at_value</a></li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/api/astropy.cosmology.z_at_value.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011–2022, The Astropy Developers.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 3.5.4. &nbsp;
    Last built 09 May 2022. <br/>
  </p>
</footer>
  </body>
</html>