


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Reading and Writing Time Series &#8212; Astropy v5.2.dev96+g04a0cf8bb</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Accessing Data in Time Series" href="data_access.html" />
    <link rel="prev" title="Creating Time Series" href="initializing.html" />
  
  <meta name="robots" content="noindex, nofollow">
  
  
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>


  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="data_access.html" title="Accessing Data in Time Series">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="initializing.html" title="Creating Time Series">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">Astropy v5.2.dev96+g04a0cf8bb</a>
	 &#187;
      </li>
      <li><a href="index.html" accesskey="U">Time Series (<code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.timeseries</span></code>)</a> &#187;</li>
      
      <li>Reading and Writing Time Series</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="reading-and-writing-time-series">
<span id="timeseries-io"></span><h1>Reading and Writing Time Series<a class="headerlink" href="#reading-and-writing-time-series" title="Permalink to this headline">¶</a></h1>
<div class="section" id="built-in-readers">
<h2>Built-in Readers<a class="headerlink" href="#built-in-readers" title="Permalink to this headline">¶</a></h2>
<p>Since <a class="reference internal" href="../api/astropy.timeseries.TimeSeries.html#astropy.timeseries.TimeSeries" title="astropy.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a> and <a class="reference internal" href="../api/astropy.timeseries.BinnedTimeSeries.html#astropy.timeseries.BinnedTimeSeries" title="astropy.timeseries.BinnedTimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">BinnedTimeSeries</span></code></a> are subclasses of <a class="reference internal" href="../api/astropy.table.Table.html#astropy.table.Table" title="astropy.table.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a>, they have
<a class="reference internal" href="../api/astropy.table.Table.html#astropy.table.Table.read" title="astropy.table.Table.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">read()</span></code></a> and <a class="reference internal" href="../api/astropy.table.Table.html#astropy.table.Table.write" title="astropy.table.Table.write"><code class="xref py py-meth docutils literal notranslate"><span class="pre">write()</span></code></a> methods
that can be used to read and write time series from files. We include a few readers for
well-defined formats in <a class="reference internal" href="index.html#module-astropy.timeseries" title="astropy.timeseries"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.timeseries</span></code></a>. For instance we have readers for
light curves in FITS format from the <a class="reference external" href="https://www.nasa.gov/mission_pages/kepler/main/index.html">Kepler</a> and <a class="reference external" href="https://tess.gsfc.nasa.gov/">TESS</a> missions.</p>
<div class="section" id="example">
<h3>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h3>
<p>In this demonstration of using Kepler FITS time series, we start off by fetching
an example file:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">astropy.utils.data</span> <span class="kn">import</span> <span class="n">get_pkg_data_filename</span>
<span class="n">example_data</span> <span class="o">=</span> <span class="n">get_pkg_data_filename</span><span class="p">(</span><span class="s1">&#39;timeseries/kplr010666592-2009131110544_slc.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The light curve provided here is handpicked for example purposes. To get
other Kepler light curves for science purposes using Python, see the
<a class="reference external" href="https://astroquery.readthedocs.io">astroquery</a> affiliated package.</p>
</div>
<p>This will set <code class="docutils literal notranslate"><span class="pre">example_data</span></code> to the filename of the downloaded file (so you
can replace this by the filename for the file you want to read in). We can then
read in the time series using:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">astropy.timeseries</span> <span class="kn">import</span> <span class="n">TimeSeries</span>
<span class="n">kepler</span> <span class="o">=</span> <span class="n">TimeSeries</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">example_data</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;kepler.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Now we can check that the time series has been read in correctly:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">kepler</span><span class="o">.</span><span class="n">time</span><span class="o">.</span><span class="n">jd</span><span class="p">,</span> <span class="n">kepler</span><span class="p">[</span><span class="s1">&#39;sap_flux&#39;</span><span class="p">],</span> <span class="s1">&#39;k.&#39;</span><span class="p">,</span> <span class="n">markersize</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;Julian Date&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;SAP Flux (e-/s)&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../timeseries/io-3.png">png</a>, <a class="reference external" href="../timeseries/io-3.svg">svg</a>, <a class="reference external" href="../timeseries/io-3.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="../_images/io-3.png" class="plot-directive" src="../_images/io-3.png" />
</div>
</div>
</div>
<div class="section" id="reading-common-light-curve-formats">
<h2>Reading Common Light Curve Formats<a class="headerlink" href="#reading-common-light-curve-formats" title="Permalink to this headline">¶</a></h2>
<p>At the moment only a few formats are defined in <code class="docutils literal notranslate"><span class="pre">astropy</span></code> itself, in part
because there are not many well-documented formats for storing time series. So
in many cases, you will likely have to first read in your files using the more
generic <a class="reference internal" href="../api/astropy.table.Table.html#astropy.table.Table" title="astropy.table.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> class (see <a class="reference internal" href="../table/io.html#read-write-tables"><span class="std std-ref">Reading and Writing Table Objects</span></a>). In fact, the
<a class="reference internal" href="../api/astropy.timeseries.TimeSeries.html#astropy.timeseries.TimeSeries.read" title="astropy.timeseries.TimeSeries.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TimeSeries.read</span></code></a> and
<a class="reference internal" href="../api/astropy.timeseries.BinnedTimeSeries.html#astropy.timeseries.BinnedTimeSeries.read" title="astropy.timeseries.BinnedTimeSeries.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BinnedTimeSeries.read</span></code></a> methods
can do this behind the scenes. If the table cannot be read by any of the time
series readers, these methods will try to use some of the default
<a class="reference internal" href="../api/astropy.table.Table.html#astropy.table.Table" title="astropy.table.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> readers and then require users to specify the
names of the important columns.</p>
<div class="section" id="examples">
<h3>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h3>
<p>If you are reading in a file called <a class="reference download internal" download="" href="../_downloads/90a075a8fb1247a21b55c25b9ed840e1/sampled.csv"><code class="xref download docutils literal notranslate"><span class="pre">sampled.csv</span></code></a> where
the time column is called <code class="docutils literal notranslate"><span class="pre">Date</span></code> and is an ISO string, you can do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.timeseries</span> <span class="kn">import</span> <span class="n">TimeSeries</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.utils.data</span> <span class="kn">import</span> <span class="n">get_pkg_data_filename</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sampled_filename</span> <span class="o">=</span> <span class="n">get_pkg_data_filename</span><span class="p">(</span><span class="s1">&#39;data/sampled.csv&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                         <span class="n">package</span><span class="o">=</span><span class="s1">&#39;astropy.timeseries.tests&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ts</span> <span class="o">=</span> <span class="n">TimeSeries</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">sampled_filename</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;ascii.csv&#39;</span><span class="p">,</span>
<span class="gp">... </span>                     <span class="n">time_column</span><span class="o">=</span><span class="s1">&#39;Date&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ts</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
<span class="go">&lt;TimeSeries length=3&gt;</span>
<span class="go">          time             A       B       C       D       E       F       G</span>
<span class="go">          Time          float64 float64 float64 float64 float64 float64 float64</span>
<span class="go">----------------------- ------- ------- ------- ------- ------- ------- -------</span>
<span class="go">2008-03-18 00:00:00.000   24.68  164.93  114.73   26.27   19.21   28.87   63.44</span>
<span class="go">2008-03-19 00:00:00.000   24.18  164.89  114.75   26.22   19.07   27.76   59.98</span>
<span class="go">2008-03-20 00:00:00.000   23.99  164.63  115.04   25.78   19.01   27.04   59.61</span>
</pre></div>
</div>
<p>If you are reading in a binned time series from a file called
<a class="reference download internal" download="" href="../_downloads/acf324208aaf6ab6a84c903ad3ae19d2/binned.csv"><code class="xref download docutils literal notranslate"><span class="pre">binned.csv</span></code></a> and with a column <code class="docutils literal notranslate"><span class="pre">time_start</span></code> giving the
start time and <code class="docutils literal notranslate"><span class="pre">bin_size</span></code> giving the size of each bin, you can do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.timeseries</span> <span class="kn">import</span> <span class="n">BinnedTimeSeries</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">binned_filename</span> <span class="o">=</span> <span class="n">get_pkg_data_filename</span><span class="p">(</span><span class="s1">&#39;data/binned.csv&#39;</span><span class="p">,</span>
<span class="gp">... </span>                                         <span class="n">package</span><span class="o">=</span><span class="s1">&#39;astropy.timeseries.tests&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ts</span> <span class="o">=</span> <span class="n">BinnedTimeSeries</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="n">binned_filename</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;ascii.csv&#39;</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">time_bin_start_column</span><span class="o">=</span><span class="s1">&#39;time_start&#39;</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">time_bin_size_column</span><span class="o">=</span><span class="s1">&#39;bin_size&#39;</span><span class="p">,</span>
<span class="gp">... </span>                           <span class="n">time_bin_size_unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ts</span><span class="p">[:</span><span class="mi">3</span><span class="p">]</span>
<span class="go">&lt;BinnedTimeSeries length=3&gt;</span>
<span class="go">     time_bin_start     time_bin_size ...    E       F</span>
<span class="go">                              s       ...</span>
<span class="go">          Time             float64    ... float64 float64</span>
<span class="go">----------------------- ------------- ... ------- -------</span>
<span class="go">2016-03-22T12:30:31.000           3.0 ...   28.87   63.44</span>
<span class="go">2016-03-22T12:30:34.000           3.0 ...   27.76   59.98</span>
<span class="go">2016-03-22T12:30:37.000           3.0 ...   27.04   59.61</span>
</pre></div>
</div>
<p>See the documentation for <a class="reference internal" href="../api/astropy.timeseries.TimeSeries.html#astropy.timeseries.TimeSeries.read" title="astropy.timeseries.TimeSeries.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TimeSeries.read</span></code></a> and <a class="reference internal" href="../api/astropy.timeseries.BinnedTimeSeries.html#astropy.timeseries.BinnedTimeSeries.read" title="astropy.timeseries.BinnedTimeSeries.read"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BinnedTimeSeries.read</span></code></a> for more details.</p>
<p>Alternatively, you can read in the table using your own code then construct the
<a class="reference internal" href="../api/astropy.timeseries.TimeSeries.html#astropy.timeseries.TimeSeries" title="astropy.timeseries.TimeSeries"><code class="xref py py-class docutils literal notranslate"><span class="pre">TimeSeries</span></code></a> object as described in <a class="reference internal" href="initializing.html#timeseries-initializing"><span class="std std-ref">Creating Time Series</span></a>, although
then you cannot write out another time series in the same format.</p>
<p>If you have written a reader/writer for a commonly used format, please feel free
to contribute it to <code class="docutils literal notranslate"><span class="pre">astropy</span></code>!</p>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Reading and Writing Time Series</a><ul>
<li><a class="reference internal" href="#built-in-readers">Built-in Readers</a><ul>
<li><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
<li><a class="reference internal" href="#reading-common-light-curve-formats">Reading Common Light Curve Formats</a><ul>
<li><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/timeseries/io.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011–2022, The Astropy Developers.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 3.5.4. &nbsp;
    Last built 09 May 2022. <br/>
  </p>
</footer>
  </body>
</html>