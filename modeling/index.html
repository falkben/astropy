


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Models and Fitting (astropy.modeling) &#8212; Astropy v5.2.dev96+g04a0cf8bb</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Models" href="models.html" />
    <link rel="prev" title="SlicedLowLevelWCS" href="../api/astropy.wcs.wcsapi.SlicedLowLevelWCS.html" />
  
  <meta name="robots" content="noindex, nofollow">
  
  
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>


  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="models.html" title="Models">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="../api/astropy.wcs.wcsapi.SlicedLowLevelWCS.html" title="SlicedLowLevelWCS">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">Astropy v5.2.dev96+g04a0cf8bb</a>
	 &#187;
      </li>
      
      <li>Models and Fitting (<code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.modeling</span></code>)</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="models-and-fitting-astropy-modeling">
<span id="astropy-modeling"></span><h1>Models and Fitting (<a class="reference internal" href="reference_api.html#module-astropy.modeling" title="astropy.modeling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.modeling</span></code></a>)<a class="headerlink" href="#models-and-fitting-astropy-modeling" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="reference_api.html#module-astropy.modeling" title="astropy.modeling"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.modeling</span></code></a> provides a framework for representing models and performing
model evaluation and fitting.  A number of predefined 1-D and 2-D models are
provided and the capability for custom, user defined models is supported.
Different fitting algorithms can be used with any model.  For those fitters
with the capabilities fitting can be done using uncertainties, parameters with
bounds, and priors.</p>
</div>
<div class="section" id="using-modeling">
<span id="modeling-using"></span><h2>Using Modeling<a class="headerlink" href="#using-modeling" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="models.html">Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="models.html#basics">Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="models.html#model-sets">Model Sets</a></li>
<li class="toctree-l2"><a class="reference internal" href="models.html#model-serialization-writing-a-model-to-a-file">Model Serialization (Writing a Model to a File)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="compound-models.html">Compound Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="compound-models.html#basics">Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="compound-models.html#a-comprehensive-description">A comprehensive description</a></li>
<li class="toctree-l2"><a class="reference internal" href="compound-models.html#other-topics">Other Topics</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="parameters.html">Model Parameters</a><ul>
<li class="toctree-l2"><a class="reference internal" href="parameters.html#basics">Basics</a></li>
<li class="toctree-l2"><a class="reference internal" href="parameters.html#parameter-constraints">Parameter constraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="parameters.html#parameter-examples">Parameter examples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="fitting.html">Fitting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="fitting.html#notes-on-non-linear-fitting">Notes on non-linear fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="fitting.html#simple-1-d-model-fitting">Simple 1-D model fitting</a></li>
<li class="toctree-l2"><a class="reference internal" href="fitting.html#simple-2-d-model-fitting">Simple 2-D model fitting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="units.html">Using Units with Models and Fitting</a><ul>
<li class="toctree-l2"><a class="reference internal" href="units.html#setting-parameters-to-quantities">Setting parameters to quantities</a></li>
<li class="toctree-l2"><a class="reference internal" href="units.html#evaluating-models-with-quantities">Evaluating models with quantities</a></li>
<li class="toctree-l2"><a class="reference internal" href="units.html#fitting-models-with-units-to-data">Fitting models with units to data</a></li>
<li class="toctree-l2"><a class="reference internal" href="units.html#support-for-units-in-otherwise-unitless-models">Support for units in otherwise unitless models</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="a-simple-example">
<span id="getting-started-example"></span><h2>A Simple Example<a class="headerlink" href="#a-simple-example" title="Permalink to this headline">¶</a></h2>
<p>This simple example illustrates defining a model,
calculating values based on input x values, and using fitting data with a model.</p>
<blockquote>
<div><div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">astropy.modeling</span> <span class="kn">import</span> <span class="n">models</span><span class="p">,</span> <span class="n">fitting</span>

<span class="c1"># define a model for a line</span>
<span class="n">line_orig</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Linear1D</span><span class="p">(</span><span class="n">slope</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">intercept</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="c1"># generate x, y data non-uniformly spaced in x</span>
<span class="c1"># add noise to y measurements</span>
<span class="n">npts</span> <span class="o">=</span> <span class="mi">30</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">,</span> <span class="n">npts</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">line_orig</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="n">y</span> <span class="o">+=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">,</span> <span class="n">npts</span><span class="p">)</span>

<span class="c1"># initialize a linear fitter</span>
<span class="n">fit</span> <span class="o">=</span> <span class="n">fitting</span><span class="o">.</span><span class="n">LinearLSQFitter</span><span class="p">()</span>

<span class="c1"># initialize a linear model</span>
<span class="n">line_init</span> <span class="o">=</span> <span class="n">models</span><span class="o">.</span><span class="n">Linear1D</span><span class="p">()</span>

<span class="c1"># fit the data with the fitter</span>
<span class="n">fitted_line</span> <span class="o">=</span> <span class="n">fit</span><span class="p">(</span><span class="n">line_init</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="c1"># plot the model</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;ko&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Data&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">fitted_line</span><span class="p">(</span><span class="n">x</span><span class="p">),</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Fitted Model&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="s1">&#39;x&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s1">&#39;y&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../modeling/index-1.png">png</a>, <a class="reference external" href="../modeling/index-1.svg">svg</a>, <a class="reference external" href="../modeling/index-1.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="../_images/index-11.png" class="plot-directive" src="../_images/index-11.png" />
</div>
</div></blockquote>
</div>
<div class="section" id="advanced-topics">
<span id="id1"></span><h2>Advanced Topics<a class="headerlink" href="#advanced-topics" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="performance.html">Performance Tips</a></li>
<li class="toctree-l1"><a class="reference internal" href="new-model.html">Extending Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="new-model.html#basic-custom-models">Basic custom models</a></li>
<li class="toctree-l2"><a class="reference internal" href="new-model.html#a-step-by-step-definition-of-a-1-d-gaussian-model">A step by step definition of a 1-D Gaussian model</a></li>
<li class="toctree-l2"><a class="reference internal" href="new-model.html#a-full-example-of-a-linemodel">A full example of a LineModel</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="new-fitter.html">Extending Fitters</a><ul>
<li class="toctree-l2"><a class="reference internal" href="new-fitter.html#defining-a-plugin-fitter">Defining a Plugin Fitter</a></li>
<li class="toctree-l2"><a class="reference internal" href="new-fitter.html#using-a-custom-statistic-function">Using a Custom Statistic Function</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="add-units.html">Adding support for units to models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="add-units.html#evaluation">Evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="add-units.html#fitting">Fitting</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="jointfitter.html">JointFitter</a></li>
<li class="toctree-l1"><a class="reference internal" href="jointfitter.html#example-spectral-line">Example: Spectral Line</a></li>
</ul>
</div>
</div>
<div class="section" id="pre-defined-models">
<h2>Pre-Defined Models<a class="headerlink" href="#pre-defined-models" title="Permalink to this headline">¶</a></h2>
<p>Some of the pre-defined models are listed and illustrated.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="predef_models1D.html">1D Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="predef_models1D.html#operations">Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="predef_models1D.html#shapes">Shapes</a></li>
<li class="toctree-l2"><a class="reference internal" href="predef_models1D.html#profiles">Profiles</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="predef_models2D.html">2D Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="predef_models2D.html#operations">Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="predef_models2D.html#shapes">Shapes</a></li>
<li class="toctree-l2"><a class="reference internal" href="predef_models2D.html#profiles">Profiles</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="physical_models.html">Physical Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="physical_models.html#blackbody">BlackBody</a></li>
<li class="toctree-l2"><a class="reference internal" href="physical_models.html#drude1d">Drude1D</a></li>
<li class="toctree-l2"><a class="reference internal" href="physical_models.html#nfw">NFW</a></li>
<li class="toctree-l2"><a class="reference internal" href="physical_models.html#cosmologies">Cosmologies</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="polynomial_models.html">Polynomial Models</a><ul>
<li class="toctree-l2"><a class="reference internal" href="polynomial_models.html#notes-regarding-usage-of-domain-and-window">Notes regarding usage of domain and window</a></li>
<li class="toctree-l2"><a class="reference internal" href="polynomial_models.html#d-polynomials">1D Polynomials</a></li>
<li class="toctree-l2"><a class="reference internal" href="polynomial_models.html#id2">2D Polynomials</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="powerlaw_models.html">Powerlaw Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="spline_models.html">Spline Models</a></li>
</ul>
</div>
</div>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="example-fitting-line.html">Fitting a line</a><ul>
<li class="toctree-l2"><a class="reference internal" href="example-fitting-line.html#simple-fit">Simple Fit</a></li>
<li class="toctree-l2"><a class="reference internal" href="example-fitting-line.html#fit-using-uncertainties">Fit using uncertainties</a></li>
<li class="toctree-l2"><a class="reference internal" href="example-fitting-line.html#iterative-fitting-using-sigma-clipping">Iterative fitting using sigma clipping</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="example-fitting-constraints.html">Fitting with constraints</a><ul>
<li class="toctree-l2"><a class="reference internal" href="example-fitting-constraints.html#fixed-parameter-constraint">Fixed Parameter Constraint</a></li>
<li class="toctree-l2"><a class="reference internal" href="example-fitting-constraints.html#bounded-constraints">Bounded Constraints</a></li>
<li class="toctree-l2"><a class="reference internal" href="example-fitting-constraints.html#tied-constraints">Tied Constraints</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="example-fitting-model-sets.html">Fitting Model Sets</a></li>
</ul>
</div>
</div>
<div class="section" id="reference-api">
<h2>Reference/API<a class="headerlink" href="#reference-api" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="reference_api.html">Reference/API</a></li>
</ul>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Models and Fitting (<code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.modeling</span></code>)</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#using-modeling">Using Modeling</a></li>
<li><a class="reference internal" href="#a-simple-example">A Simple Example</a></li>
<li><a class="reference internal" href="#advanced-topics">Advanced Topics</a></li>
<li><a class="reference internal" href="#pre-defined-models">Pre-Defined Models</a></li>
<li><a class="reference internal" href="#examples">Examples</a></li>
<li><a class="reference internal" href="#reference-api">Reference/API</a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/modeling/index.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011–2022, The Astropy Developers.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 3.5.4. &nbsp;
    Last built 09 May 2022. <br/>
  </p>
</footer>
  </body>
</html>