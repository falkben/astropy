


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Physical Models &#8212; Astropy v5.2.dev104+gcdd6a1f81.d20220509</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Polynomial Models" href="polynomial_models.html" />
    <link rel="prev" title="2D Models" href="predef_models2D.html" />
  
  <meta name="robots" content="noindex, nofollow">
  
  
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>


  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="polynomial_models.html" title="Polynomial Models">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="predef_models2D.html" title="2D Models">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">Astropy v5.2.dev104+gcdd6a1f81.d20220509</a>
	 &#187;
      </li>
      <li><a href="index.html" accesskey="U">Models and Fitting (<code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.modeling</span></code>)</a> &#187;</li>
      
      <li>Physical Models</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="physical-models">
<span id="predef-physicalmodels"></span><h1>Physical Models<a class="headerlink" href="#physical-models" title="Permalink to this headline">¶</a></h1>
<p>These are models that are physical motivated, generally as solutions to
physical problems.  This is in contrast to those that are mathematically motivated,
generally as solutions to mathematical problems.</p>
<div class="section" id="blackbody">
<span id="blackbody-planck-law"></span><h2>BlackBody<a class="headerlink" href="#blackbody" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="../api/astropy.modeling.physical_models.BlackBody.html#astropy.modeling.physical_models.BlackBody" title="astropy.modeling.physical_models.BlackBody"><code class="xref py py-class docutils literal notranslate"><span class="pre">BlackBody</span></code></a> model provides a model
for using <a class="reference external" href="https://en.wikipedia.org/wiki/Planck%27s_law">Planck’s Law</a>.
The blackbody function is</p>
<div class="math notranslate nohighlight">
\[B_{\nu}(T) = A \frac{2 h \nu^{3} / c^{2}}{exp(h \nu / k T) - 1}\]</div>
<p>where <span class="math notranslate nohighlight">\(\nu\)</span> is the frequency, <span class="math notranslate nohighlight">\(T\)</span> is the temperature,
<span class="math notranslate nohighlight">\(A\)</span> is the scaling factor,
<span class="math notranslate nohighlight">\(h\)</span> is the Plank constant, <span class="math notranslate nohighlight">\(c\)</span> is the speed of light, and
<span class="math notranslate nohighlight">\(k\)</span> is the Boltzmann constant.</p>
<p>The two parameters of the model the scaling factor <code class="docutils literal notranslate"><span class="pre">scale</span></code> (A) and
the absolute temperature <code class="docutils literal notranslate"><span class="pre">temperature</span></code> (T).  If the <code class="docutils literal notranslate"><span class="pre">scale</span></code> factor does not
have units, then the result is in units of spectral radiance, specifically
ergs/(cm^2 Hz s sr).  If the <code class="docutils literal notranslate"><span class="pre">scale</span></code> factor is passed with spectral radiance units,
then the result is in those units (e.g., ergs/(cm^2 A s sr) or MJy/sr).
Setting the <code class="docutils literal notranslate"><span class="pre">scale</span></code> factor with units of ergs/(cm^2 A s sr) will give the
Planck function as <span class="math notranslate nohighlight">\(B_\lambda\)</span>.
The temperature can be passed as a Quantity with any supported temperature unit.</p>
<p>An example plot for a blackbody with a temperature of 10000 K and a scale of 1 is
shown below.  A scale of 1 shows the Planck function with no scaling in the
default units returned by <a class="reference internal" href="../api/astropy.modeling.physical_models.BlackBody.html#astropy.modeling.physical_models.BlackBody" title="astropy.modeling.physical_models.BlackBody"><code class="xref py py-class docutils literal notranslate"><span class="pre">BlackBody</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">astropy.modeling.models</span> <span class="kn">import</span> <span class="n">BlackBody</span>
<span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>

<span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">3e4</span><span class="p">),</span> <span class="n">num</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">AA</span>

<span class="c1"># blackbody parameters</span>
<span class="n">temperature</span> <span class="o">=</span> <span class="mi">10000</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">K</span>

<span class="c1"># BlackBody provides the results in ergs/(cm^2 Hz s sr) when scale has no units</span>
<span class="n">bb</span> <span class="o">=</span> <span class="n">BlackBody</span><span class="p">(</span><span class="n">temperature</span><span class="o">=</span><span class="n">temperature</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="mf">10000.0</span><span class="p">)</span>
<span class="n">bb_result</span> <span class="o">=</span> <span class="n">bb</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">bb_result</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">fr</span><span class="s2">&quot;$\lambda$ [</span><span class="si">{</span><span class="n">wavelengths</span><span class="o">.</span><span class="n">unit</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">fr</span><span class="s2">&quot;$F(\lambda)$ [</span><span class="si">{</span><span class="n">bb_result</span><span class="o">.</span><span class="n">unit</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../modeling/physical_models-1.png">png</a>, <a class="reference external" href="../modeling/physical_models-1.svg">svg</a>, <a class="reference external" href="../modeling/physical_models-1.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="../_images/physical_models-1.png" class="plot-directive" src="../_images/physical_models-1.png" />
</div>
<p>The <a class="reference internal" href="../api/astropy.modeling.physical_models.BlackBody.html#astropy.modeling.physical_models.BlackBody.bolometric_flux" title="astropy.modeling.physical_models.BlackBody.bolometric_flux"><code class="xref py py-meth docutils literal notranslate"><span class="pre">bolometric_flux()</span></code></a> member
function gives the bolometric flux using
<span class="math notranslate nohighlight">\(\sigma T^4/\pi\)</span> where <span class="math notranslate nohighlight">\(\sigma\)</span> is the Stefan-Boltzmann constant.</p>
<p>The <a class="reference internal" href="../api/astropy.modeling.physical_models.BlackBody.html#astropy.modeling.physical_models.BlackBody.lambda_max" title="astropy.modeling.physical_models.BlackBody.lambda_max"><code class="xref py py-meth docutils literal notranslate"><span class="pre">lambda_max()</span></code></a> and
<a class="reference internal" href="../api/astropy.modeling.physical_models.BlackBody.html#astropy.modeling.physical_models.BlackBody.nu_max" title="astropy.modeling.physical_models.BlackBody.nu_max"><code class="xref py py-meth docutils literal notranslate"><span class="pre">nu_max()</span></code></a> member functions
give the wavelength and frequency of the maximum for <span class="math notranslate nohighlight">\(B_\lambda\)</span>
and <span class="math notranslate nohighlight">\(B_\nu\)</span>, respectively, calculated using <a class="reference external" href="https://en.wikipedia.org/wiki/Wien%27s_displacement_law">Wien’s Law</a>.</p>
</div>
<div class="section" id="drude1d">
<h2>Drude1D<a class="headerlink" href="#drude1d" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="../api/astropy.modeling.physical_models.Drude1D.html#astropy.modeling.physical_models.Drude1D" title="astropy.modeling.physical_models.Drude1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">Drude1D</span></code></a> model provides a model
for the behavior of an electron in a material
(see <a class="reference external" href="https://en.wikipedia.org/wiki/Drude_model">Drude Model</a>).
Like the <a class="reference internal" href="../api/astropy.modeling.functional_models.Lorentz1D.html#astropy.modeling.functional_models.Lorentz1D" title="astropy.modeling.functional_models.Lorentz1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">Lorentz1D</span></code></a> model, the Drude model
has broader wings than the <a class="reference internal" href="../api/astropy.modeling.functional_models.Gaussian1D.html#astropy.modeling.functional_models.Gaussian1D" title="astropy.modeling.functional_models.Gaussian1D"><code class="xref py py-class docutils literal notranslate"><span class="pre">Gaussian1D</span></code></a>
model.  The Drude profile has been used to model dust features including the
2175 Angstrom extinction feature and the mid-infrared aromatic/PAH features.
The Drude function at <span class="math notranslate nohighlight">\(x\)</span> is</p>
<div class="math notranslate nohighlight">
\[D(x) = A \frac{(f/x_0)^2}{((x/x_0 - x_0/x)^2 + (f/x_0)^2}\]</div>
<p>where <span class="math notranslate nohighlight">\(A\)</span> is the amplitude, <span class="math notranslate nohighlight">\(f\)</span> is the full width at half maximum,
and <span class="math notranslate nohighlight">\(x_0\)</span> is the central wavelength.  An example of a Drude1D model
with <span class="math notranslate nohighlight">\(x_0 = 2175\)</span> Angstrom and <span class="math notranslate nohighlight">\(f = 400\)</span> Angstrom is shown below.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="kn">from</span> <span class="nn">astropy.modeling.models</span> <span class="kn">import</span> <span class="n">Drude1D</span>
<span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>

<span class="n">wavelengths</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span> <span class="n">num</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">AA</span>

<span class="c1"># Parameters and model</span>
<span class="n">mod</span> <span class="o">=</span> <span class="n">Drude1D</span><span class="p">(</span><span class="n">amplitude</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">x_0</span><span class="o">=</span><span class="mf">2175.</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">AA</span><span class="p">,</span> <span class="n">fwhm</span><span class="o">=</span><span class="mf">400.</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">AA</span><span class="p">)</span>
<span class="n">mod_result</span> <span class="o">=</span> <span class="n">mod</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">)</span>

<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">ncols</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">wavelengths</span><span class="p">,</span> <span class="n">mod_result</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">fr</span><span class="s2">&quot;$\lambda$ [</span><span class="si">{</span><span class="n">wavelengths</span><span class="o">.</span><span class="n">unit</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$D(\lambda)$&quot;</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../modeling/physical_models-2.png">png</a>, <a class="reference external" href="../modeling/physical_models-2.svg">svg</a>, <a class="reference external" href="../modeling/physical_models-2.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="../_images/physical_models-2.png" class="plot-directive" src="../_images/physical_models-2.png" />
</div>
</div>
<div class="section" id="nfw">
<span id="id1"></span><h2>NFW<a class="headerlink" href="#nfw" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="../api/astropy.modeling.physical_models.NFW.html#astropy.modeling.physical_models.NFW" title="astropy.modeling.physical_models.NFW"><code class="xref py py-class docutils literal notranslate"><span class="pre">NFW</span></code></a> model computes a
1-dimensional Navarro–Frenk–White profile. The dark matter density in an
NFW profile is given by:</p>
<div class="math notranslate nohighlight">
\[\rho(r)=\frac{\delta_c\rho_{c}}{r/r_s(1+r/r_s)^2}\]</div>
<p>where <span class="math notranslate nohighlight">\(\rho_{c}\)</span> is the critical density of the Universe at the redshift
of the profile, <span class="math notranslate nohighlight">\(\delta_c\)</span> is the over density, and <span class="math notranslate nohighlight">\(r_s\)</span> is the
scale radius of the profile.</p>
<p>This model relies on three parameters:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">mass</span></code> : the mass of the profile (in solar masses if no units are provided)</p>
<p><code class="docutils literal notranslate"><span class="pre">concentration</span></code> : the profile concentration</p>
<p><code class="docutils literal notranslate"><span class="pre">redshift</span></code> : the redshift of the profile</p>
</div></blockquote>
<p>As well as two optional initialization variables:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">massfactor</span></code> : tuple or string specifying the overdensity type and factor (default (“critical”, 200))</p>
<p><code class="docutils literal notranslate"><span class="pre">cosmo</span></code> : the cosmology for density calculation (default default_cosmology)</p>
</div></blockquote>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Initialization of NFW profile object required before evaluation (in order to set mass
overdensity and cosmology).</p>
</div>
<dl>
<dt>Sample plots of an NFW profile with the following parameters are displayed below:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">mass</span></code> = <span class="math notranslate nohighlight">\(2.0 x 10^{15} M_{sun}\)</span></p>
<p><code class="docutils literal notranslate"><span class="pre">concentration</span></code> = 8.5</p>
<p><code class="docutils literal notranslate"><span class="pre">redshift</span></code> = 0.63</p>
</dd>
</dl>
<p>The first plot is of the NFW profile density as a function of radius.
The second plot displays the profile density and radius normalized by the NFW scale
density and scale radius, respectively. The scale density and scale radius are available
as attributes <code class="docutils literal notranslate"><span class="pre">rho_s</span></code> and <code class="docutils literal notranslate"><span class="pre">r_s</span></code>, and the overdensity radius can be accessed via <code class="docutils literal notranslate"><span class="pre">r_virial</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">astropy.modeling.models</span> <span class="kn">import</span> <span class="n">NFW</span>
<span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">cosmology</span>

<span class="c1"># NFW Parameters</span>
<span class="n">mass</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">2.0E15</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">M_sun</span><span class="p">)</span>
<span class="n">concentration</span> <span class="o">=</span> <span class="mf">8.5</span>
<span class="n">redshift</span> <span class="o">=</span> <span class="mf">0.63</span>
<span class="n">cosmo</span> <span class="o">=</span> <span class="n">cosmology</span><span class="o">.</span><span class="n">Planck15</span>
<span class="n">massfactor</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;critical&quot;</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

<span class="c1"># Create NFW Object</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">NFW</span><span class="p">(</span><span class="n">mass</span><span class="o">=</span><span class="n">mass</span><span class="p">,</span> <span class="n">concentration</span><span class="o">=</span><span class="n">concentration</span><span class="p">,</span> <span class="n">redshift</span><span class="o">=</span><span class="n">redshift</span><span class="p">,</span> <span class="n">cosmo</span><span class="o">=</span><span class="n">cosmo</span><span class="p">,</span>
        <span class="n">massfactor</span><span class="o">=</span><span class="n">massfactor</span><span class="p">)</span>

<span class="c1"># Radial distribution for plotting</span>
<span class="n">radii</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2001</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">kpc</span>

<span class="c1"># Radial NFW density distribution</span>
<span class="n">n_result</span> <span class="o">=</span> <span class="n">n</span><span class="p">(</span><span class="n">radii</span><span class="p">)</span>

<span class="c1"># Plot creation</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="s1">&#39;1 Dimensional NFW Profile&#39;</span><span class="p">)</span>

<span class="c1"># Density profile subplot</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">radii</span><span class="p">,</span> <span class="n">n_result</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">fr</span><span class="s2">&quot;$r$ [</span><span class="si">{</span><span class="n">radii</span><span class="o">.</span><span class="n">unit</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">fr</span><span class="s2">&quot;$\rho$ [</span><span class="si">{</span><span class="n">n_result</span><span class="o">.</span><span class="n">unit</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>

<span class="c1"># Create scaled density / scaled radius subplot</span>
<span class="c1"># NFW Object</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">NFW</span><span class="p">(</span><span class="n">mass</span><span class="o">=</span><span class="n">mass</span><span class="p">,</span> <span class="n">concentration</span><span class="o">=</span><span class="n">concentration</span><span class="p">,</span> <span class="n">redshift</span><span class="o">=</span><span class="n">redshift</span><span class="p">,</span> <span class="n">cosmo</span><span class="o">=</span><span class="n">cosmo</span><span class="p">,</span>
        <span class="n">massfactor</span><span class="o">=</span><span class="n">massfactor</span><span class="p">)</span>

<span class="c1"># Radial distribution for plotting</span>
<span class="n">radii</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mf">1e-5</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="mi">2</span><span class="p">),</span> <span class="n">num</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">Mpc</span>
<span class="n">n_result</span> <span class="o">=</span> <span class="n">n</span><span class="p">(</span><span class="n">radii</span><span class="p">)</span>

<span class="c1"># Scaled density / scaled radius subplot</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">radii</span> <span class="o">/</span> <span class="n">n</span><span class="o">.</span><span class="n">radius_s</span><span class="p">,</span> <span class="n">n_result</span> <span class="o">/</span> <span class="n">n</span><span class="o">.</span><span class="n">density_s</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_yscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$r / r_s$&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\rho / \rho_s$&quot;</span><span class="p">)</span>

<span class="c1"># Display plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../modeling/physical_models-3.png">png</a>, <a class="reference external" href="../modeling/physical_models-3.svg">svg</a>, <a class="reference external" href="../modeling/physical_models-3.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="../_images/physical_models-3.png" class="plot-directive" src="../_images/physical_models-3.png" />
</div>
<p>The <a class="reference internal" href="../api/astropy.modeling.physical_models.NFW.html#astropy.modeling.physical_models.NFW.circular_velocity" title="astropy.modeling.physical_models.NFW.circular_velocity"><code class="xref py py-meth docutils literal notranslate"><span class="pre">circular_velocity()</span></code></a> member provides the circular
velocity at each position <code class="docutils literal notranslate"><span class="pre">r</span></code> via the equation:</p>
<div class="math notranslate nohighlight">
\[v_{circ}(r)^2=\frac{1}{x}\frac{\ln(1+cx)-(cx)/(1+cx)}{\ln(1+c)-c/(1+c)}\]</div>
<p>where x is the ratio <code class="docutils literal notranslate"><span class="pre">r</span></code><span class="math notranslate nohighlight">\(/r_{vir}\)</span>. Circular velocities are provided in km/s.</p>
<p>A sample plot of circular velocities of an NFW profile with the following parameters is displayed
below:</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">mass</span></code> = <span class="math notranslate nohighlight">\(2.0 x 10^{15} M_{sun}\)</span></p>
<p><code class="docutils literal notranslate"><span class="pre">concentration</span></code> = 8.5</p>
<p><code class="docutils literal notranslate"><span class="pre">redshift</span></code> = 0.63</p>
</div></blockquote>
<p>The maximum circular velocity and radius of maximum circular velocity are available as attributes
<code class="docutils literal notranslate"><span class="pre">v_max</span></code> and <code class="docutils literal notranslate"><span class="pre">r_max</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">astropy.modeling.models</span> <span class="kn">import</span> <span class="n">NFW</span>
<span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">cosmology</span>

<span class="c1"># NFW Parameters</span>
<span class="n">mass</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="mf">2.0E15</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">M_sun</span><span class="p">)</span>
<span class="n">concentration</span> <span class="o">=</span> <span class="mf">8.5</span>
<span class="n">redshift</span> <span class="o">=</span> <span class="mf">0.63</span>
<span class="n">cosmo</span> <span class="o">=</span> <span class="n">cosmology</span><span class="o">.</span><span class="n">Planck15</span>
<span class="n">massfactor</span> <span class="o">=</span> <span class="p">(</span><span class="s2">&quot;critical&quot;</span><span class="p">,</span> <span class="mi">200</span><span class="p">)</span>

<span class="c1"># Create NFW Object</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">NFW</span><span class="p">(</span><span class="n">mass</span><span class="o">=</span><span class="n">mass</span><span class="p">,</span> <span class="n">concentration</span><span class="o">=</span><span class="n">concentration</span><span class="p">,</span> <span class="n">redshift</span><span class="o">=</span><span class="n">redshift</span><span class="p">,</span> <span class="n">cosmo</span><span class="o">=</span><span class="n">cosmo</span><span class="p">,</span>
        <span class="n">massfactor</span><span class="o">=</span><span class="n">massfactor</span><span class="p">)</span>

<span class="c1"># Radial distribution for plotting</span>
<span class="n">radii</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">200001</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">kpc</span>

<span class="c1"># NFW circular velocity distribution</span>
<span class="n">n_result</span> <span class="o">=</span> <span class="n">n</span><span class="o">.</span><span class="n">circular_velocity</span><span class="p">(</span><span class="n">radii</span><span class="p">)</span>

<span class="c1"># Plot creation</span>
<span class="n">fig</span><span class="p">,</span><span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s1">&#39;NFW Profile Circular Velocity&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">radii</span><span class="p">,</span> <span class="n">n_result</span><span class="p">,</span> <span class="s1">&#39;-&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xscale</span><span class="p">(</span><span class="s1">&#39;log&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">fr</span><span class="s2">&quot;$r$ [</span><span class="si">{</span><span class="n">radii</span><span class="o">.</span><span class="n">unit</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$v_</span><span class="si">{circ}</span><span class="s2">$&quot;</span> <span class="o">+</span> <span class="sa">f</span><span class="s2">&quot; [</span><span class="si">{</span><span class="n">n_result</span><span class="o">.</span><span class="n">unit</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>

<span class="c1"># Display plot</span>
<span class="n">plt</span><span class="o">.</span><span class="n">tight_layout</span><span class="p">(</span><span class="n">rect</span><span class="o">=</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mf">0.03</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.95</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../modeling/physical_models-4.png">png</a>, <a class="reference external" href="../modeling/physical_models-4.svg">svg</a>, <a class="reference external" href="../modeling/physical_models-4.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="../_images/physical_models-4.png" class="plot-directive" src="../_images/physical_models-4.png" />
</div>
</div>
<div class="section" id="cosmologies">
<span id="id2"></span><h2>Cosmologies<a class="headerlink" href="#cosmologies" title="Permalink to this headline">¶</a></h2>
<p>The instances of the <a class="reference internal" href="../api/astropy.cosmology.Cosmology.html#astropy.cosmology.Cosmology" title="astropy.cosmology.Cosmology"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cosmology</span></code></a> class (and subclasses) include
<a class="reference internal" href="../api/astropy.cosmology.Cosmology.html#astropy.cosmology.Cosmology.to_format" title="astropy.cosmology.Cosmology.to_format"><code class="xref py py-meth docutils literal notranslate"><span class="pre">to_format()</span></code></a>, a method to convert a Cosmology to another python
object. Specifically, any redshift method can be converted to a
<a class="reference internal" href="../api/astropy.modeling.FittableModel.html#astropy.modeling.FittableModel" title="astropy.modeling.FittableModel"><code class="xref py py-class docutils literal notranslate"><span class="pre">FittableModel</span></code></a> instance using the argument
<code class="docutils literal notranslate"><span class="pre">format=&quot;astropy.model&quot;</span></code>.
During the conversion, each <a class="reference internal" href="../api/astropy.cosmology.Cosmology.html#astropy.cosmology.Cosmology" title="astropy.cosmology.Cosmology"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cosmology</span></code></a> <a class="reference internal" href="../api/astropy.cosmology.Parameter.html#astropy.cosmology.Parameter" title="astropy.cosmology.Parameter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameter</span></code></a>
is converted to a <a class="reference internal" href="../api/astropy.modeling.Model.html#astropy.modeling.Model" title="astropy.modeling.Model"><code class="xref py py-class docutils literal notranslate"><span class="pre">astropy.modeling.Model</span></code></a>
<a class="reference internal" href="../api/astropy.modeling.Parameter.html#astropy.modeling.Parameter" title="astropy.modeling.Parameter"><code class="xref py py-class docutils literal notranslate"><span class="pre">Parameter</span></code></a>, while the redshift-method becomes the
model’s <code class="docutils literal notranslate"><span class="pre">__call__</span></code> / <code class="docutils literal notranslate"><span class="pre">evaluate</span></code> method.
This means cosmologies can now be fit with data!</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.cosmology</span> <span class="kn">import</span> <span class="n">Planck18</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">Planck18</span><span class="o">.</span><span class="n">to_format</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s2">&quot;astropy.model&quot;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;lookback_time&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span>
<span class="go">&lt;FlatLambdaCDMCosmologyLookbackTimeModel(H0=67.66 km / (Mpc s), Om0=0.30966,</span>
<span class="go">    Tcmb0=2.7255 K, Neff=3.046, m_nu=[0.  , 0.  , 0.06] eV, Ob0=0.04897,</span>
<span class="go">    name=&#39;Planck18&#39;)&gt;</span>
</pre></div>
</div>
<p>When finished, e.g. fitting, a model can be turned back into a <a class="reference internal" href="../api/astropy.cosmology.Cosmology.html#astropy.cosmology.Cosmology" title="astropy.cosmology.Cosmology"><code class="xref py py-class docutils literal notranslate"><span class="pre">Cosmology</span></code></a>
using <a class="reference internal" href="../api/astropy.cosmology.Cosmology.html#astropy.cosmology.Cosmology.from_format" title="astropy.cosmology.Cosmology.from_format"><code class="xref py py-meth docutils literal notranslate"><span class="pre">from_format()</span></code></a>.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.cosmology</span> <span class="kn">import</span> <span class="n">Cosmology</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span> <span class="o">=</span> <span class="n">Cosmology</span><span class="o">.</span><span class="n">from_format</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s2">&quot;astropy.model&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cosmo</span> <span class="o">==</span> <span class="n">Planck18</span>
<span class="go">True</span>
</pre></div>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Physical Models</a><ul>
<li><a class="reference internal" href="#blackbody">BlackBody</a></li>
<li><a class="reference internal" href="#drude1d">Drude1D</a></li>
<li><a class="reference internal" href="#nfw">NFW</a></li>
<li><a class="reference internal" href="#cosmologies">Cosmologies</a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/modeling/physical_models.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011–2022, The Astropy Developers.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 3.5.4. &nbsp;
    Last built 09 May 2022. <br/>
  </p>
</footer>
  </body>
</html>