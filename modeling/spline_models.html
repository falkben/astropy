


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>1D Spline Models &#8212; Astropy v5.2.dev94+gb1133d712.d20220509</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Fitting a Line" href="example-fitting-line.html" />
    <link rel="prev" title="Powerlaw Models" href="powerlaw_models.html" />
  
  <meta name="robots" content="noindex, nofollow">
  
  
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>


  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="example-fitting-line.html" title="Fitting a Line">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="powerlaw_models.html" title="Powerlaw Models">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">Astropy v5.2.dev94+gb1133d712.d20220509</a>
	 &#187;
      </li>
      <li><a href="index.html" accesskey="U">Models and Fitting (<code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.modeling</span></code>)</a> &#187;</li>
      
      <li>1D Spline Models</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="d-spline-models">
<span id="spline-models"></span><h1>1D Spline Models<a class="headerlink" href="#d-spline-models" title="Permalink to this headline">¶</a></h1>
<p><a class="reference internal" href="../api/astropy.modeling.spline.Spline1D.html#astropy.modeling.spline.Spline1D" title="astropy.modeling.spline.Spline1D"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Spline1D</span></code></a> models are models which can be used
to fit a piecewise polynomial to a set of data. This means that splines
are closely tied to the method used to fit the spline to the data. Currently,
we provide three methods for fitting splines to data:</p>
<ul>
<li><p><a class="reference internal" href="../api/astropy.modeling.spline.SplineInterpolateFitter.html#astropy.modeling.spline.SplineInterpolateFitter" title="astropy.modeling.spline.SplineInterpolateFitter"><code class="xref py py-class docutils literal notranslate"><span class="pre">SplineInterpolateFitter</span></code></a>, which
fits an interpolating spline to the data. This means that the spline
will exactly fit all data points.</p></li>
<li><p><a class="reference internal" href="../api/astropy.modeling.spline.SplineSmoothingFitter.html#astropy.modeling.spline.SplineSmoothingFitter" title="astropy.modeling.spline.SplineSmoothingFitter"><code class="xref py py-class docutils literal notranslate"><span class="pre">SplineSmoothingFitter</span></code></a>, which fits
a smoothing spline to the data. This means that the number of knots
is chosen to satisfy the “smoothing condition”:</p>
<div class="math notranslate nohighlight">
\[\sum_{i} \left(w_i * (y_i - spl(x_i))\right)^{2} \leq s\]</div>
</li>
<li><p><a class="reference internal" href="../api/astropy.modeling.spline.SplineExactKnotsFitter.html#astropy.modeling.spline.SplineExactKnotsFitter" title="astropy.modeling.spline.SplineExactKnotsFitter"><code class="xref py py-class docutils literal notranslate"><span class="pre">SplineExactKnotsFitter</span></code></a>, which fits
a spline to the data using an exact set of knots. This means that the
spline will use least-squares regression using the user supplied (interior)
knots to find the best fit spline to the data.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">astropy.modeling.models</span> <span class="kn">import</span> <span class="n">Spline1D</span>
<span class="kn">from</span> <span class="nn">astropy.modeling.fitting</span> <span class="kn">import</span> <span class="p">(</span><span class="n">SplineInterpolateFitter</span><span class="p">,</span>
                                      <span class="n">SplineSmoothingFitter</span><span class="p">,</span>
                                      <span class="n">SplineExactKnotsFitter</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">50</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">x</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span> <span class="o">+</span> <span class="mf">0.1</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
<span class="n">xs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">1000</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
<span class="n">spl</span> <span class="o">=</span> <span class="n">Spline1D</span><span class="p">()</span>

<span class="n">fitter</span> <span class="o">=</span> <span class="n">SplineInterpolateFitter</span><span class="p">()</span>
<span class="n">spl1</span> <span class="o">=</span> <span class="n">fitter</span><span class="p">(</span><span class="n">spl</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">fitter</span> <span class="o">=</span> <span class="n">SplineSmoothingFitter</span><span class="p">()</span>
<span class="n">spl2</span> <span class="o">=</span> <span class="n">fitter</span><span class="p">(</span><span class="n">spl</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>

<span class="n">fitter</span> <span class="o">=</span> <span class="n">SplineExactKnotsFitter</span><span class="p">()</span>
<span class="n">spl3</span> <span class="o">=</span> <span class="n">fitter</span><span class="p">(</span><span class="n">spl</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">t</span><span class="o">=</span><span class="n">t</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="s1">&#39;ro&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Data&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">spl1</span><span class="p">(</span><span class="n">xs</span><span class="p">),</span> <span class="s1">&#39;b-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Interpolating&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">spl2</span><span class="p">(</span><span class="n">xs</span><span class="p">),</span> <span class="s1">&#39;g-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Smoothing&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">xs</span><span class="p">,</span> <span class="n">spl3</span><span class="p">(</span><span class="n">xs</span><span class="p">),</span> <span class="s1">&#39;k-&#39;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Exact Knots&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../modeling/spline_models-1.png">png</a>, <a class="reference external" href="../modeling/spline_models-1.svg">svg</a>, <a class="reference external" href="../modeling/spline_models-1.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="../_images/spline_models-1.png" class="plot-directive" src="../_images/spline_models-1.png" />
</div>
<p>Note that by default, splines have <a class="reference internal" href="../api/astropy.modeling.spline.Spline1D.html#astropy.modeling.spline.Spline1D.degree" title="astropy.modeling.spline.Spline1D.degree"><code class="xref py py-obj docutils literal notranslate"><span class="pre">degree</span></code></a> 3.
In the case of these splines, the <code class="docutils literal notranslate"><span class="pre">degree</span> <span class="pre">-</span> <span class="pre">1</span></code> is the number of derivatives that
are matched by the spline across knot points. So for degree 3 splines, the value,
first, and second derivatives of the spline will match across each knot point.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Splines only support integer degrees, such that <code class="docutils literal notranslate"><span class="pre">1</span> <span class="pre">&lt;=</span> <span class="pre">degree</span> <span class="pre">&lt;=</span> <span class="pre">5</span></code>.</p>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">1D Spline Models</a></li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/modeling/spline_models.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011–2022, The Astropy Developers.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 3.5.4. &nbsp;
    Last built 08 May 2022. <br/>
  </p>
</footer>
  </body>
</html>