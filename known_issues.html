


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Known Issues &#8212; Astropy v5.2.dev104+gcdd6a1f81.d20220509</title>
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="_static/sg_gallery-rendered-html.css" />
    
    <script id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/doctools.js"></script>
    <script type="text/javascript" src="_static/sidebar.js"></script>
    <script type="text/javascript" src="_static/copybutton.js"></script>
    <link rel="shortcut icon" href="_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Authors and Credits" href="credits.html" />
    <link rel="prev" title="LTS Backport Policy" href="lts_policy.html" />
  
  <meta name="robots" content="noindex, nofollow">
  
  
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>


  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="genindex.html">Index</a></li>
    <li><a title="Module Index" href="py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="credits.html" title="Authors and Credits">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="lts_policy.html" title="LTS Backport Policy">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="index.html">Astropy v5.2.dev104+gcdd6a1f81.d20220509</a>
	 &#187;
      </li>
      
      <li>Known Issues</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="known-issues">
<h1>Known Issues<a class="headerlink" href="#known-issues" title="Permalink to this headline">¶</a></h1>
<div class="contents local topic" id="contents">
<ul class="simple">
<li><p><a class="reference internal" href="#known-deficiencies" id="id1">Known Deficiencies</a></p>
<ul>
<li><p><a class="reference internal" href="#quantities-lose-their-units-with-some-operations" id="id2">Quantities Lose Their Units with Some Operations</a></p></li>
<li><p><a class="reference internal" href="#numpy-array-creation-functions-cannot-be-used-to-initialize-quantity" id="id3">Numpy array creation functions cannot be used to initialize Quantity</a></p></li>
<li><p><a class="reference internal" href="#quantities-lose-their-units-when-broadcasted" id="id4">Quantities Lose Their Units When Broadcasted</a></p></li>
<li><p><a class="reference internal" href="#mmap-support-for-astropy-io-fits-on-gnu-hurd" id="id5">mmap Support for <code class="docutils literal notranslate"><span class="pre">astropy.io.fits</span></code> on GNU Hurd</a></p></li>
<li><p><a class="reference internal" href="#color-printing-on-windows" id="id6">Color Printing on Windows</a></p></li>
<li><p><a class="reference internal" href="#numpy-int64-does-not-decompose-input-quantity-objects" id="id7"><code class="docutils literal notranslate"><span class="pre">numpy.int64</span></code> does not decompose input <code class="docutils literal notranslate"><span class="pre">Quantity</span></code> objects</a></p></li>
<li><p><a class="reference internal" href="#inconsistent-behavior-when-converting-complex-numbers-to-floats" id="id8">Inconsistent behavior when converting complex numbers to floats</a></p></li>
<li><p><a class="reference internal" href="#structured-units-deserialization-segfaults-in-big-endian" id="id9">Structured units deserialization segfaults in big-endian</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#build-installation-test-issues" id="id10">Build/Installation/Test Issues</a></p>
<ul>
<li><p><a class="reference internal" href="#anaconda-users-should-upgrade-with-conda-not-pip" id="id11">Anaconda Users Should Upgrade with <code class="docutils literal notranslate"><span class="pre">conda</span></code>, Not <code class="docutils literal notranslate"><span class="pre">pip</span></code></a></p></li>
<li><p><a class="reference internal" href="#locale-errors-in-macos-x-and-linux" id="id12">Locale Errors in MacOS X and Linux</a></p></li>
<li><p><a class="reference internal" href="#failing-logging-tests-when-running-the-tests-in-ipython" id="id13">Failing Logging Tests When Running the Tests in IPython</a></p></li>
</ul>
</li>
</ul>
</div>
<p>While most bugs and issues are managed using the <a class="reference external" href="https://github.com/astropy/astropy/issues">astropy issue
tracker</a>, this document
lists issues that are too difficult to fix, may require some
intervention from the user to work around, or are caused by bugs in other
projects or packages.</p>
<p>Issues listed on this page are grouped into two categories: The first is known
issues and shortcomings in actual algorithms and interfaces that currently do
not have fixes or workarounds, and that users should be aware of when writing
code that uses <code class="docutils literal notranslate"><span class="pre">astropy</span></code>. Some of those issues are still platform-specific,
while others are very general. The second category is of common issues that come
up when configuring, building, or installing <code class="docutils literal notranslate"><span class="pre">astropy</span></code>. This also includes
cases where the test suite can report false negatives depending on the context/
platform on which it was run.</p>
<div class="section" id="known-deficiencies">
<h2><a class="toc-backref" href="#id1">Known Deficiencies</a><a class="headerlink" href="#known-deficiencies" title="Permalink to this headline">¶</a></h2>
<div class="section" id="quantities-lose-their-units-with-some-operations">
<span id="quantity-issues"></span><h3><a class="toc-backref" href="#id2">Quantities Lose Their Units with Some Operations</a><a class="headerlink" href="#quantities-lose-their-units-with-some-operations" title="Permalink to this headline">¶</a></h3>
<p>Quantities are subclassed from <code class="docutils literal notranslate"><span class="pre">numpy</span></code>’s <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code></a> and while we have
ensured that <code class="docutils literal notranslate"><span class="pre">numpy</span></code> functions will work well with them, they do not always
work in functions from <code class="docutils literal notranslate"><span class="pre">scipy</span></code> or other packages that use <code class="docutils literal notranslate"><span class="pre">numpy</span></code>
internally, but ignore the subclass. Furthermore, at a few places in <code class="docutils literal notranslate"><span class="pre">numpy</span></code>
itself we cannot control the behaviour. For instance, care must be taken when
setting array slices using Quantities:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">2</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">kg</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> 
<span class="go">array([1., 1., 2., 1.])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> 
<span class="go">array([1., 1., 1., 1.])</span>
</pre></div>
</div>
<p>Either set single array entries or use lists of Quantities:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">m</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> 
<span class="go">array([1.  , 1.  , 0.01, 1.  ])</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> 
<span class="go">array([1.  , 1.  , 0.01, 1.  ])</span>
</pre></div>
</div>
<p>Both will throw an exception if units do not cancel, e.g.:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">cm</span> 
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">only dimensionless scalar quantities can be converted to Python scalars</span>
</pre></div>
</div>
<p>See: <a class="reference external" href="https://github.com/astropy/astropy/issues/7582">https://github.com/astropy/astropy/issues/7582</a></p>
</div>
<div class="section" id="numpy-array-creation-functions-cannot-be-used-to-initialize-quantity">
<h3><a class="toc-backref" href="#id3">Numpy array creation functions cannot be used to initialize Quantity</a><a class="headerlink" href="#numpy-array-creation-functions-cannot-be-used-to-initialize-quantity" title="Permalink to this headline">¶</a></h3>
<p>Trying the following example will throw an UnitConversionError
on NumPy before version 1.20 and ignore the unit in later versions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">my_quantity</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">my_quantity</span><span class="p">)</span>  
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">UnitConversionError</span>: <span class="n">&#39;m&#39; (length) and &#39;&#39; (dimensionless) are not convertible</span>
</pre></div>
</div>
<p>A workaround for this at the moment would be to do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">full</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="n">u</span><span class="o">.</span><span class="n">m</span>
<span class="go">&lt;Quantity [1., 1., 1., 1., 1., 1., 1., 1., 1., 1.] m&gt;</span>
</pre></div>
</div>
<p>As well as with <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.full.html#numpy.full" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">full</span></code></a> one cannot do <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">zeros</span></code></a>, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ones.html#numpy.ones" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ones</span></code></a>, and <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.empty.html#numpy.empty" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">empty</span></code></a>.</p>
<p>The <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">arange</span></code></a> function does not work either:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="mi">10</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="mi">1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>  
<span class="gt">Traceback (most recent call last):</span>
<span class="c">...</span>
<span class="gr">TypeError</span>: <span class="n">only dimensionless scalar quantities can be converted to Python scalars</span>
</pre></div>
</div>
<p>Workarounds include moving the units outside of the call to
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.arange.html#numpy.arange" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">arange</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">m</span>
<span class="go">&lt;Quantity [0., 1., 2., 3., 4., 5., 6., 7., 8., 9.] m&gt;</span>
</pre></div>
</div>
<p>Also, <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">linspace</span></code></a> does work:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="mi">9</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="go">&lt;Quantity [0., 1., 2., 3., 4., 5., 6., 7., 8., 9.] m&gt;</span>
</pre></div>
</div>
</div>
<div class="section" id="quantities-lose-their-units-when-broadcasted">
<h3><a class="toc-backref" href="#id4">Quantities Lose Their Units When Broadcasted</a><a class="headerlink" href="#quantities-lose-their-units-when-broadcasted" title="Permalink to this headline">¶</a></h3>
<p>When broadcasting Quantities, it is necessary to pass <code class="docutils literal notranslate"><span class="pre">subok=True</span></code> to
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.broadcast_to.html#numpy.broadcast_to" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">broadcast_to</span></code></a>, or else a bare <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code></a> will be returned:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">q</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Quantity</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">10.</span><span class="p">),</span> <span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b</span> 
<span class="go">array([[0., 1., 2., 3., 4., 5., 6., 7., 8., 9.],</span>
<span class="go">       [0., 1., 2., 3., 4., 5., 6., 7., 8., 9.]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">broadcast_to</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">q</span><span class="p">)),</span> <span class="n">subok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">b2</span> 
<span class="go">&lt;Quantity [[0., 1., 2., 3., 4., 5., 6., 7., 8., 9.],</span>
<span class="go">           [0., 1., 2., 3., 4., 5., 6., 7., 8., 9.]] m&gt;</span>
</pre></div>
</div>
<p>This is analogous to the case of passing a Quantity to <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.array.html#numpy.array" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">array</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a</span> 
<span class="go">array([0., 1., 2., 3., 4., 5., 6., 7., 8., 9.])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">q</span><span class="p">,</span> <span class="n">subok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a2</span> 
<span class="go">&lt;Quantity [0., 1., 2., 3., 4., 5., 6., 7., 8., 9.] m&gt;</span>
</pre></div>
</div>
<p>See: <a class="reference external" href="https://github.com/astropy/astropy/issues/7832">https://github.com/astropy/astropy/issues/7832</a></p>
</div>
<div class="section" id="mmap-support-for-astropy-io-fits-on-gnu-hurd">
<h3><a class="toc-backref" href="#id5">mmap Support for <code class="docutils literal notranslate"><span class="pre">astropy.io.fits</span></code> on GNU Hurd</a><a class="headerlink" href="#mmap-support-for-astropy-io-fits-on-gnu-hurd" title="Permalink to this headline">¶</a></h3>
<p>On Hurd and possibly other platforms, <code class="docutils literal notranslate"><span class="pre">flush()</span></code> on memory-mapped files are not
implemented, so writing changes to a mmap’d FITS file may not be reliable and is
thus disabled. Attempting to open a FITS file in writeable mode with mmap will
result in a warning (and mmap will be disabled on the file automatically).</p>
<p>See: <a class="reference external" href="https://github.com/astropy/astropy/issues/968">https://github.com/astropy/astropy/issues/968</a></p>
</div>
<div class="section" id="color-printing-on-windows">
<h3><a class="toc-backref" href="#id6">Color Printing on Windows</a><a class="headerlink" href="#color-printing-on-windows" title="Permalink to this headline">¶</a></h3>
<p>Colored printing of log messages and other colored text does work in Windows,
but only when running in the IPython console. Colors are not currently
supported in the basic Python command-line interpreter on Windows.</p>
</div>
<div class="section" id="numpy-int64-does-not-decompose-input-quantity-objects">
<h3><a class="toc-backref" href="#id7"><code class="docutils literal notranslate"><span class="pre">numpy.int64</span></code> does not decompose input <code class="docutils literal notranslate"><span class="pre">Quantity</span></code> objects</a><a class="headerlink" href="#numpy-int64-does-not-decompose-input-quantity-objects" title="Permalink to this headline">¶</a></h3>
<p>Python’s <code class="docutils literal notranslate"><span class="pre">int()</span></code> goes through <code class="docutils literal notranslate"><span class="pre">__index__</span></code>
while <code class="docutils literal notranslate"><span class="pre">numpy.int64</span></code> or <code class="docutils literal notranslate"><span class="pre">numpy.int_</span></code> do not go through <code class="docutils literal notranslate"><span class="pre">__index__</span></code>. This
means that an upstream fix in NumPy is required in order for
<code class="docutils literal notranslate"><span class="pre">astropy.units</span></code> to control decomposing the input in these functions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">((</span><span class="mi">15</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">km</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">15</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">imperial</span><span class="o">.</span><span class="n">foot</span><span class="p">))</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">int_</span><span class="p">((</span><span class="mi">15</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">km</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">15</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">imperial</span><span class="o">.</span><span class="n">foot</span><span class="p">))</span>
<span class="go">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">int</span><span class="p">((</span><span class="mi">15</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">km</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">15</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">imperial</span><span class="o">.</span><span class="n">foot</span><span class="p">))</span>
<span class="go">3280</span>
</pre></div>
</div>
<p>To convert a dimensionless <a class="reference internal" href="api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Quantity</span></code></a> to an integer, it is
therefore recommended to use <code class="docutils literal notranslate"><span class="pre">int(...)</span></code>.</p>
</div>
<div class="section" id="inconsistent-behavior-when-converting-complex-numbers-to-floats">
<h3><a class="toc-backref" href="#id8">Inconsistent behavior when converting complex numbers to floats</a><a class="headerlink" href="#inconsistent-behavior-when-converting-complex-numbers-to-floats" title="Permalink to this headline">¶</a></h3>
<p>Attempting to use <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code></a> or NumPy’s <code class="docutils literal notranslate"><span class="pre">numpy.float</span></code> on a standard
complex number (e.g., <code class="docutils literal notranslate"><span class="pre">5</span> <span class="pre">+</span> <span class="pre">6j</span></code>) results in a <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#TypeError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">TypeError</span></code></a>.  In
contrast, using <a class="reference external" href="https://docs.python.org/3/library/functions.html#float" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">float</span></code></a> or <code class="docutils literal notranslate"><span class="pre">numpy.float</span></code> on a complex number from
NumPy (e.g., <code class="docutils literal notranslate"><span class="pre">numpy.complex128</span></code>) drops the imaginary component and
issues a <code class="docutils literal notranslate"><span class="pre">numpy.ComplexWarning</span></code>.  This inconsistency persists between
<a class="reference internal" href="api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Quantity</span></code></a> instances based on standard and NumPy
complex numbers.  To get the real part of a complex number, it is
recommended to use <code class="docutils literal notranslate"><span class="pre">numpy.real</span></code>.</p>
</div>
<div class="section" id="structured-units-deserialization-segfaults-in-big-endian">
<span id="structured-unit-deserialization-segfault"></span><h3><a class="toc-backref" href="#id9">Structured units deserialization segfaults in big-endian</a><a class="headerlink" href="#structured-units-deserialization-segfaults-in-big-endian" title="Permalink to this headline">¶</a></h3>
<p>Structured units deserialization with <code class="docutils literal notranslate"><span class="pre">pickle</span></code> may cause segmentation
fault in big-endian machine with <code class="docutils literal notranslate"><span class="pre">numpy&lt;1.21.1</span></code>.</p>
</div>
</div>
<div class="section" id="build-installation-test-issues">
<h2><a class="toc-backref" href="#id10">Build/Installation/Test Issues</a><a class="headerlink" href="#build-installation-test-issues" title="Permalink to this headline">¶</a></h2>
<div class="section" id="anaconda-users-should-upgrade-with-conda-not-pip">
<h3><a class="toc-backref" href="#id11">Anaconda Users Should Upgrade with <code class="docutils literal notranslate"><span class="pre">conda</span></code>, Not <code class="docutils literal notranslate"><span class="pre">pip</span></code></a><a class="headerlink" href="#anaconda-users-should-upgrade-with-conda-not-pip" title="Permalink to this headline">¶</a></h3>
<p>Upgrading <code class="docutils literal notranslate"><span class="pre">astropy</span></code> in the Anaconda Python distribution using <code class="docutils literal notranslate"><span class="pre">pip</span></code> can result
in a corrupted install with a mix of files from the old version and the new
version. Anaconda users should update with <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">update</span> <span class="pre">astropy</span></code>. There
may be a brief delay between the release of <code class="docutils literal notranslate"><span class="pre">astropy</span></code> on PyPI and its release
via the <code class="docutils literal notranslate"><span class="pre">conda</span></code> package manager; users can check the availability of new
versions with <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">search</span> <span class="pre">astropy</span></code>.</p>
</div>
<div class="section" id="locale-errors-in-macos-x-and-linux">
<h3><a class="toc-backref" href="#id12">Locale Errors in MacOS X and Linux</a><a class="headerlink" href="#locale-errors-in-macos-x-and-linux" title="Permalink to this headline">¶</a></h3>
<p>On MacOS X, you may see the following error when running <code class="docutils literal notranslate"><span class="pre">pip</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
<span class="ne">ValueError</span><span class="p">:</span> <span class="n">unknown</span> <span class="n">locale</span><span class="p">:</span> <span class="n">UTF</span><span class="o">-</span><span class="mi">8</span>
</pre></div>
</div>
<p>This is due to the <code class="docutils literal notranslate"><span class="pre">LC_CTYPE</span></code> environment variable being incorrectly set to
<code class="docutils literal notranslate"><span class="pre">UTF-8</span></code> by default, which is not a valid locale setting.</p>
<p>On MacOS X or Linux (or other platforms) you may also encounter the following
error:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">...</span>
  <span class="n">stderr</span> <span class="o">=</span> <span class="n">stderr</span><span class="o">.</span><span class="n">decode</span><span class="p">(</span><span class="n">stdio_encoding</span><span class="p">)</span>
<span class="ne">TypeError</span><span class="p">:</span> <span class="n">decode</span><span class="p">()</span> <span class="n">argument</span> <span class="mi">1</span> <span class="n">must</span> <span class="n">be</span> <span class="nb">str</span><span class="p">,</span> <span class="ow">not</span> <span class="kc">None</span>
</pre></div>
</div>
<p>This also indicates that your locale is not set correctly.</p>
<p>To fix either of these issues, set this environment variable, as well as the
<code class="docutils literal notranslate"><span class="pre">LANG</span></code> and <code class="docutils literal notranslate"><span class="pre">LC_ALL</span></code> environment variables to e.g. <code class="docutils literal notranslate"><span class="pre">en_US.UTF-8</span></code> using, in
the case of <code class="docutils literal notranslate"><span class="pre">bash</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">LANG</span><span class="o">=</span><span class="s2">&quot;en_US.UTF-8&quot;</span>
<span class="n">export</span> <span class="n">LC_ALL</span><span class="o">=</span><span class="s2">&quot;en_US.UTF-8&quot;</span>
<span class="n">export</span> <span class="n">LC_CTYPE</span><span class="o">=</span><span class="s2">&quot;en_US.UTF-8&quot;</span>
</pre></div>
</div>
<p>To avoid any issues in future, you should add this line to your e.g.
<code class="docutils literal notranslate"><span class="pre">~/.bash_profile</span></code> or <code class="docutils literal notranslate"><span class="pre">.bashrc</span></code> file.</p>
<p>To test these changes, open a new terminal and type <code class="docutils literal notranslate"><span class="pre">locale</span></code>, and you should
see something like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ locale
LANG=&quot;en_US.UTF-8&quot;
LC_COLLATE=&quot;en_US.UTF-8&quot;
LC_CTYPE=&quot;en_US.UTF-8&quot;
LC_MESSAGES=&quot;en_US.UTF-8&quot;
LC_MONETARY=&quot;en_US.UTF-8&quot;
LC_NUMERIC=&quot;en_US.UTF-8&quot;
LC_TIME=&quot;en_US.UTF-8&quot;
LC_ALL=&quot;en_US.UTF-8&quot;
</pre></div>
</div>
<p>If so, you can go ahead and try running <code class="docutils literal notranslate"><span class="pre">pip</span></code> again (in the new
terminal).</p>
</div>
<div class="section" id="failing-logging-tests-when-running-the-tests-in-ipython">
<h3><a class="toc-backref" href="#id13">Failing Logging Tests When Running the Tests in IPython</a><a class="headerlink" href="#failing-logging-tests-when-running-the-tests-in-ipython" title="Permalink to this headline">¶</a></h3>
<p>When running the Astropy tests using <code class="docutils literal notranslate"><span class="pre">astropy.test()</span></code> in an IPython
interpreter, some of the tests in the <code class="docutils literal notranslate"><span class="pre">astropy/tests/test_logger.py</span></code> <em>might</em>
fail depending on the version of IPython or other factors.
This is due to mutually incompatible behaviors in IPython and pytest, and is
not due to a problem with the test itself or the feature being tested.</p>
<p>See: <a class="reference external" href="https://github.com/astropy/astropy/issues/717">https://github.com/astropy/astropy/issues/717</a></p>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Known Issues</a><ul>
<li><a class="reference internal" href="#known-deficiencies">Known Deficiencies</a><ul>
<li><a class="reference internal" href="#quantities-lose-their-units-with-some-operations">Quantities Lose Their Units with Some Operations</a></li>
<li><a class="reference internal" href="#numpy-array-creation-functions-cannot-be-used-to-initialize-quantity">Numpy array creation functions cannot be used to initialize Quantity</a></li>
<li><a class="reference internal" href="#quantities-lose-their-units-when-broadcasted">Quantities Lose Their Units When Broadcasted</a></li>
<li><a class="reference internal" href="#mmap-support-for-astropy-io-fits-on-gnu-hurd">mmap Support for <code class="docutils literal notranslate"><span class="pre">astropy.io.fits</span></code> on GNU Hurd</a></li>
<li><a class="reference internal" href="#color-printing-on-windows">Color Printing on Windows</a></li>
<li><a class="reference internal" href="#numpy-int64-does-not-decompose-input-quantity-objects"><code class="docutils literal notranslate"><span class="pre">numpy.int64</span></code> does not decompose input <code class="docutils literal notranslate"><span class="pre">Quantity</span></code> objects</a></li>
<li><a class="reference internal" href="#inconsistent-behavior-when-converting-complex-numbers-to-floats">Inconsistent behavior when converting complex numbers to floats</a></li>
<li><a class="reference internal" href="#structured-units-deserialization-segfaults-in-big-endian">Structured units deserialization segfaults in big-endian</a></li>
</ul>
</li>
<li><a class="reference internal" href="#build-installation-test-issues">Build/Installation/Test Issues</a><ul>
<li><a class="reference internal" href="#anaconda-users-should-upgrade-with-conda-not-pip">Anaconda Users Should Upgrade with <code class="docutils literal notranslate"><span class="pre">conda</span></code>, Not <code class="docutils literal notranslate"><span class="pre">pip</span></code></a></li>
<li><a class="reference internal" href="#locale-errors-in-macos-x-and-linux">Locale Errors in MacOS X and Linux</a></li>
<li><a class="reference internal" href="#failing-logging-tests-when-running-the-tests-in-ipython">Failing Logging Tests When Running the Tests in IPython</a></li>
</ul>
</li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="_sources/known_issues.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011–2022, The Astropy Developers.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 3.5.4. &nbsp;
    Last built 09 May 2022. <br/>
  </p>
</footer>
  </body>
</html>