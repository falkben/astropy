


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Overplotting markers and artists &#8212; Astropy v5.2.dev96+g04a0cf8bb</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <script type="text/javascript" src="../../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Overlaying coordinate systems" href="overlaying_coordinate_systems.html" />
    <link rel="prev" title="Ticks, tick labels, and grid lines" href="ticks_labels_grid.html" />
  
  <meta name="robots" content="noindex, nofollow">
  
  
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>


  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="overlaying_coordinate_systems.html" title="Overlaying coordinate systems">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="ticks_labels_grid.html" title="Ticks, tick labels, and grid lines">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../../index.html">Astropy v5.2.dev96+g04a0cf8bb</a>
	 &#187;
      </li>
      <li><a href="../index.html" >Data Visualization (<code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.visualization</span></code>)</a> &#187;</li>
      <li><a href="index.html" accesskey="U">Making plots with world coordinates (WCSAxes)</a> &#187;</li>
      
      <li>Overplotting markers and artists</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="overplotting-markers-and-artists">
<h1>Overplotting markers and artists<a class="headerlink" href="#overplotting-markers-and-artists" title="Permalink to this headline">¶</a></h1>
<p>For the example in the following page we start from the example introduced in
<a class="reference internal" href="initializing_axes.html#initialization"><span class="std std-ref">Initializing axes with world coordinates</span></a>.</p>
<div class="section" id="pixel-coordinates">
<h2>Pixel coordinates<a class="headerlink" href="#pixel-coordinates" title="Permalink to this headline">¶</a></h2>
<p>Apart from the handling of the ticks, tick labels, and grid lines, the
<a class="reference internal" href="../../api/astropy.visualization.wcsaxes.WCSAxes.html#astropy.visualization.wcsaxes.WCSAxes" title="astropy.visualization.wcsaxes.WCSAxes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WCSAxes</span></code></a> class behaves like a normal Matplotlib
<code class="docutils literal notranslate"><span class="pre">Axes</span></code> instance, and methods such as
<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.imshow.html#matplotlib.axes.Axes.imshow" title="(in Matplotlib v3.5.2)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">imshow()</span></code></a>,
<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.contour.html#matplotlib.axes.Axes.contour" title="(in Matplotlib v3.5.2)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">contour()</span></code></a>,
<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.plot.html#matplotlib.axes.Axes.plot" title="(in Matplotlib v3.5.2)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">plot()</span></code></a>,
<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.scatter.html#matplotlib.axes.Axes.scatter" title="(in Matplotlib v3.5.2)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">scatter()</span></code></a>, and so on will work and plot the
data in <strong>pixel coordinates</strong> by default.</p>
<p>In the following example, the scatter markers and the rectangle will be plotted
in pixel coordinates:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># The following line makes it so that the zoom level no longer changes,</span>
<span class="c1"># otherwise Matplotlib has a tendency to zoom out when adding overlays.</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_autoscale_on</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>

<span class="c1"># Add a rectangle with bottom left corner at pixel position (30, 50) with a</span>
<span class="c1"># width and height of 60 and 50 pixels respectively.</span>
<span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">Rectangle</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">((</span><span class="mf">30.</span><span class="p">,</span> <span class="mf">50.</span><span class="p">),</span> <span class="mf">60.</span><span class="p">,</span> <span class="mf">50.</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

<span class="c1"># Add three markers at (40, 30), (100, 130), and (130, 60). The facecolor is</span>
<span class="c1"># a transparent white (0.5 is the alpha value).</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="mi">40</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">130</span><span class="p">],</span> <span class="p">[</span><span class="mi">30</span><span class="p">,</span> <span class="mi">130</span><span class="p">,</span> <span class="mi">60</span><span class="p">],</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">))</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../visualization/wcsaxes/overlays-2.png">png</a>, <a class="reference external" href="../../visualization/wcsaxes/overlays-2.svg">svg</a>, <a class="reference external" href="../../visualization/wcsaxes/overlays-2.pdf">pdf</a>)</p>
<div class="figure align-center">
<img alt="../../_images/overlays-2.png" class="plot-directive" src="../../_images/overlays-2.png" />
</div>
</div>
<div class="section" id="world-coordinates">
<h2>World coordinates<a class="headerlink" href="#world-coordinates" title="Permalink to this headline">¶</a></h2>
<p>All such Matplotlib commands allow a <code class="docutils literal notranslate"><span class="pre">transform=</span></code> argument to be passed,
which will transform the input from world to pixel coordinates before it is
passed to Matplotlib and plotted. For instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="o">...</span><span class="p">,</span> <span class="n">transform</span><span class="o">=...</span><span class="p">)</span>
</pre></div>
</div>
<p>will take the values passed to <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.scatter.html#matplotlib.axes.Axes.scatter" title="(in Matplotlib v3.5.2)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">scatter()</span></code></a> and will
transform them using the transformation passed to <code class="docutils literal notranslate"><span class="pre">transform=</span></code>, in order to
end up with the final pixel coordinates.</p>
<p>The <a class="reference internal" href="../../api/astropy.visualization.wcsaxes.WCSAxes.html#astropy.visualization.wcsaxes.WCSAxes" title="astropy.visualization.wcsaxes.WCSAxes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WCSAxes</span></code></a> class includes a <a class="reference internal" href="../../api/astropy.visualization.wcsaxes.WCSAxes.html#astropy.visualization.wcsaxes.WCSAxes.get_transform" title="astropy.visualization.wcsaxes.WCSAxes.get_transform"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_transform()</span></code></a>
method that can be used to get the appropriate transformation object to convert
from various world coordinate systems to the final pixel coordinate system
required by Matplotlib. The <a class="reference internal" href="../../api/astropy.visualization.wcsaxes.WCSAxes.html#astropy.visualization.wcsaxes.WCSAxes.get_transform" title="astropy.visualization.wcsaxes.WCSAxes.get_transform"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_transform()</span></code></a> method can
take a number of different inputs, which are described in this and subsequent
sections. The two simplest inputs to this method are <code class="docutils literal notranslate"><span class="pre">'world'</span></code> and
<code class="docutils literal notranslate"><span class="pre">'pixel'</span></code>.</p>
<p>For example, if your WCS defines an image where the coordinate system consists of an angle in degrees and a wavelength in nanometers, you can do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="mi">34</span><span class="p">],</span> <span class="p">[</span><span class="mf">3.2</span><span class="p">],</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="s1">&#39;world&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>to plot a marker at (34deg, 3.2nm).</p>
<p>Using <code class="docutils literal notranslate"><span class="pre">ax.get_transform('pixel')</span></code> is equivalent to not using any
transformation at all (and things then behave as described in the <a class="reference internal" href="#pixel-coordinates">Pixel
coordinates</a> section).</p>
</div>
<div class="section" id="celestial-coordinates">
<h2>Celestial coordinates<a class="headerlink" href="#celestial-coordinates" title="Permalink to this headline">¶</a></h2>
<p>For the special case where the WCS represents celestial coordinates, a number
of other inputs can be passed to <a class="reference internal" href="../../api/astropy.visualization.wcsaxes.WCSAxes.html#astropy.visualization.wcsaxes.WCSAxes.get_transform" title="astropy.visualization.wcsaxes.WCSAxes.get_transform"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_transform()</span></code></a>. These
are:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">'fk4'</span></code>: B1950 FK4 equatorial coordinates</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'fk5'</span></code>: J2000 FK5 equatorial coordinates</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'icrs'</span></code>: ICRS equatorial coordinates</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">'galactic'</span></code>: Galactic coordinates</p></li>
</ul>
<p>In addition, any valid <a class="reference internal" href="../../coordinates/index.html#module-astropy.coordinates" title="astropy.coordinates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.coordinates</span></code></a> coordinate frame can be passed.</p>
<p>For example, you can add markers with positions defined in the FK5 system using:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="mf">266.78238</span><span class="p">,</span> <span class="o">-</span><span class="mf">28.769255</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="s1">&#39;fk5&#39;</span><span class="p">),</span> <span class="n">s</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span>
           <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../visualization/wcsaxes/overlays-4.png">png</a>, <a class="reference external" href="../../visualization/wcsaxes/overlays-4.svg">svg</a>, <a class="reference external" href="../../visualization/wcsaxes/overlays-4.pdf">pdf</a>)</p>
<div class="figure align-center">
<img alt="../../_images/overlays-4.png" class="plot-directive" src="../../_images/overlays-4.png" />
</div>
<p>In the case of <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.scatter.html#matplotlib.axes.Axes.scatter" title="(in Matplotlib v3.5.2)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">scatter()</span></code></a> and <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.plot.html#matplotlib.axes.Axes.plot" title="(in Matplotlib v3.5.2)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">plot()</span></code></a>, the positions of the center of the markers is transformed, but the markers themselves are drawn in the frame of reference of the image, which means that they will not look distorted.</p>
</div>
<div class="section" id="patches-shapes-lines">
<h2>Patches/shapes/lines<a class="headerlink" href="#patches-shapes-lines" title="Permalink to this headline">¶</a></h2>
<p>Transformations can also be passed to Astropy or Matplotlib patches. For example, we can
use the <a class="reference internal" href="../../api/astropy.visualization.wcsaxes.WCSAxes.html#astropy.visualization.wcsaxes.WCSAxes.get_transform" title="astropy.visualization.wcsaxes.WCSAxes.get_transform"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_transform()</span></code></a> method above to plot a quadrangle
in FK5 equatorial coordinates:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="kn">from</span> <span class="nn">astropy.visualization.wcsaxes</span> <span class="kn">import</span> <span class="n">Quadrangle</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">Quadrangle</span><span class="p">((</span><span class="mf">266.0</span><span class="p">,</span> <span class="o">-</span><span class="mf">28.9</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="mf">0.3</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="mf">0.15</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span>
               <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;green&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
               <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="s1">&#39;fk5&#39;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../visualization/wcsaxes/overlays-6.png">png</a>, <a class="reference external" href="../../visualization/wcsaxes/overlays-6.svg">svg</a>, <a class="reference external" href="../../visualization/wcsaxes/overlays-6.pdf">pdf</a>)</p>
<div class="figure align-center">
<img alt="../../_images/overlays-6.png" class="plot-directive" src="../../_images/overlays-6.png" />
</div>
<p>In this case, the quadrangle will be plotted at FK5 J2000 coordinates (266deg, -28.9deg).
See the <a class="reference internal" href="#quadrangles">Quadrangles</a> section for more information on <a class="reference internal" href="../../api/astropy.visualization.wcsaxes.Quadrangle.html#astropy.visualization.wcsaxes.Quadrangle" title="astropy.visualization.wcsaxes.Quadrangle"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Quadrangle</span></code></a>.</p>
<p>However, it is <strong>very important</strong> to note that while the height will indeed be 0.15 degrees, the width will not strictly represent 0.3 degrees on the sky, but an interval of 0.3 degrees in longitude (which, depending on the latitude, will represent a different angle on the sky).
In other words, if the width and height are set to the same value, the resulting polygon will not be a square.
The same applies to the <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.patches.Circle.html#matplotlib.patches.Circle" title="(in Matplotlib v3.5.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Circle</span></code></a> patch, which will not actually produce a circle:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">Circle</span>

<span class="n">r</span> <span class="o">=</span> <span class="n">Quadrangle</span><span class="p">((</span><span class="mf">266.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">28.9</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="mf">0.3</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="mf">0.3</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span>
               <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;cyan&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
               <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="s1">&#39;fk5&#39;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

<span class="n">c</span> <span class="o">=</span> <span class="n">Circle</span><span class="p">((</span><span class="mf">266.4</span><span class="p">,</span> <span class="o">-</span><span class="mf">29.1</span><span class="p">),</span> <span class="mf">0.15</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
           <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="s1">&#39;fk5&#39;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../visualization/wcsaxes/overlays-7.png">png</a>, <a class="reference external" href="../../visualization/wcsaxes/overlays-7.svg">svg</a>, <a class="reference external" href="../../visualization/wcsaxes/overlays-7.pdf">pdf</a>)</p>
<div class="figure align-center">
<img alt="../../_images/overlays-7.png" class="plot-directive" src="../../_images/overlays-7.png" />
</div>
<div class="admonition important">
<p class="admonition-title">Important</p>
<p>If what you are interested is simply plotting circles around
sources to highlight them, then we recommend using
<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.scatter.html#matplotlib.axes.Axes.scatter" title="(in Matplotlib v3.5.2)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">scatter()</span></code></a>, since for the circular
marker (the default), the circles will be guaranteed to be
circles in the plot, and only the position of the center is
transformed.</p>
<p>To plot ‘true’ spherical circles, see the <a class="reference internal" href="#spherical-patches">Spherical patches</a>
section.</p>
</div>
</div>
<div class="section" id="quadrangles">
<h2>Quadrangles<a class="headerlink" href="#quadrangles" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="../../api/astropy.visualization.wcsaxes.Quadrangle.html#astropy.visualization.wcsaxes.Quadrangle" title="astropy.visualization.wcsaxes.Quadrangle"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Quadrangle</span></code></a> is the recommended patch for plotting a quadrangle, as opposed to Matplotlib’s <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.patches.Rectangle.html#matplotlib.patches.Rectangle" title="(in Matplotlib v3.5.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Rectangle</span></code></a>.
The edges of a quadrangle lie on two lines of constant longitude and two lines of constant latitude (or the equivalent component names in the coordinate frame of interest, such as right ascension and declination).
The edges of <a class="reference internal" href="../../api/astropy.visualization.wcsaxes.Quadrangle.html#astropy.visualization.wcsaxes.Quadrangle" title="astropy.visualization.wcsaxes.Quadrangle"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Quadrangle</span></code></a> will render as curved lines if appropriate for the WCS transformation.
In contrast, <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.patches.Rectangle.html#matplotlib.patches.Rectangle" title="(in Matplotlib v3.5.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Rectangle</span></code></a> will always have straight edges.
Here’s a comparison of the two types of patches for plotting a quadrangle in <a class="reference internal" href="../../api/astropy.coordinates.ICRS.html#astropy.coordinates.ICRS" title="astropy.coordinates.ICRS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ICRS</span></code></a> coordinates on <a class="reference internal" href="../../api/astropy.coordinates.Galactic.html#astropy.coordinates.Galactic" title="astropy.coordinates.Galactic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Galactic</span></code></a> axes:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">Rectangle</span>

<span class="c1"># Set the Galactic axes such that the plot includes the ICRS south pole</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">wcs</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>

<span class="c1"># Overlay the ICRS coordinate grid</span>
<span class="n">overlay</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_coords_overlay</span><span class="p">(</span><span class="s1">&#39;icrs&#39;</span><span class="p">)</span>
<span class="n">overlay</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span> <span class="n">ls</span><span class="o">=</span><span class="s1">&#39;dotted&#39;</span><span class="p">)</span>

<span class="c1"># Add a quadrangle patch (100 degrees by 20 degrees)</span>
<span class="n">q</span> <span class="o">=</span> <span class="n">Quadrangle</span><span class="p">((</span><span class="mi">255</span><span class="p">,</span> <span class="o">-</span><span class="mi">70</span><span class="p">)</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="mi">100</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="mi">20</span><span class="o">*</span><span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span>
               <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Quadrangle&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;blue&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
               <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="s1">&#39;icrs&#39;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">q</span><span class="p">)</span>

<span class="c1"># Add a rectangle patch (100 degrees by 20 degrees)</span>
<span class="n">r</span> <span class="o">=</span> <span class="n">Rectangle</span><span class="p">((</span><span class="mi">255</span><span class="p">,</span> <span class="o">-</span><span class="mi">70</span><span class="p">),</span> <span class="mi">100</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span>
              <span class="n">label</span><span class="o">=</span><span class="s1">&#39;Rectangle&#39;</span><span class="p">,</span> <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;red&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;--&#39;</span><span class="p">,</span>
              <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="s1">&#39;icrs&#39;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s1">&#39;upper right&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../visualization/wcsaxes/overlays-9.png">png</a>, <a class="reference external" href="../../visualization/wcsaxes/overlays-9.svg">svg</a>, <a class="reference external" href="../../visualization/wcsaxes/overlays-9.pdf">pdf</a>)</p>
<div class="figure align-center">
<img alt="../../_images/overlays-9.png" class="plot-directive" src="../../_images/overlays-9.png" />
</div>
</div>
<div class="section" id="contours">
<h2>Contours<a class="headerlink" href="#contours" title="Permalink to this headline">¶</a></h2>
<p>Overplotting contours is also simple using the
<a class="reference internal" href="../../api/astropy.visualization.wcsaxes.WCSAxes.html#astropy.visualization.wcsaxes.WCSAxes.get_transform" title="astropy.visualization.wcsaxes.WCSAxes.get_transform"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_transform()</span></code></a> method. For contours,
<a class="reference internal" href="../../api/astropy.visualization.wcsaxes.WCSAxes.html#astropy.visualization.wcsaxes.WCSAxes.get_transform" title="astropy.visualization.wcsaxes.WCSAxes.get_transform"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_transform()</span></code></a> should be given the WCS of the
image to plot the contours for:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">filename</span> <span class="o">=</span> <span class="n">get_pkg_data_filename</span><span class="p">(</span><span class="s1">&#39;galactic_center/gc_bolocam_gps.fits&#39;</span><span class="p">)</span>
<span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">ax</span><span class="o">.</span><span class="n">contour</span><span class="p">(</span><span class="n">hdu</span><span class="o">.</span><span class="n">data</span><span class="p">,</span> <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="n">WCS</span><span class="p">(</span><span class="n">hdu</span><span class="o">.</span><span class="n">header</span><span class="p">)),</span>
           <span class="n">levels</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">,</span><span class="mi">5</span><span class="p">,</span><span class="mi">6</span><span class="p">],</span> <span class="n">colors</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../visualization/wcsaxes/overlays-11.png">png</a>, <a class="reference external" href="../../visualization/wcsaxes/overlays-11.svg">svg</a>, <a class="reference external" href="../../visualization/wcsaxes/overlays-11.pdf">pdf</a>)</p>
<div class="figure align-center">
<img alt="../../_images/overlays-11.png" class="plot-directive" src="../../_images/overlays-11.png" />
</div>
</div>
<div class="section" id="spherical-patches">
<h2>Spherical patches<a class="headerlink" href="#spherical-patches" title="Permalink to this headline">¶</a></h2>
<p>In the case where you are making a plot of a celestial image, and want to plot a circle that represents the area within a certain angle of a longitude/latitude,
the <a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.patches.Circle.html#matplotlib.patches.Circle" title="(in Matplotlib v3.5.2)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Circle</span></code></a> patch is not appropriate, since it will result in a distorted shape (because longitude is not the same as the angle on the sky).
For this use case, you can instead use <a class="reference internal" href="../../api/astropy.visualization.wcsaxes.SphericalCircle.html#astropy.visualization.wcsaxes.SphericalCircle" title="astropy.visualization.wcsaxes.SphericalCircle"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SphericalCircle</span></code></a>, which takes a tuple of <a class="reference internal" href="../../api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity"><code class="xref py py-class docutils literal notranslate"><span class="pre">Quantity</span></code></a> or a <a class="reference internal" href="../../api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord" title="astropy.coordinates.SkyCoord"><code class="xref py py-class docutils literal notranslate"><span class="pre">SkyCoord</span></code></a> object as the input,
and a <a class="reference internal" href="../../api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity"><code class="xref py py-class docutils literal notranslate"><span class="pre">Quantity</span></code></a> as the radius:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">SkyCoord</span>
<span class="kn">from</span> <span class="nn">astropy.visualization.wcsaxes</span> <span class="kn">import</span> <span class="n">SphericalCircle</span>


<span class="n">r</span> <span class="o">=</span> <span class="n">SphericalCircle</span><span class="p">((</span><span class="mf">266.4</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="o">-</span><span class="mf">29.1</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">),</span> <span class="mf">0.15</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span>
                     <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;yellow&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
                     <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="s1">&#39;fk5&#39;</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">r</span><span class="p">)</span>

<span class="c1">#The following lines show the usage of a SkyCoord object as the input.</span>
<span class="n">skycoord_object</span> <span class="o">=</span> <span class="n">SkyCoord</span><span class="p">(</span><span class="mf">266.4</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="o">-</span><span class="mf">28.7</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">)</span>
<span class="n">s</span> <span class="o">=</span> <span class="n">SphericalCircle</span><span class="p">(</span><span class="n">skycoord_object</span><span class="p">,</span> <span class="mf">0.15</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">degree</span><span class="p">,</span>
                    <span class="n">edgecolor</span><span class="o">=</span><span class="s1">&#39;white&#39;</span><span class="p">,</span> <span class="n">facecolor</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span>
                    <span class="n">transform</span><span class="o">=</span><span class="n">ax</span><span class="o">.</span><span class="n">get_transform</span><span class="p">(</span><span class="s1">&#39;fk5&#39;</span><span class="p">))</span>

<span class="n">ax</span><span class="o">.</span><span class="n">add_patch</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../visualization/wcsaxes/overlays-13.png">png</a>, <a class="reference external" href="../../visualization/wcsaxes/overlays-13.svg">svg</a>, <a class="reference external" href="../../visualization/wcsaxes/overlays-13.pdf">pdf</a>)</p>
<div class="figure align-center">
<img alt="../../_images/overlays-13.png" class="plot-directive" src="../../_images/overlays-13.png" />
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Overplotting markers and artists</a><ul>
<li><a class="reference internal" href="#pixel-coordinates">Pixel coordinates</a></li>
<li><a class="reference internal" href="#world-coordinates">World coordinates</a></li>
<li><a class="reference internal" href="#celestial-coordinates">Celestial coordinates</a></li>
<li><a class="reference internal" href="#patches-shapes-lines">Patches/shapes/lines</a></li>
<li><a class="reference internal" href="#quadrangles">Quadrangles</a></li>
<li><a class="reference internal" href="#contours">Contours</a></li>
<li><a class="reference internal" href="#spherical-patches">Spherical patches</a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../../_sources/visualization/wcsaxes/overlays.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011–2022, The Astropy Developers.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 3.5.4. &nbsp;
    Last built 09 May 2022. <br/>
  </p>
</footer>
  </body>
</html>