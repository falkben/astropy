


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Initializing WCSAxes with custom transforms &#8212; Astropy v5.2.dev96+g04a0cf8bb</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <script type="text/javascript" src="../../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Using a custom frame" href="custom_frames.html" />
    <link rel="prev" title="Controlling Axes" href="controlling_axes.html" />
  
  <meta name="robots" content="noindex, nofollow">
  
  
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>


  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="custom_frames.html" title="Using a custom frame">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="controlling_axes.html" title="Controlling Axes">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../../index.html">Astropy v5.2.dev96+g04a0cf8bb</a>
	 &#187;
      </li>
      <li><a href="../index.html" >Data Visualization (<code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.visualization</span></code>)</a> &#187;</li>
      <li><a href="index.html" accesskey="U">Making plots with world coordinates (WCSAxes)</a> &#187;</li>
      
      <li>Initializing WCSAxes with custom transforms</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="initializing-wcsaxes-with-custom-transforms">
<h1>Initializing WCSAxes with custom transforms<a class="headerlink" href="#initializing-wcsaxes-with-custom-transforms" title="Permalink to this headline">¶</a></h1>
<p>In <a class="reference internal" href="initializing_axes.html#initialization"><span class="std std-ref">Initializing axes with world coordinates</span></a>, we saw how to make plots using
<a class="reference internal" href="../../api/astropy.wcs.WCS.html#astropy.wcs.WCS" title="astropy.wcs.WCS"><code class="xref py py-class docutils literal notranslate"><span class="pre">WCS</span></code></a> objects. However, the
<a class="reference internal" href="../../api/astropy.visualization.wcsaxes.WCSAxes.html#astropy.visualization.wcsaxes.WCSAxes" title="astropy.visualization.wcsaxes.WCSAxes"><code class="xref py py-class docutils literal notranslate"><span class="pre">WCSAxes</span></code></a> class can also be initialized
with more general transformations that don’t have to be represented by the
<a class="reference internal" href="../../api/astropy.wcs.WCS.html#astropy.wcs.WCS" title="astropy.wcs.WCS"><code class="xref py py-class docutils literal notranslate"><span class="pre">WCS</span></code></a> class. Instead, you can initialize
<a class="reference internal" href="../../api/astropy.visualization.wcsaxes.WCSAxes.html#astropy.visualization.wcsaxes.WCSAxes" title="astropy.visualization.wcsaxes.WCSAxes"><code class="xref py py-class docutils literal notranslate"><span class="pre">WCSAxes</span></code></a> using a Matplotlib
<a class="reference external" href="https://matplotlib.org/stable/api/transformations.html#matplotlib.transforms.Transform" title="(in Matplotlib v3.5.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Transform</span></code></a> object and a dictionary
(<code class="docutils literal notranslate"><span class="pre">coord_meta</span></code>) that provides metadata on how to interpret the transformation.</p>
<p>The <a class="reference external" href="https://matplotlib.org/stable/api/transformations.html#matplotlib.transforms.Transform" title="(in Matplotlib v3.5.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Transform</span></code></a> should represent the conversion
from pixel to world coordinates, and should have <code class="docutils literal notranslate"><span class="pre">input_dims=2</span></code> and can have
<code class="docutils literal notranslate"><span class="pre">output_dims</span></code> set to any positive integer. In addition, <code class="docutils literal notranslate"><span class="pre">has_inverse</span></code> should
be set to <a class="reference external" href="https://docs.python.org/3/library/constants.html#True" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">True</span></code></a> and the <code class="docutils literal notranslate"><span class="pre">inverted</span></code> method should be implemented.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">coord_meta</span></code> dictionary should include the following keys:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code>: an iterable of strings giving the names for each dimension</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">type</span></code>: an iterable of strings that should be either <code class="docutils literal notranslate"><span class="pre">'longitude'</span></code>,
<code class="docutils literal notranslate"><span class="pre">'latitude'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'scalar'</span></code> (for anything that isn’t a longitude or latitude).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wrap</span></code>: an iterable of values which indicate for longitudes at which
angle (in degrees) to wrap the coordinates. This should be <a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a> unless
<code class="docutils literal notranslate"><span class="pre">type</span></code> is <code class="docutils literal notranslate"><span class="pre">'longitude'</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">unit</span></code>: an iterable of <a class="reference internal" href="../../api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit"><code class="xref py py-class docutils literal notranslate"><span class="pre">Unit</span></code></a> objects giving the
units of the world coordinates returned by the
<a class="reference external" href="https://matplotlib.org/stable/api/transformations.html#matplotlib.transforms.Transform" title="(in Matplotlib v3.5.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Transform</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">format_unit</span></code>: an iterable of <a class="reference internal" href="../../api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit"><code class="xref py py-class docutils literal notranslate"><span class="pre">Unit</span></code></a> objects
giving the units to use for the formatting of the labels. These can be set to
<a class="reference external" href="https://docs.python.org/3/library/constants.html#None" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">None</span></code></a> to default to the units given in <code class="docutils literal notranslate"><span class="pre">unit</span></code>, but can be set for example
if the <a class="reference external" href="https://matplotlib.org/stable/api/transformations.html#matplotlib.transforms.Transform" title="(in Matplotlib v3.5.2)"><code class="xref py py-class docutils literal notranslate"><span class="pre">Transform</span></code></a> returns values in degrees
and you want the labels to be formatted in hours.</p></li>
</ul>
<p>In addition the <code class="docutils literal notranslate"><span class="pre">coord_meta</span></code> can optionally include the following keys:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">default_axislabel_position</span></code>: an iterable of strings giving for each world
coordinates the spine of the frame on which to show the axis label for the
coordinate. Each string should be such that it could be used as input to
<a class="reference internal" href="../../api/astropy.visualization.wcsaxes.CoordinateHelper.html#astropy.visualization.wcsaxes.CoordinateHelper.set_axislabel_position" title="astropy.visualization.wcsaxes.coordinate_helpers.CoordinateHelper"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_axislabel_position()</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">default_ticklabel_position</span></code>: an iterable of strings giving for each world
coordinates the spine of the frame on which to show the tick labels for the
coordinate. Each string should be such that it could be used as input to
<a class="reference internal" href="../../api/astropy.visualization.wcsaxes.CoordinateHelper.html#astropy.visualization.wcsaxes.CoordinateHelper.set_ticklabel_position" title="astropy.visualization.wcsaxes.coordinate_helpers.CoordinateHelper"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_ticklabel_position()</span></code></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">default_ticks_position</span></code>: an iterable of strings giving for each world
coordinates the spine of the frame on which to show the ticks for the
coordinate. Each string should be such that it could be used as input to
<a class="reference internal" href="../../api/astropy.visualization.wcsaxes.CoordinateHelper.html#astropy.visualization.wcsaxes.CoordinateHelper.set_ticks_position" title="astropy.visualization.wcsaxes.coordinate_helpers.CoordinateHelper"><code class="xref py py-meth docutils literal notranslate"><span class="pre">set_ticks_position()</span></code></a>.</p></li>
</ul>
<p>The following example illustrates a custom projection using a transform and
<code class="docutils literal notranslate"><span class="pre">coord_meta</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib.transforms</span> <span class="kn">import</span> <span class="n">Affine2D</span>
<span class="kn">from</span> <span class="nn">astropy.visualization.wcsaxes</span> <span class="kn">import</span> <span class="n">WCSAxes</span>

<span class="c1"># Set up an affine transformation</span>
<span class="n">transform</span> <span class="o">=</span> <span class="n">Affine2D</span><span class="p">()</span>
<span class="n">transform</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="mf">0.01</span><span class="p">)</span>
<span class="n">transform</span><span class="o">.</span><span class="n">translate</span><span class="p">(</span><span class="mi">40</span><span class="p">,</span> <span class="o">-</span><span class="mi">30</span><span class="p">)</span>
<span class="n">transform</span><span class="o">.</span><span class="n">rotate</span><span class="p">(</span><span class="mf">0.3</span><span class="p">)</span>  <span class="c1"># radians</span>

<span class="c1"># Set up metadata dictionary</span>
<span class="n">coord_meta</span> <span class="o">=</span> <span class="p">{}</span>
<span class="n">coord_meta</span><span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="s1">&#39;lat&#39;</span>
<span class="n">coord_meta</span><span class="p">[</span><span class="s1">&#39;type&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;longitude&#39;</span><span class="p">,</span> <span class="s1">&#39;latitude&#39;</span>
<span class="n">coord_meta</span><span class="p">[</span><span class="s1">&#39;wrap&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">180</span><span class="p">,</span> <span class="kc">None</span>
<span class="n">coord_meta</span><span class="p">[</span><span class="s1">&#39;unit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span><span class="p">,</span> <span class="n">u</span><span class="o">.</span><span class="n">deg</span>
<span class="n">coord_meta</span><span class="p">[</span><span class="s1">&#39;format_unit&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">WCSAxes</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span> <span class="n">aspect</span><span class="o">=</span><span class="s1">&#39;equal&#39;</span><span class="p">,</span>
             <span class="n">transform</span><span class="o">=</span><span class="n">transform</span><span class="p">,</span> <span class="n">coord_meta</span><span class="o">=</span><span class="n">coord_meta</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">ax</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xlim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">499.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">399.5</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">grid</span><span class="p">()</span>
<span class="n">ax</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;lon&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_axislabel</span><span class="p">(</span><span class="s1">&#39;Longitude&#39;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="s1">&#39;lat&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">set_axislabel</span><span class="p">(</span><span class="s1">&#39;Latitude&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../visualization/wcsaxes/generic_transforms-1.png">png</a>, <a class="reference external" href="../../visualization/wcsaxes/generic_transforms-1.svg">svg</a>, <a class="reference external" href="../../visualization/wcsaxes/generic_transforms-1.pdf">pdf</a>)</p>
<div class="figure align-center">
<img alt="../../_images/generic_transforms-1.png" class="plot-directive" src="../../_images/generic_transforms-1.png" />
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Initializing WCSAxes with custom transforms</a></li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../../_sources/visualization/wcsaxes/generic_transforms.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011–2022, The Astropy Developers.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 3.5.4. &nbsp;
    Last built 09 May 2022. <br/>
  </p>
</footer>
  </body>
</html>