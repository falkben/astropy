


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Slicing Multidimensional Data &#8212; Astropy v5.2.dev104+gcdd6a1f81.d20220509</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <script type="text/javascript" src="../../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Controlling Axes" href="controlling_axes.html" />
    <link rel="prev" title="Overlaying coordinate systems" href="overlaying_coordinate_systems.html" />
  
  <meta name="robots" content="noindex, nofollow">
  
  
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>


  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="controlling_axes.html" title="Controlling Axes">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="overlaying_coordinate_systems.html" title="Overlaying coordinate systems">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../../index.html">Astropy v5.2.dev104+gcdd6a1f81.d20220509</a>
	 &#187;
      </li>
      <li><a href="../index.html" >Data Visualization (<code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.visualization</span></code>)</a> &#187;</li>
      <li><a href="index.html" accesskey="U">Making plots with world coordinates (WCSAxes)</a> &#187;</li>
      
      <li>Slicing Multidimensional Data</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="slicing-multidimensional-data">
<h1>Slicing Multidimensional Data<a class="headerlink" href="#slicing-multidimensional-data" title="Permalink to this headline">¶</a></h1>
<p>WCSAxes can either plot one or two dimensional data. If we have a dataset with
higher dimensionality than the plot we want to make, we have to select which
dimensions to use for the x or x and y axes of the plot. This example will show
how to slice a FITS data cube and plot an image from it.</p>
<div class="section" id="slicing-the-wcs-object">
<h2>Slicing the WCS object<a class="headerlink" href="#slicing-the-wcs-object" title="Permalink to this headline">¶</a></h2>
<p>Like the example introduced in <a class="reference internal" href="initializing_axes.html#initialization"><span class="std std-ref">Initializing axes with world coordinates</span></a>, we will read in the
data using <a class="reference external" href="https://docs.astropy.org/en/stable/io/fits/index.html">astropy.io.fits</a> and parse the WCS
information. The original FITS file can be downloaded from <a class="reference external" href="http://www.astropy.org/astropy-data/l1448/l1448_13co.fits">here</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">astropy.wcs</span> <span class="kn">import</span> <span class="n">WCS</span>
<span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="kn">from</span> <span class="nn">astropy.utils.data</span> <span class="kn">import</span> <span class="n">get_pkg_data_filename</span>
<span class="n">filename</span> <span class="o">=</span> <span class="n">get_pkg_data_filename</span><span class="p">(</span><span class="s1">&#39;l1448/l1448_13co.fits&#39;</span><span class="p">)</span>
<span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">wcs</span> <span class="o">=</span> <span class="n">WCS</span><span class="p">(</span><span class="n">hdu</span><span class="o">.</span><span class="n">header</span><span class="p">)</span>
<span class="n">image_data</span> <span class="o">=</span> <span class="n">hdu</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
<p>This is a three-dimensional dataset which you can check by looking at the
header information by:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hdu</span><span class="o">.</span><span class="n">header</span>  
<span class="gp">...</span>
<span class="go">NAXIS = 3 /number of axes</span>
<span class="go">CTYPE1  = &#39;RA---SFL&#39;           /</span>
<span class="go">CTYPE2  = &#39;DEC--SFL&#39;           /</span>
<span class="go">CTYPE3  = &#39;VELO-LSR&#39;           /</span>
<span class="gp">...</span>
</pre></div>
</div>
<p>The header keyword ‘NAXIS’ gives the number of dimensions of the dataset. The keywords ‘CTYPE1’, ‘CTYPE2’ and ‘CTYPE3’ give the data type of these dimensions to be right ascension, declination and velocity respectively.</p>
<p>We then instantiate the <a class="reference internal" href="../../api/astropy.visualization.wcsaxes.WCSAxes.html#astropy.visualization.wcsaxes.WCSAxes" title="astropy.visualization.wcsaxes.WCSAxes"><code class="xref py py-obj docutils literal notranslate"><span class="pre">WCSAxes</span></code></a> using the
<a class="reference internal" href="../../api/astropy.wcs.WCS.html#astropy.wcs.WCS" title="astropy.wcs.WCS"><code class="xref py py-class docutils literal notranslate"><span class="pre">WCS</span></code></a> object and select the slices we want to plot:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">wcs</span><span class="p">,</span> <span class="n">slices</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>By setting <code class="docutils literal notranslate"><span class="pre">slices=(50,</span> <span class="pre">'y',</span> <span class="pre">'x')</span></code>, we have chosen to plot the second
dimension on the y-axis and the third dimension on the x-axis. Even though we
are not plotting the all the dimensions, we have to specify which slices to
select for the dimensions that are not shown. In this example, we are not
plotting the first dimension so we have selected the slice 50 to display. You
can experiment with this by changing the selected slice and looking at how the
plotted image changes.</p>
</div>
<div class="section" id="plotting-the-image">
<h2>Plotting the image<a class="headerlink" href="#plotting-the-image" title="Permalink to this headline">¶</a></h2>
<p>We then add the axes to the image and plot it using the method
<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.imshow.html#matplotlib.axes.Axes.imshow" title="(in Matplotlib v3.5.2)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">imshow()</span></code></a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span><span class="o">.</span><span class="n">coords</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ticklabel</span><span class="p">(</span><span class="n">exclude_overlapping</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image_data</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">50</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">())</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../visualization/wcsaxes/slicing_datacubes-3.png">png</a>, <a class="reference external" href="../../visualization/wcsaxes/slicing_datacubes-3.svg">svg</a>, <a class="reference external" href="../../visualization/wcsaxes/slicing_datacubes-3.pdf">pdf</a>)</p>
<div class="figure align-center">
<img alt="../../_images/slicing_datacubes-3.png" class="plot-directive" src="../../_images/slicing_datacubes-3.png" />
</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">image_data</span></code> is an <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-class docutils literal notranslate"><span class="pre">ndarray</span></code></a> object. In Numpy, the order
of the axes is reversed so the first dimension in the FITS file appears last,
the last dimension appears first and so on. Therefore the index passed to
<a class="reference external" href="https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.imshow.html#matplotlib.axes.Axes.imshow" title="(in Matplotlib v3.5.2)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">imshow()</span></code></a> should be the same as passed to
<code class="docutils literal notranslate"><span class="pre">slices</span></code> but in reversed order. We also need to
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.transpose.html#numpy.ndarray.transpose" title="(in NumPy v1.22)"><code class="xref py py-meth docutils literal notranslate"><span class="pre">transpose()</span></code></a> <code class="docutils literal notranslate"><span class="pre">image_data</span></code> as we have reversed the
dimensions plotted on the x and y axes in the slice.</p>
<p>If we don’t want to reverse the dimensions plotted, we can simply do:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">wcs</span><span class="p">,</span> <span class="n">slices</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">image_data</span><span class="p">[:,</span> <span class="p">:,</span> <span class="mi">50</span><span class="p">])</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../visualization/wcsaxes/slicing_datacubes-5.png">png</a>, <a class="reference external" href="../../visualization/wcsaxes/slicing_datacubes-5.svg">svg</a>, <a class="reference external" href="../../visualization/wcsaxes/slicing_datacubes-5.pdf">pdf</a>)</p>
<div class="figure align-center">
<img alt="../../_images/slicing_datacubes-5.png" class="plot-directive" src="../../_images/slicing_datacubes-5.png" />
</div>
</div>
<div class="section" id="plotting-one-dimensional-data">
<h2>Plotting one dimensional data<a class="headerlink" href="#plotting-one-dimensional-data" title="Permalink to this headline">¶</a></h2>
<p>If we wanted to plot the spectral axes for one pixel we can do this by slicing
down to one dimension.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">wcs</span><span class="p">,</span> <span class="n">slices</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">))</span>
</pre></div>
</div>
<p>Here we have selected the 50 pixel in the first and second dimensions and will
use the third dimension as our x axis.</p>
<p>We can now plot the spectral axis for this pixel. Note that we are plotting
against pixel coordinates in the call to <code class="docutils literal notranslate"><span class="pre">ax.plot</span></code>, <code class="docutils literal notranslate"><span class="pre">WCSAxes</span></code> will display
the world coordinates for us.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">image_data</span><span class="p">[:,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">50</span><span class="p">])</span>
</pre></div>
</div>
<p>As this is still a <code class="docutils literal notranslate"><span class="pre">WCSAxes</span></code> plot, we can set the display units for the x-axis</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">vel</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">coords</span>
<span class="n">vel</span><span class="o">.</span><span class="n">set_format_unit</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">km</span><span class="o">/</span><span class="n">u</span><span class="o">.</span><span class="n">s</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../visualization/wcsaxes/slicing_datacubes-8.png">png</a>, <a class="reference external" href="../../visualization/wcsaxes/slicing_datacubes-8.svg">svg</a>, <a class="reference external" href="../../visualization/wcsaxes/slicing_datacubes-8.pdf">pdf</a>)</p>
<div class="figure align-center">
<img alt="../../_images/slicing_datacubes-8.png" class="plot-directive" src="../../_images/slicing_datacubes-8.png" />
</div>
<p>If we wanted to plot a one dimensional plot along a spatial dimension, i.e.
intensity along a row in the image, <code class="docutils literal notranslate"><span class="pre">WCSAxes</span></code> defaults to displaying both the
world coordinates for this plot. We can customise the colors and add grid lines
for each of the spatial axes.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="n">wcs</span><span class="p">,</span> <span class="n">slices</span><span class="o">=</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">image_data</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="p">:,</span> <span class="mi">50</span><span class="p">])</span>

<span class="n">ra</span><span class="p">,</span> <span class="n">dec</span><span class="p">,</span> <span class="n">wave</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">coords</span>
<span class="n">ra</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">ra</span><span class="o">.</span><span class="n">set_ticklabel</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">ra</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>

<span class="n">dec</span><span class="o">.</span><span class="n">set_ticks</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">dec</span><span class="o">.</span><span class="n">set_ticklabel</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
<span class="n">dec</span><span class="o">.</span><span class="n">grid</span><span class="p">(</span><span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../../visualization/wcsaxes/slicing_datacubes-10.png">png</a>, <a class="reference external" href="../../visualization/wcsaxes/slicing_datacubes-10.svg">svg</a>, <a class="reference external" href="../../visualization/wcsaxes/slicing_datacubes-10.pdf">pdf</a>)</p>
<div class="figure align-center">
<img alt="../../_images/slicing_datacubes-10.png" class="plot-directive" src="../../_images/slicing_datacubes-10.png" />
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Slicing Multidimensional Data</a><ul>
<li><a class="reference internal" href="#slicing-the-wcs-object">Slicing the WCS object</a></li>
<li><a class="reference internal" href="#plotting-the-image">Plotting the image</a></li>
<li><a class="reference internal" href="#plotting-one-dimensional-data">Plotting one dimensional data</a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../../_sources/visualization/wcsaxes/slicing_datacubes.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011–2022, The Astropy Developers.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 3.5.4. &nbsp;
    Last built 09 May 2022. <br/>
  </p>
</footer>
  </body>
</html>