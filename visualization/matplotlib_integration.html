


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Plotting Astropy objects in Matplotlib &#8212; Astropy v5.2.dev104+gcdd6a1f81.d20220509</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Making plots with world coordinates (WCSAxes)" href="wcsaxes/index.html" />
    <link rel="prev" title="Data Visualization (astropy.visualization)" href="index.html" />
  
  <meta name="robots" content="noindex, nofollow">
  
  
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>


  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="wcsaxes/index.html" title="Making plots with world coordinates (WCSAxes)">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="index.html" title="Data Visualization (astropy.visualization)">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">Astropy v5.2.dev104+gcdd6a1f81.d20220509</a>
	 &#187;
      </li>
      <li><a href="index.html" accesskey="U">Data Visualization (<code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.visualization</span></code>)</a> &#187;</li>
      
      <li>Plotting Astropy objects in Matplotlib</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="plotting-astropy-objects-in-matplotlib">
<h1>Plotting Astropy objects in Matplotlib<a class="headerlink" href="#plotting-astropy-objects-in-matplotlib" title="Permalink to this headline">¶</a></h1>
<div class="section" id="plotting-quantities">
<span id="id1"></span><h2>Plotting quantities<a class="headerlink" href="#plotting-quantities" title="Permalink to this headline">¶</a></h2>
<p><a class="reference internal" href="../api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity"><code class="xref py py-class docutils literal notranslate"><span class="pre">Quantity</span></code></a> objects can be conveniently plotted using matplotlib.  This
feature needs to be explicitly turned on:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.visualization</span> <span class="kn">import</span> <span class="n">quantity_support</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">quantity_support</span><span class="p">()</span>  
<span class="go">&lt;astropy.visualization.units.MplQuantityConverter ...&gt;</span>
</pre></div>
</div>
<p>Then <a class="reference internal" href="../api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity"><code class="xref py py-class docutils literal notranslate"><span class="pre">Quantity</span></code></a> objects can be passed to matplotlib plotting
functions.  The axis labels are automatically labeled with the unit of
the quantity:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">astropy</span> <span class="kn">import</span> <span class="n">units</span> <span class="k">as</span> <span class="n">u</span>
<span class="kn">from</span> <span class="nn">astropy.visualization</span> <span class="kn">import</span> <span class="n">quantity_support</span>
<span class="n">quantity_support</span><span class="p">()</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../visualization/matplotlib_integration-1.png">png</a>, <a class="reference external" href="../visualization/matplotlib_integration-1.svg">svg</a>, <a class="reference external" href="../visualization/matplotlib_integration-1.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="../_images/matplotlib_integration-1.png" class="plot-directive" src="../_images/matplotlib_integration-1.png" />
</div>
<p>Quantities are automatically converted to the first unit set on a
particular axis, so in the following, the y-axis remains in <code class="docutils literal notranslate"><span class="pre">m</span></code> even
though the second line is given in <code class="docutils literal notranslate"><span class="pre">cm</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">cm</span><span class="p">)</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../visualization/matplotlib_integration-2.png">png</a>, <a class="reference external" href="../visualization/matplotlib_integration-2.svg">svg</a>, <a class="reference external" href="../visualization/matplotlib_integration-2.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="../_images/matplotlib_integration-2.png" class="plot-directive" src="../_images/matplotlib_integration-2.png" />
</div>
<p>Plotting a quantity with an incompatible unit will raise an exception.
For example, calling <code class="docutils literal notranslate"><span class="pre">plt.plot([1,</span> <span class="pre">2,</span> <span class="pre">3]</span> <span class="pre">*</span> <span class="pre">u.kg)</span></code> (mass unit) to overplot
on the plot above that is displaying length units.</p>
<p>To make sure unit support is turned off afterward, you can use
<a class="reference internal" href="../api/astropy.visualization.quantity_support.html#astropy.visualization.quantity_support" title="astropy.visualization.quantity_support"><code class="xref py py-obj docutils literal notranslate"><span class="pre">quantity_support</span></code></a> with a <code class="docutils literal notranslate"><span class="pre">with</span></code> statement:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">quantity_support</span><span class="p">():</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]</span> <span class="o">*</span> <span class="n">u</span><span class="o">.</span><span class="n">m</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="plotting-times">
<span id="id2"></span><h2>Plotting times<a class="headerlink" href="#plotting-times" title="Permalink to this headline">¶</a></h2>
<p>Matplotlib natively provides a mechanism for plotting dates and times on one
or both of the axes, as described in
<a class="reference external" href="https://matplotlib.org/stable/gallery/text_labels_and_annotations/date.html">Date tick labels</a>.
To make use of this, you can use the <code class="docutils literal notranslate"><span class="pre">plot_date</span></code> attribute of <a class="reference internal" href="../api/astropy.time.Time.html#astropy.time.Time" title="astropy.time.Time"><code class="xref py py-class docutils literal notranslate"><span class="pre">Time</span></code></a> to get
values in the time system used by Matplotlib.</p>
<p>However, in many cases, you will probably want to have more control over the
precise scale and format to use for the tick labels, in which case you can make
use of the <a class="reference internal" href="../api/astropy.visualization.time_support.html#astropy.visualization.time_support" title="astropy.visualization.time_support"><code class="xref py py-obj docutils literal notranslate"><span class="pre">time_support</span></code></a> function. This feature needs to
be explicitly turned on:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.visualization</span> <span class="kn">import</span> <span class="n">time_support</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time_support</span><span class="p">()</span>  
<span class="go">&lt;astropy.visualization.units.MplTimeConverter ...&gt;</span>
</pre></div>
</div>
<p>Once this is enabled, <a class="reference internal" href="../api/astropy.time.Time.html#astropy.time.Time" title="astropy.time.Time"><code class="xref py py-class docutils literal notranslate"><span class="pre">Time</span></code></a> objects can be passed to matplotlib plotting
functions. The axis labels are then automatically labeled with times formatted
using the <a class="reference internal" href="../api/astropy.time.Time.html#astropy.time.Time" title="astropy.time.Time"><code class="xref py py-class docutils literal notranslate"><span class="pre">Time</span></code></a> class:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">astropy.time</span> <span class="kn">import</span> <span class="n">Time</span>
<span class="kn">from</span> <span class="nn">astropy.visualization</span> <span class="kn">import</span> <span class="n">time_support</span>

<span class="n">time_support</span><span class="p">()</span>

<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Time</span><span class="p">([</span><span class="mi">58000</span><span class="p">,</span> <span class="mi">59000</span><span class="p">,</span> <span class="mi">62000</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;mjd&#39;</span><span class="p">),</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">3.3</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">])</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../visualization/matplotlib_integration-3.png">png</a>, <a class="reference external" href="../visualization/matplotlib_integration-3.svg">svg</a>, <a class="reference external" href="../visualization/matplotlib_integration-3.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="../_images/matplotlib_integration-3.png" class="plot-directive" src="../_images/matplotlib_integration-3.png" />
</div>
<p>By default, the format and scale used for the plots is taken from the first time
that Matplotlib encounters for a particular Axes instance. The format and scale
can also be explicitly controlled by passing arguments to <code class="docutils literal notranslate"><span class="pre">time_support</span></code>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">time_support</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;mjd&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;tai&#39;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
<span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Time</span><span class="p">([</span><span class="mi">50000</span><span class="p">,</span> <span class="mi">52000</span><span class="p">,</span> <span class="mi">54000</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;mjd&#39;</span><span class="p">),</span> <span class="p">[</span><span class="mf">1.2</span><span class="p">,</span> <span class="mf">3.3</span><span class="p">,</span> <span class="mf">2.3</span><span class="p">])</span>
</pre></div>
</div>
<p>(<a class="reference external" href="../visualization/matplotlib_integration-5.png">png</a>, <a class="reference external" href="../visualization/matplotlib_integration-5.svg">svg</a>, <a class="reference external" href="../visualization/matplotlib_integration-5.pdf">pdf</a>)</p>
<div class="figure align-default">
<img alt="../_images/matplotlib_integration-5.png" class="plot-directive" src="../_images/matplotlib_integration-5.png" />
</div>
<p>To make sure support for plotting times is turned off afterward, you can use
<a class="reference internal" href="../api/astropy.visualization.time_support.html#astropy.visualization.time_support" title="astropy.visualization.time_support"><code class="xref py py-obj docutils literal notranslate"><span class="pre">time_support</span></code></a> as a context manager:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">time_support</span><span class="p">(</span><span class="nb">format</span><span class="o">=</span><span class="s1">&#39;mjd&#39;</span><span class="p">,</span> <span class="n">scale</span><span class="o">=</span><span class="s1">&#39;tai&#39;</span><span class="p">):</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">))</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">Time</span><span class="p">([</span><span class="mi">50000</span><span class="p">,</span> <span class="mi">52000</span><span class="p">,</span> <span class="mi">54000</span><span class="p">],</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;mjd&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Plotting Astropy objects in Matplotlib</a><ul>
<li><a class="reference internal" href="#plotting-quantities">Plotting quantities</a></li>
<li><a class="reference internal" href="#plotting-times">Plotting times</a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/visualization/matplotlib_integration.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011–2022, The Astropy Developers.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 3.5.4. &nbsp;
    Last built 09 May 2022. <br/>
  </p>
</footer>
  </body>
</html>