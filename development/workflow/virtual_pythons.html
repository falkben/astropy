


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Python virtual environments &#8212; Astropy v5.2.dev96+g04a0cf8bb</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <script type="text/javascript" src="../../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
  
  <meta name="robots" content="noindex, nofollow">
  
  
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>


  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li>
	<a href="../../index.html">Astropy v5.2.dev96+g04a0cf8bb</a>
	 &#187;
      </li>
      
       
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="python-virtual-environments">
<span id="virtual-envs"></span><h1>Python virtual environments<a class="headerlink" href="#python-virtual-environments" title="Permalink to this headline">¶</a></h1>
<p>If you plan to do regular work on Astropy you should do your development in
a Python virtual environment. Conceptually a virtual environment is a
duplicate of the Python environment you normally work in, but sandboxed from
your default Python environment in the sense that packages installed in the
virtual environment do not affect your normal working environment in any way.
This allows you to install, for example, a development version of Astropy
and its dependencies without it conflicting with your day-to-day work with
Astropy and other Python packages.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>“Default Python environment” here means whatever Python you are using
when you log in; i.e. the default Python installation on your system,
which is not in a Conda environment or virtualenv.</p>
<p>More specifically, in UNIX-like platforms it creates a parallel root
“prefix” with its own <code class="docutils literal notranslate"><span class="pre">bin/</span></code>, <code class="docutils literal notranslate"><span class="pre">lib/</span></code>, etc. directories.  When you
<a class="reference internal" href="#activate-env"><span class="std std-ref">activate</span></a> the virtual environment it places this
<code class="docutils literal notranslate"><span class="pre">bin/</span></code> at the head of your <code class="docutils literal notranslate"><span class="pre">$PATH</span></code> environment variable.</p>
<p>This works similarly on Windows but the details depend on how you
installed Python and whether or not you’re using Anaconda.</p>
</div>
<p>There are a few options for using virtual environments; the choice of method
is dictated by the Python distribution you use:</p>
<ul class="simple">
<li><p>If you use the Anaconda/Conda Python distribution you must use the
<a class="reference external" href="https://conda.io/docs/">conda</a> command to make and manage your virtual environments.</p></li>
<li><p>If you do not use Anaconda you can use <a class="reference external" href="https://pypi.org/project/virtualenv">virtualenv</a> and the conda-like
helper commands provided by <a class="reference external" href="https://pypi.org/project/virtualenvwrapper">virtualenvwrapper</a>; you <em>can not</em> use this
with <a class="reference external" href="https://conda.io/docs/">conda</a>. As the name suggests, <a class="reference external" href="https://pypi.org/project/virtualenvwrapper">virtualenvwrapper</a> is a wrapper
around <a class="reference external" href="https://pypi.org/project/virtualenv">virtualenv</a>.</p></li>
<li><p>A third, more recent option which is growing in popularity is <a class="reference external" href="https://pipenv.pypa.io/en/latest/">pipenv</a>
which builds on top of <a class="reference external" href="https://pypi.org/project/virtualenv">virtualenv</a> to provide project-specific Python
environments and dependency management.</p></li>
</ul>
<p>In both cases you will go through the same basic steps; the commands to
accomplish each step are given for both <a class="reference external" href="https://conda.io/docs/">conda</a> and <a class="reference external" href="https://pypi.org/project/virtualenvwrapper">virtualenvwrapper</a>:</p>
<ul class="simple">
<li><p><a class="reference internal" href="#setup-for-env"><span class="std std-ref">Set up for virtual environments</span></a></p></li>
<li><p><a class="reference internal" href="#list-env"><span class="std std-ref">List virtual environments</span></a></p></li>
<li><p><a class="reference internal" href="#create-env"><span class="std std-ref">Create a new virtual environment</span></a></p></li>
<li><p><a class="reference internal" href="#activate-env"><span class="std std-ref">Activate a virtual environment</span></a></p></li>
<li><p><a class="reference internal" href="#deactivate-env"><span class="std std-ref">Deactivate a virtual environment</span></a></p></li>
<li><p><a class="reference internal" href="#delete-env"><span class="std std-ref">Delete a virtual environment</span></a></p></li>
</ul>
<p>Another well-maintained guide to Python virtualenvs (specifically <a class="reference external" href="https://pipenv.pypa.io/en/latest/">pipenv</a>
and <a class="reference external" href="https://pypi.org/project/virtualenv">virtualenv</a>, though it does not discuss <a class="reference external" href="https://conda.io/docs/">conda</a>) which has been
translated into multiple languages is the <a class="reference external" href="https://docs.python-guide.org/dev/virtualenvs/">Hitchhiker’s Guide to Python</a> chapter on the subject.</p>
<div class="section" id="set-up-for-virtual-environments">
<span id="setup-for-env"></span><h2>Set up for virtual environments<a class="headerlink" href="#set-up-for-virtual-environments" title="Permalink to this headline">¶</a></h2>
<ul>
<li><p><a class="reference external" href="https://pypi.org/project/virtualenvwrapper">virtualenvwrapper</a>:</p>
<ul>
<li><p>First, install <a class="reference external" href="https://pypi.org/project/virtualenvwrapper">virtualenvwrapper</a>, which will also install <a class="reference external" href="https://pypi.org/project/virtualenv">virtualenv</a>,
with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">user</span> <span class="n">virtualenvwrapper</span>
</pre></div>
</div>
</li>
<li><p>From the <a class="reference external" href="https://virtualenvwrapper.readthedocs.io/en/latest/install.html">documentation for virtualenvwrapper</a>, you also need to:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>export WORKON_HOME=$HOME/.virtualenvs
export PROJECT_HOME=$HOME/
source /usr/local/bin/virtualenvwrapper.sh
</pre></div>
</div>
</li>
</ul>
</li>
<li><p><a class="reference external" href="https://conda.io/docs/">conda</a>: No setup is necessary beyond installing the Anaconda Python
distribution.</p></li>
<li><p><a class="reference external" href="https://pipenv.pypa.io/en/latest/">pipenv</a>: Install the <code class="docutils literal notranslate"><span class="pre">pipenv</span></code> command using your default pip (the
pip in the default Python environment):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pip</span> <span class="n">install</span> <span class="o">--</span><span class="n">user</span> <span class="n">pipenv</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="list-virtual-environments">
<span id="list-env"></span><h2>List virtual environments<a class="headerlink" href="#list-virtual-environments" title="Permalink to this headline">¶</a></h2>
<p>You do not need to list the virtual environments you have created before using
them…but sooner or later you will forget what environments you have defined
and this is the easy way to find out.</p>
<ul class="simple">
<li><dl class="simple">
<dt><a class="reference external" href="https://pypi.org/project/virtualenvwrapper">virtualenvwrapper</a>: <code class="docutils literal notranslate"><span class="pre">workon</span></code></dt><dd><ul>
<li><p>If this displays nothing you have no virtual environments</p></li>
<li><p>If this displays <code class="docutils literal notranslate"><span class="pre">workon:</span> <span class="pre">command</span> <span class="pre">not</span> <span class="pre">found</span></code> then you haven’t done
the <a class="reference internal" href="#setup-for-env"><span class="std std-ref">Set up for virtual environments</span></a>; do that.</p></li>
<li><p>For more detailed information about installed environments use
<code class="docutils literal notranslate"><span class="pre">lsvirtualenv</span></code>.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl class="simple">
<dt><a class="reference external" href="https://conda.io/docs/">conda</a>: <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">info</span> <span class="pre">-e</span></code></dt><dd><ul>
<li><p>you will always have at least one environment, called <code class="docutils literal notranslate"><span class="pre">root</span></code></p></li>
<li><p>your active environment is indicated by a <code class="docutils literal notranslate"><span class="pre">*</span></code></p></li>
</ul>
</dd>
</dl>
</li>
<li><p><a class="reference external" href="https://pipenv.pypa.io/en/latest/">pipenv</a> does not have a concept of listing virtualenvs; it instead
automatically generates the virtualenv associated with a project directory
(e.g. the Astropy source repository on your computer).</p></li>
</ul>
</div>
<div class="section" id="create-a-new-virtual-environment">
<span id="create-env"></span><h2>Create a new virtual environment<a class="headerlink" href="#create-a-new-virtual-environment" title="Permalink to this headline">¶</a></h2>
<p>This needs to be done once for each virtual environment you want. There is one
important choice you need to make when you create a virtual environment:
which, if any, of the packages installed in your default Python environment do
you want in your virtual environment?</p>
<p>Including them in your virtual environment doesn’t take much extra space–they
are linked into the virtual environment instead of being copied. Within the
virtual environment you can install new versions of packages like Numpy or
Astropy that override the versions installed in your default Python environment.</p>
<p>The easiest way to get started is to include in your virtual environment the
packages installed in your your default Python environment; the instructions
below do that.</p>
<p>In everything that follows, <code class="docutils literal notranslate"><span class="pre">ENV</span></code> represents the name you give your virtual
environment.</p>
<p><strong>The name you choose cannot have spaces in it.</strong></p>
<ul>
<li><dl>
<dt><a class="reference external" href="https://pypi.org/project/virtualenvwrapper">virtualenvwrapper</a>:</dt><dd><ul>
<li><p>Make an environment called <code class="docutils literal notranslate"><span class="pre">ENV</span></code> with all of the packages in your
default Python environment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">mkvirtualenv</span> <span class="o">--</span><span class="n">system</span><span class="o">-</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span> <span class="n">ENV</span>
</pre></div>
</div>
</li>
<li><p>Omit the option <code class="docutils literal notranslate"><span class="pre">--system-site-packages</span></code> to create an environment
without the Python packages installed in your default Python environment.</p></li>
<li><p>Environments created with <a class="reference external" href="https://pypi.org/project/virtualenvwrapper">virtualenvwrapper</a> always include <a class="reference external" href="https://pip.pypa.io">pip</a>
and <a class="reference external" href="https://setuptools.readthedocs.io">setuptools</a> so that you
can install packages within the virtual environment.</p></li>
<li><p>More details and examples are in the
<a class="reference external" href="https://virtualenvwrapper.readthedocs.io/en/latest/command_ref.html">virtualenvwrapper command documentation</a>.</p></li>
</ul>
</dd>
</dl>
</li>
<li><dl>
<dt><a class="reference external" href="https://conda.io/docs/">conda</a>:</dt><dd><ul>
<li><p>Make an environment called <code class="docutils literal notranslate"><span class="pre">ENV</span></code> with all of the packages in your main
Anaconda environment:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">create</span> <span class="o">-</span><span class="n">n</span> <span class="n">ENV</span> <span class="n">anaconda</span>
</pre></div>
</div>
</li>
<li><p>More details, and examples that start with none of the packages from
your default Python environment, are in the
<a class="reference external" href="https://docs.conda.io/projects/conda/en/latest/commands.html">documentation for the conda command</a> and the
<a class="reference external" href="https://docs.conda.io/projects/conda/en/latest/user-guide/tasks/manage-environments.html">guide on how to manage environments</a>.</p></li>
<li><p>Next activate the environment <code class="docutils literal notranslate"><span class="pre">ENV</span></code> with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">activate</span> <span class="n">ENV</span>
</pre></div>
</div>
</li>
<li><p>Your command-line prompt will contain <code class="docutils literal notranslate"><span class="pre">ENV</span></code> in parentheses by default.</p></li>
<li><p>If Astropy is installed in your <code class="docutils literal notranslate"><span class="pre">ENV</span></code> environment, you may need to uninstall it
in order for the development version to install properly. You can do this
with the following command:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">uninstall</span> <span class="n">astropy</span>
</pre></div>
</div>
</li>
</ul>
</dd>
</dl>
</li>
<li><dl>
<dt><a class="reference external" href="https://pipenv.pypa.io/en/latest/">pipenv</a>:</dt><dd><ul>
<li><p>Make sure you are in the Astropy source directory.  See
<a class="reference internal" href="get_devel_version.html#get-devel"><span class="std std-ref">Try the development version</span></a> if you are unsure how to get the source code.  After
running <code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">clone</span> <span class="pre">&lt;your-astropy-fork&gt;</span></code> run <code class="docutils literal notranslate"><span class="pre">cd</span> <span class="pre">astropy/</span></code> then:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pipenv</span> <span class="n">install</span> <span class="o">-</span><span class="n">e</span> <span class="o">.</span>
</pre></div>
</div>
</li>
<li><p>This both creates the virtual environment for the project
automatically, and also installs all of Astropy’s dependencies, and
adds your Astropy repository as the version of Astropy to use in the
environment.</p></li>
<li><p>You can activate the environment any time you’re in the top-level
<code class="docutils literal notranslate"><span class="pre">astropy/</span></code> directory (cloned from git) by running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pipenv</span> <span class="n">shell</span>
</pre></div>
</div>
<p>This will open a new shell with the appropriate virtualenv enabled.</p>
<p>You can also run individual commands from the virtualenv without
activating it in the shell like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pipenv</span> <span class="n">run</span> <span class="n">python</span>
</pre></div>
</div>
</li>
</ul>
</dd>
</dl>
</li>
</ul>
</div>
<div class="section" id="activate-a-virtual-environment">
<span id="activate-env"></span><h2>Activate a virtual environment<a class="headerlink" href="#activate-a-virtual-environment" title="Permalink to this headline">¶</a></h2>
<p>To use a new virtual environment you may need to activate it;
<a class="reference external" href="https://pypi.org/project/virtualenvwrapper">virtualenvwrapper</a> will try to automatically activate your new environment
when you create it. Activation does two things (either of which you could do
manually, though it would be inconvenient):</p>
<ul class="simple">
<li><p>Puts the <code class="docutils literal notranslate"><span class="pre">bin</span></code> directory for the virtual environment at the front of your
<code class="docutils literal notranslate"><span class="pre">$PATH</span></code>.</p></li>
<li><p>Adds the name of the virtual environment to your command prompt. If you
have successfully switched to a new environment called <code class="docutils literal notranslate"><span class="pre">ENV</span></code> your prompt
should look something like this: <code class="docutils literal notranslate"><span class="pre">(ENV)[~]</span> <span class="pre">$</span></code></p></li>
</ul>
<p>The commands below allow you to switch between virtual environments in
addition to activating new ones.</p>
<ul>
<li><p><a class="reference external" href="https://pypi.org/project/virtualenvwrapper">virtualenvwrapper</a>: Activate the environment <code class="docutils literal notranslate"><span class="pre">ENV</span></code> with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">workon</span> <span class="n">ENV</span>
</pre></div>
</div>
</li>
<li><p><a class="reference external" href="https://conda.io/docs/">conda</a>: Activate the environment <code class="docutils literal notranslate"><span class="pre">ENV</span></code> with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">conda</span> <span class="n">activate</span> <span class="n">ENV</span>
</pre></div>
</div>
</li>
<li><p><a class="reference external" href="https://pipenv.pypa.io/en/latest/">pipenv</a>: Activate the environment by changing into the project
directory (i.e. the copy of the Astropy repository on your computer) and
running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">pipenv</span> <span class="n">shell</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="deactivate-a-virtual-environment">
<span id="deactivate-env"></span><h2>Deactivate a virtual environment<a class="headerlink" href="#deactivate-a-virtual-environment" title="Permalink to this headline">¶</a></h2>
<p>At some point you may want to go back to your default Python environment. Do
that with:</p>
<ul>
<li><dl class="simple">
<dt><a class="reference external" href="https://pypi.org/project/virtualenvwrapper">virtualenvwrapper</a>: <code class="docutils literal notranslate"><span class="pre">deactivate</span></code></dt><dd><ul class="simple">
<li><p>Note that in <code class="docutils literal notranslate"><span class="pre">virtualenvwrapper</span> <span class="pre">4.1.1</span></code> the output of
<code class="docutils literal notranslate"><span class="pre">mkvirtualenv</span></code> says you should use <code class="docutils literal notranslate"><span class="pre">source</span> <span class="pre">deactivate</span></code>; that does
not seem to actually work.</p></li>
</ul>
</dd>
</dl>
</li>
<li><p><a class="reference external" href="https://conda.io/docs/">conda</a>: <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">deactivate</span></code></p></li>
<li><p><a class="reference external" href="https://pipenv.pypa.io/en/latest/">pipenv</a>: <code class="docutils literal notranslate"><span class="pre">exit</span></code></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Unlike <code class="docutils literal notranslate"><span class="pre">virtualenv</span></code> and <code class="docutils literal notranslate"><span class="pre">conda</span></code>, <code class="docutils literal notranslate"><span class="pre">pipenv</span></code> does not manipulate
environment variables in your current shell session.  Instead it
launches a <em>subshell</em> which is a copy of your previous shell, in which
it can then change some environment variables.  Therefore, any
environment variables you change in the <code class="docutils literal notranslate"><span class="pre">pipenv</span></code> shell will be
restored to their previous value (or lost entirely) when <code class="docutils literal notranslate"><span class="pre">exit</span></code>-ing
the subshell.</p>
</div>
</li>
</ul>
</div>
<div class="section" id="delete-a-virtual-environment">
<span id="delete-env"></span><h2>Delete a virtual environment<a class="headerlink" href="#delete-a-virtual-environment" title="Permalink to this headline">¶</a></h2>
<p>In both <a class="reference external" href="https://pypi.org/project/virtualenvwrapper">virtualenvwrapper</a> and <a class="reference external" href="https://conda.io/docs/">conda</a> you can simply delete the
directory in which the <code class="docutils literal notranslate"><span class="pre">ENV</span></code> is located; both also provide commands to
make that a bit easier.  <a class="reference external" href="https://pipenv.pypa.io/en/latest/">pipenv</a> includes a command for deleting the
virtual environment associated with the current directory:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://pypi.org/project/virtualenvwrapper">virtualenvwrapper</a>: <code class="docutils literal notranslate"><span class="pre">rmvirtualenv</span> <span class="pre">ENV</span></code></p></li>
<li><p><a class="reference external" href="https://conda.io/docs/">conda</a>: <code class="docutils literal notranslate"><span class="pre">conda</span> <span class="pre">remove</span> <span class="pre">--all</span> <span class="pre">-n</span> <span class="pre">ENV</span></code></p></li>
<li><p><a class="reference external" href="https://pipenv.pypa.io/en/latest/">pipenv</a>: <code class="docutils literal notranslate"><span class="pre">pipenv</span> <span class="pre">--rm</span></code>: As with other <code class="docutils literal notranslate"><span class="pre">pipenv</span></code> commands this is
run from within the project directory.</p></li>
</ul>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Python virtual environments</a><ul>
<li><a class="reference internal" href="#set-up-for-virtual-environments">Set up for virtual environments</a></li>
<li><a class="reference internal" href="#list-virtual-environments">List virtual environments</a></li>
<li><a class="reference internal" href="#create-a-new-virtual-environment">Create a new virtual environment</a></li>
<li><a class="reference internal" href="#activate-a-virtual-environment">Activate a virtual environment</a></li>
<li><a class="reference internal" href="#deactivate-a-virtual-environment">Deactivate a virtual environment</a></li>
<li><a class="reference internal" href="#delete-a-virtual-environment">Delete a virtual environment</a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../../_sources/development/workflow/virtual_pythons.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011–2022, The Astropy Developers.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 3.5.4. &nbsp;
    Last built 09 May 2022. <br/>
  </p>
</footer>
  </body>
</html>