


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Create a new coordinate class (for the Sagittarius stream) &#8212; Astropy v5.2.dev96+g04a0cf8bb</title>
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-rendered-html.css" />
    
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script type="text/javascript" src="../../../_static/sidebar.js"></script>
    <script type="text/javascript" src="../../../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../../../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Create a multi-extension FITS (MEF) file from scratch" href="../io/create-mef.html" />
    <link rel="prev" title="Transforming positions and velocities to and from a Galactocentric frame" href="plot_galactocentric-frame.html" />
  
  <meta name="robots" content="noindex, nofollow">
  
  
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>


  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="../io/create-mef.html" title="Create a multi-extension FITS (MEF) file from scratch">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="plot_galactocentric-frame.html" title="Transforming positions and velocities to and from a Galactocentric frame">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../../../index.html">Astropy v5.2.dev96+g04a0cf8bb</a>
	 &#187;
      </li>
      <li><a href="../index.html" accesskey="U">Example gallery</a> &#187;</li>
      
      <li>Create a new coordinate class (for the Sagittarius stream)</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-generated-examples-coordinates-plot-sgr-coordinate-frame-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="create-a-new-coordinate-class-for-the-sagittarius-stream">
<span id="sphx-glr-generated-examples-coordinates-plot-sgr-coordinate-frame-py"></span><h1>Create a new coordinate class (for the Sagittarius stream)<a class="headerlink" href="#create-a-new-coordinate-class-for-the-sagittarius-stream" title="Permalink to this headline">¶</a></h1>
<p>This document describes in detail how to subclass and define a custom spherical
coordinate frame, as discussed in <a class="reference internal" href="../../../coordinates/frames.html#astropy-coordinates-design"><span class="std std-ref">Defining a New Frame</span></a> and
the docstring for <a class="reference internal" href="../../../api/astropy.coordinates.BaseCoordinateFrame.html#astropy.coordinates.BaseCoordinateFrame" title="astropy.coordinates.BaseCoordinateFrame"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BaseCoordinateFrame</span></code></a>. In this example,
we will define a coordinate system defined by the plane of orbit of the
Sagittarius Dwarf Galaxy (hereafter Sgr; as defined in Majewski et al. 2003).
The Sgr coordinate system is often referred to in terms of two angular
coordinates, <span class="math notranslate nohighlight">\(\Lambda,B\)</span>.</p>
<p>To do this, we need to define a subclass of
<a class="reference internal" href="../../../api/astropy.coordinates.BaseCoordinateFrame.html#astropy.coordinates.BaseCoordinateFrame" title="astropy.coordinates.BaseCoordinateFrame"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BaseCoordinateFrame</span></code></a> that knows the names and units of the
coordinate system angles in each of the supported representations.  In this case
we support <a class="reference internal" href="../../../api/astropy.coordinates.SphericalRepresentation.html#astropy.coordinates.SphericalRepresentation" title="astropy.coordinates.SphericalRepresentation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">SphericalRepresentation</span></code></a> with “Lambda” and
“Beta”. Then we have to define the transformation from this coordinate system to
some other built-in system. Here we will use Galactic coordinates, represented
by the <a class="reference internal" href="../../../api/astropy.coordinates.Galactic.html#astropy.coordinates.Galactic" title="astropy.coordinates.Galactic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Galactic</span></code></a> class.</p>
<div class="section" id="see-also">
<h2>See Also<a class="headerlink" href="#see-also" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>The <a class="reference external" href="http://gala.adrian.pw/">gala package</a>, which defines a number of
Astropy coordinate frames for stellar stream coordinate systems.</p></li>
<li><p>Majewski et al. 2003, “A Two Micron All Sky Survey View of the Sagittarius
Dwarf Galaxy. I. Morphology of the Sagittarius Core and Tidal Arms”,
<a class="reference external" href="https://arxiv.org/abs/astro-ph/0304198">https://arxiv.org/abs/astro-ph/0304198</a></p></li>
<li><p>Law &amp; Majewski 2010, “The Sagittarius Dwarf Galaxy: A Model for Evolution in a
Triaxial Milky Way Halo”, <a class="reference external" href="https://arxiv.org/abs/1003.1132">https://arxiv.org/abs/1003.1132</a></p></li>
<li><p>David Law’s Sgr info page <a class="reference external" href="https://www.stsci.edu/~dlaw/Sgr/">https://www.stsci.edu/~dlaw/Sgr/</a></p></li>
</ul>
<p><em>By: Adrian Price-Whelan, Erik Tollerud</em></p>
<p><em>License: BSD</em></p>
<p>Make <a class="reference external" href="https://docs.python.org/3/library/functions.html#print" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">print</span></code></a> work the same in all versions of Python, set up numpy,
matplotlib, and use a nicer set of plot parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">from</span> <span class="nn">astropy.visualization</span> <span class="kn">import</span> <a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">astropy_mpl_style</span></a>
<span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><a href="https://docs.python.org/3/library/stdtypes.html#dict" title="builtins.dict" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">astropy_mpl_style</span></a><span class="p">)</span>
</pre></div>
</div>
<p>Import the packages necessary for coordinates</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">frame_transform_graph</span>
<span class="kn">from</span> <span class="nn">astropy.coordinates.matrix_utilities</span> <span class="kn">import</span> <span class="n">rotation_matrix</span><span class="p">,</span> <span class="n">matrix_product</span><span class="p">,</span> <span class="n">matrix_transpose</span>
<span class="kn">import</span> <span class="nn">astropy.coordinates</span> <span class="k">as</span> <span class="nn">coord</span>
<span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>
</pre></div>
</div>
<p>The first step is to create a new class, which we’ll call
<code class="docutils literal notranslate"><span class="pre">Sagittarius</span></code> and make it a subclass of
<a class="reference internal" href="../../../api/astropy.coordinates.BaseCoordinateFrame.html#astropy.coordinates.BaseCoordinateFrame" title="astropy.coordinates.BaseCoordinateFrame"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BaseCoordinateFrame</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Sagittarius</span><span class="p">(</span><a href="../../../api/astropy.coordinates.BaseCoordinateFrame.html#astropy.coordinates.BaseCoordinateFrame" title="astropy.coordinates.BaseCoordinateFrame" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class"><span class="n">coord</span><span class="o">.</span><span class="n">BaseCoordinateFrame</span></a><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    A Heliocentric spherical coordinate system defined by the orbit</span>
<span class="sd">    of the Sagittarius dwarf galaxy, as described in</span>
<span class="sd">        https://ui.adsabs.harvard.edu/abs/2003ApJ...599.1082M</span>
<span class="sd">    and further explained in</span>
<span class="sd">        https://www.stsci.edu/~dlaw/Sgr/.</span>

<span class="sd">    Parameters</span>
<span class="sd">    ----------</span>
<span class="sd">    representation : `~astropy.coordinates.BaseRepresentation` or None</span>
<span class="sd">        A representation object or None to have no data (or use the other keywords)</span>
<span class="sd">    Lambda : `~astropy.coordinates.Angle`, optional, must be keyword</span>
<span class="sd">        The longitude-like angle corresponding to Sagittarius&#39; orbit.</span>
<span class="sd">    Beta : `~astropy.coordinates.Angle`, optional, must be keyword</span>
<span class="sd">        The latitude-like angle corresponding to Sagittarius&#39; orbit.</span>
<span class="sd">    distance : `~astropy.units.Quantity`, optional, must be keyword</span>
<span class="sd">        The Distance for this object along the line-of-sight.</span>
<span class="sd">    pm_Lambda_cosBeta : `~astropy.units.Quantity`, optional, must be keyword</span>
<span class="sd">        The proper motion along the stream in ``Lambda`` (including the</span>
<span class="sd">        ``cos(Beta)`` factor) for this object (``pm_Beta`` must also be given).</span>
<span class="sd">    pm_Beta : `~astropy.units.Quantity`, optional, must be keyword</span>
<span class="sd">        The proper motion in Declination for this object (``pm_ra_cosdec`` must</span>
<span class="sd">        also be given).</span>
<span class="sd">    radial_velocity : `~astropy.units.Quantity`, optional, keyword-only</span>
<span class="sd">        The radial velocity of this object.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="n">default_representation</span> <span class="o">=</span> <a href="../../../api/astropy.coordinates.SphericalRepresentation.html#astropy.coordinates.SphericalRepresentation" title="astropy.coordinates.SphericalRepresentation" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class"><span class="n">coord</span><span class="o">.</span><span class="n">SphericalRepresentation</span></a>
    <span class="n">default_differential</span> <span class="o">=</span> <a href="../../../api/astropy.coordinates.SphericalCosLatDifferential.html#astropy.coordinates.SphericalCosLatDifferential" title="astropy.coordinates.SphericalCosLatDifferential" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class"><span class="n">coord</span><span class="o">.</span><span class="n">SphericalCosLatDifferential</span></a>

    <span class="n">frame_specific_representation_info</span> <span class="o">=</span> <span class="p">{</span>
        <a href="../../../api/astropy.coordinates.SphericalRepresentation.html#astropy.coordinates.SphericalRepresentation" title="astropy.coordinates.SphericalRepresentation" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class"><span class="n">coord</span><span class="o">.</span><span class="n">SphericalRepresentation</span></a><span class="p">:</span> <span class="p">[</span>
            <a href="../../../api/astropy.coordinates.RepresentationMapping.html#astropy.coordinates.RepresentationMapping" title="astropy.coordinates.RepresentationMapping" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class"><span class="n">coord</span><span class="o">.</span><span class="n">RepresentationMapping</span></a><span class="p">(</span><span class="s1">&#39;lon&#39;</span><span class="p">,</span> <span class="s1">&#39;Lambda&#39;</span><span class="p">),</span>
            <a href="../../../api/astropy.coordinates.RepresentationMapping.html#astropy.coordinates.RepresentationMapping" title="astropy.coordinates.RepresentationMapping" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class"><span class="n">coord</span><span class="o">.</span><span class="n">RepresentationMapping</span></a><span class="p">(</span><span class="s1">&#39;lat&#39;</span><span class="p">,</span> <span class="s1">&#39;Beta&#39;</span><span class="p">),</span>
            <a href="../../../api/astropy.coordinates.RepresentationMapping.html#astropy.coordinates.RepresentationMapping" title="astropy.coordinates.RepresentationMapping" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class"><span class="n">coord</span><span class="o">.</span><span class="n">RepresentationMapping</span></a><span class="p">(</span><span class="s1">&#39;distance&#39;</span><span class="p">,</span> <span class="s1">&#39;distance&#39;</span><span class="p">)]</span>
    <span class="p">}</span>
</pre></div>
</div>
<p>Breaking this down line-by-line, we define the class as a subclass of
<a class="reference internal" href="../../../api/astropy.coordinates.BaseCoordinateFrame.html#astropy.coordinates.BaseCoordinateFrame" title="astropy.coordinates.BaseCoordinateFrame"><code class="xref py py-obj docutils literal notranslate"><span class="pre">BaseCoordinateFrame</span></code></a>. Then we include a descriptive
docstring.  The final lines are class-level attributes that specify the
default representation for the data, default differential for the velocity
information, and mappings from the attribute names used by representation
objects to the names that are to be used by the <code class="docutils literal notranslate"><span class="pre">Sagittarius</span></code> frame. In this
case we override the names in the spherical representations but don’t do
anything with other representations like cartesian or cylindrical.</p>
<p>Next we have to define the transformation from this coordinate system to some
other built-in coordinate system; we will use Galactic coordinates. We can do
this by defining functions that return transformation matrices, or by simply
defining a function that accepts a coordinate and returns a new coordinate in
the new system. Because the transformation to the Sagittarius coordinate
system is just a spherical rotation from Galactic coordinates, we’ll just
define a function that returns this matrix. We’ll start by constructing the
transformation matrix using pre-determined Euler angles and the
<code class="docutils literal notranslate"><span class="pre">rotation_matrix</span></code> helper function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../../api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">SGR_PHI</span></a> <span class="o">=</span> <span class="p">(</span><span class="mi">180</span> <span class="o">+</span> <span class="mf">3.75</span><span class="p">)</span> <span class="o">*</span> <a href="../../../api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">degree</span></a> <span class="c1"># Euler angles (from Law &amp; Majewski 2010)</span>
<a href="../../../api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">SGR_THETA</span></a> <span class="o">=</span> <span class="p">(</span><span class="mi">90</span> <span class="o">-</span> <span class="mf">13.46</span><span class="p">)</span> <span class="o">*</span> <a href="../../../api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">degree</span></a>
<a href="../../../api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">SGR_PSI</span></a> <span class="o">=</span> <span class="p">(</span><span class="mi">180</span> <span class="o">+</span> <span class="mf">14.111534</span><span class="p">)</span> <span class="o">*</span> <a href="../../../api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">degree</span></a>

<span class="c1"># Generate the rotation matrix using the x-convention (see Goldstein)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">D</span></a> <span class="o">=</span> <span class="n">rotation_matrix</span><span class="p">(</span><a href="../../../api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">SGR_PHI</span></a><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C</span></a> <span class="o">=</span> <span class="n">rotation_matrix</span><span class="p">(</span><a href="../../../api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">SGR_THETA</span></a><span class="p">,</span> <span class="s2">&quot;x&quot;</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">B</span></a> <span class="o">=</span> <span class="n">rotation_matrix</span><span class="p">(</span><a href="../../../api/astropy.units.Quantity.html#astropy.units.Quantity" title="astropy.units.Quantity" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">SGR_PSI</span></a><span class="p">,</span> <span class="s2">&quot;z&quot;</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">A</span></a> <span class="o">=</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.diag.html#numpy.diag" title="numpy.diag" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">diag</span></a><span class="p">([</span><span class="mf">1.</span><span class="p">,</span><span class="mf">1.</span><span class="p">,</span><span class="o">-</span><span class="mf">1.</span><span class="p">])</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">SGR_MATRIX</span></a> <span class="o">=</span> <span class="n">matrix_product</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">A</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">B</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">C</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">D</span></a><span class="p">)</span>
</pre></div>
</div>
<p>Since we already constructed the transformation (rotation) matrix above, and
the inverse of a rotation matrix is just its transpose, the required
transformation functions are very simple:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@frame_transform_graph</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><a href="../../../api/astropy.coordinates.StaticMatrixTransform.html#astropy.coordinates.StaticMatrixTransform" title="astropy.coordinates.StaticMatrixTransform" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class"><span class="n">coord</span><span class="o">.</span><span class="n">StaticMatrixTransform</span></a><span class="p">,</span> <a href="../../../api/astropy.coordinates.Galactic.html#astropy.coordinates.Galactic" title="astropy.coordinates.Galactic" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class"><span class="n">coord</span><span class="o">.</span><span class="n">Galactic</span></a><span class="p">,</span> <a href="../../../api/astropy.coordinates.BaseCoordinateFrame.html#astropy.coordinates.BaseCoordinateFrame" title="astropy.coordinates.BaseCoordinateFrame" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class"><span class="n">Sagittarius</span></a><span class="p">)</span>
<span class="k">def</span> <span class="nf">galactic_to_sgr</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot; Compute the transformation matrix from Galactic spherical to</span>
<span class="sd">        heliocentric Sgr coordinates.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">SGR_MATRIX</span></a>
</pre></div>
</div>
<p>The decorator <code class="docutils literal notranslate"><span class="pre">&#64;frame_transform_graph.transform(coord.StaticMatrixTransform,</span>
<span class="pre">coord.Galactic,</span> <span class="pre">Sagittarius)</span></code>  registers this function on the
<code class="docutils literal notranslate"><span class="pre">frame_transform_graph</span></code> as a coordinate transformation. Inside the function,
we simply return the previously defined rotation matrix.</p>
<p>We then register the inverse transformation by using the transpose of the
rotation matrix (which is faster to compute than the inverse):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nd">@frame_transform_graph</span><span class="o">.</span><span class="n">transform</span><span class="p">(</span><a href="../../../api/astropy.coordinates.StaticMatrixTransform.html#astropy.coordinates.StaticMatrixTransform" title="astropy.coordinates.StaticMatrixTransform" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class"><span class="n">coord</span><span class="o">.</span><span class="n">StaticMatrixTransform</span></a><span class="p">,</span> <a href="../../../api/astropy.coordinates.BaseCoordinateFrame.html#astropy.coordinates.BaseCoordinateFrame" title="astropy.coordinates.BaseCoordinateFrame" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class"><span class="n">Sagittarius</span></a><span class="p">,</span> <a href="../../../api/astropy.coordinates.Galactic.html#astropy.coordinates.Galactic" title="astropy.coordinates.Galactic" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class"><span class="n">coord</span><span class="o">.</span><span class="n">Galactic</span></a><span class="p">)</span>
<span class="k">def</span> <span class="nf">sgr_to_galactic</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot; Compute the transformation matrix from heliocentric Sgr coordinates to</span>
<span class="sd">        spherical Galactic.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">return</span> <span class="n">matrix_transpose</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">SGR_MATRIX</span></a><span class="p">)</span>
</pre></div>
</div>
<p>Now that we’ve registered these transformations between <code class="docutils literal notranslate"><span class="pre">Sagittarius</span></code> and
<a class="reference internal" href="../../../api/astropy.coordinates.Galactic.html#astropy.coordinates.Galactic" title="astropy.coordinates.Galactic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Galactic</span></code></a>, we can transform between <em>any</em> coordinate
system and <code class="docutils literal notranslate"><span class="pre">Sagittarius</span></code> (as long as the other system has a path to
transform to <a class="reference internal" href="../../../api/astropy.coordinates.Galactic.html#astropy.coordinates.Galactic" title="astropy.coordinates.Galactic"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Galactic</span></code></a>). For example, to transform from
ICRS coordinates to <code class="docutils literal notranslate"><span class="pre">Sagittarius</span></code>, we would do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../../api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord" title="astropy.coordinates.SkyCoord" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">icrs</span></a> <span class="o">=</span> <a href="../../../api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord" title="astropy.coordinates.SkyCoord" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class"><span class="n">coord</span><span class="o">.</span><span class="n">SkyCoord</span></a><span class="p">(</span><span class="mf">280.161732</span><span class="o">*</span><a href="../../../api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">degree</span></a><span class="p">,</span> <span class="mf">11.91934</span><span class="o">*</span><a href="../../../api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">degree</span></a><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s1">&#39;icrs&#39;</span><span class="p">)</span>
<a href="../../../api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord" title="astropy.coordinates.SkyCoord" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sgr</span></a> <span class="o">=</span> <a href="../../../api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord.transform_to" title="astropy.coordinates.SkyCoord.transform_to" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-method"><span class="n">icrs</span><span class="o">.</span><span class="n">transform_to</span></a><span class="p">(</span><a href="../../../api/astropy.coordinates.BaseCoordinateFrame.html#astropy.coordinates.BaseCoordinateFrame" title="astropy.coordinates.BaseCoordinateFrame" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class"><span class="n">Sagittarius</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="../../../api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord" title="astropy.coordinates.SkyCoord" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sgr</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;SkyCoord (Sagittarius): (Lambda, Beta) in deg
    (346.81830652, -39.28360407)&gt;
</pre></div>
</div>
<p>Or, to transform from the <code class="docutils literal notranslate"><span class="pre">Sagittarius</span></code> frame to ICRS coordinates (in this
case, a line along the <code class="docutils literal notranslate"><span class="pre">Sagittarius</span></code> x-y plane):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../../api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord" title="astropy.coordinates.SkyCoord" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sgr</span></a> <span class="o">=</span> <a href="../../../api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord" title="astropy.coordinates.SkyCoord" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class"><span class="n">coord</span><span class="o">.</span><span class="n">SkyCoord</span></a><span class="p">(</span><span class="n">Lambda</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a><span class="p">,</span> <span class="mi">128</span><span class="p">)</span><span class="o">*</span><a href="../../../api/astropy.units.IrreducibleUnit.html#astropy.units.IrreducibleUnit" title="astropy.units.IrreducibleUnit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">radian</span></a><span class="p">,</span>
                     <span class="n">Beta</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="mi">128</span><span class="p">)</span><span class="o">*</span><a href="../../../api/astropy.units.IrreducibleUnit.html#astropy.units.IrreducibleUnit" title="astropy.units.IrreducibleUnit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">radian</span></a><span class="p">,</span> <span class="n">frame</span><span class="o">=</span><span class="s1">&#39;sagittarius&#39;</span><span class="p">)</span>
<a href="../../../api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord" title="astropy.coordinates.SkyCoord" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">icrs</span></a> <span class="o">=</span> <a href="../../../api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord.transform_to" title="astropy.coordinates.SkyCoord.transform_to" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-method"><span class="n">sgr</span><span class="o">.</span><span class="n">transform_to</span></a><span class="p">(</span><a href="../../../api/astropy.coordinates.ICRS.html#astropy.coordinates.ICRS" title="astropy.coordinates.ICRS" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class"><span class="n">coord</span><span class="o">.</span><span class="n">ICRS</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="../../../api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord" title="astropy.coordinates.SkyCoord" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">icrs</span></a><span class="p">)</span>
</pre></div>
</div>
<p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;SkyCoord (ICRS): (ra, dec) in deg
    [(284.03876751, -29.00408353), (287.24685769, -29.44848352),
     (290.48068369, -29.81535572), (293.7357366 , -30.1029631 ),
     (297.00711066, -30.30991693), (300.28958688, -30.43520293),
     (303.57772919, -30.47820084), (306.86598944, -30.43869669),
     (310.14881715, -30.31688708), (313.42076929, -30.11337526),
     (316.67661568, -29.82915917), (319.91143548, -29.46561215),
     (323.12070147, -29.02445708), (326.30034928, -28.50773532),
     (329.44683007, -27.9177717 ), (332.55714589, -27.257137  ),
     (335.62886847, -26.52860943), (338.66014233, -25.73513624),
     (341.64967439, -24.87979679), (344.59671212, -23.96576781),
     (347.50101283, -22.99629167), (350.36280652, -21.97464811),
     (353.18275454, -20.90412969), (355.96190618, -19.78802107),
     (358.70165491, -18.62958199), (  1.40369557, -17.43203397),
     (  4.06998374, -16.19855028), (  6.70269788, -14.93224899),
     (  9.30420479, -13.63618882), ( 11.87702861, -12.31336727),
     ( 14.42382347, -10.96672102), ( 16.94734952,  -9.59912794),
     ( 19.45045241,  -8.21341071), ( 21.93604568,  -6.81234162),
     ( 24.40709589,  -5.39864845), ( 26.86661004,  -3.97502106),
     ( 29.31762493,  -2.54411871), ( 31.76319801,  -1.10857781),
     ( 34.20639942,   0.32898001), ( 36.65030466,   1.76593955),
     ( 39.09798768,   3.19968374), ( 41.55251374,   4.6275852 ),
     ( 44.01693189,   6.04699804), ( 46.49426651,   7.45524993),
     ( 48.98750752,   8.84963453), ( 51.4995989 ,  10.22740448),
     ( 54.03342512,  11.58576509), ( 56.59179508,  12.92186896),
     ( 59.17742314,  14.23281165), ( 61.79290712,  15.51562883),
     ( 64.44070278,  16.76729487), ( 67.12309478,  17.98472356),
     ( 69.84216409,  19.16477088), ( 72.59975183,  20.30424045),
     ( 75.39742013,  21.3998918 ), ( 78.23641033,  22.44845192),
     ( 81.11759966,  23.44663022), ( 84.04145735,  24.39113719),
     ( 87.00800203,  25.27870692), ( 90.01676196,  26.10612335),
     ( 93.06674057,  26.87025019), ( 96.15638947,  27.56806406),
     ( 99.28359159,  28.19669038), (102.44565666,  28.75344107),
     (105.63933131,  29.23585315), (108.86082534,  29.64172698),
     (112.105855  ,  29.96916281), (115.36970341,  30.21659414),
     (118.64729687,  30.38281659), (121.93329519,  30.46701088),
     (125.22219273,  30.46875885), (128.50842634,  30.38805179),
     (131.78648572,  30.22529063), (135.05102157,  29.98127794),
     (138.29694697,  29.6572022 ), (141.51952827,  29.2546151 ),
     (144.71446203,  28.77540295), (147.87793614,  28.22175338),
     (151.00667382,  27.59611901), (154.09796066,  26.90117914),
     (157.14965528,  26.13980125), (160.16018547,  25.31500315),
     (163.12853176,  24.42991703), (166.05420084,  23.48775622),
     (168.93719133,  22.49178507), (171.77795423,  21.44529257),
     (174.57735037,  20.35156967), (177.33660656,  19.21389046),
     (180.05727218,  18.03549704), (182.74117737,  16.81958784),
     (185.39039367,  15.56930924), (188.00719783,  14.28774998),
     (190.59403895,  12.97793826), (193.15350938,  11.64284103),
     (195.68831902,  10.28536518), (198.20127316,   8.90836046),
     (200.69525342,   7.51462369), (203.17320154,   6.10690412),
     (205.63810576,   4.6879097 ), (208.09298919,   3.26031403),
     (210.54090002,   1.82676397), (212.984903  ,   0.38988751),
     (215.42807182,  -1.04769799), (217.87348209,  -2.48337744),
     (220.32420429,  -3.91452965), (222.7832966 ,  -5.338519  ),
     (225.25379684,  -6.75268736), (227.73871349,  -8.15434631),
     (230.24101506,  -9.54076983), (232.76361762, -10.90918763),
     (235.30937003, -12.25677927), (237.88103647, -13.58066929),
     (240.48127601, -14.87792359), (243.11261883, -16.14554723),
     (245.777439  , -17.38048408), (248.47792364, -18.57961852),
     (251.2160385 , -19.7397795 ), (253.9934903 , -20.85774736),
     (256.81168612, -21.93026371), (259.67169071, -22.95404466),
     (262.57418275, -23.92579758), (265.51941137, -24.84224172),
     (268.50715471, -25.70013256), (271.53668252, -26.49628998),
     (274.6067251 , -27.22762983), (277.71545113, -27.89119849),
     (280.86045662, -28.48420985), (284.03876751, -29.00408353)]&gt;
</pre></div>
</div>
<p>As an example, we’ll now plot the points in both coordinate systems:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="https://matplotlib.org/stable/api/figure_api.rst.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fig</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.rst.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                         <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="s1">&#39;aitoff&#39;</span><span class="p">})</span>

<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Sagittarius&quot;</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="../../../api/astropy.coordinates.Angle.html#astropy.coordinates.Angle.wrap_at" title="astropy.coordinates.Angle.wrap_at" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-method"><span class="n">sgr</span><span class="o">.</span><span class="n">Lambda</span><span class="o">.</span><span class="n">wrap_at</span></a><span class="p">(</span><span class="mi">180</span><span class="o">*</span><a href="../../../api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">deg</span></a><span class="p">)</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sgr</span><span class="o">.</span><span class="n">Beta</span><span class="o">.</span><span class="n">radian</span></a><span class="p">,</span>
             <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>

<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;ICRS&quot;</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="../../../api/astropy.coordinates.Angle.html#astropy.coordinates.Angle.wrap_at" title="astropy.coordinates.Angle.wrap_at" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-method"><span class="n">icrs</span><span class="o">.</span><span class="n">ra</span><span class="o">.</span><span class="n">wrap_at</span></a><span class="p">(</span><span class="mi">180</span><span class="o">*</span><a href="../../../api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">deg</span></a><span class="p">)</span><span class="o">.</span><span class="n">radian</span><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">icrs</span><span class="o">.</span><span class="n">dec</span><span class="o">.</span><span class="n">radian</span></a><span class="p">,</span>
             <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.rst.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<img src="../../../_images/sphx_glr_plot_sgr-coordinate-frame_001.png" srcset="../../../_images/sphx_glr_plot_sgr-coordinate-frame_001.png" alt="Sagittarius, ICRS" class = "sphx-glr-single-img"/><p>This particular transformation is just a spherical rotation, which is a
special case of an Affine transformation with no vector offset. The
transformation of velocity components is therefore natively supported as
well:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><a href="../../../api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord" title="astropy.coordinates.SkyCoord" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sgr</span></a> <span class="o">=</span> <a href="../../../api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord" title="astropy.coordinates.SkyCoord" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class"><span class="n">coord</span><span class="o">.</span><span class="n">SkyCoord</span></a><span class="p">(</span><span class="n">Lambda</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.linspace.html#numpy.linspace" title="numpy.linspace" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">linspace</span></a><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="o">*</span><a href="https://docs.python.org/3/library/functions.html#float" title="builtins.float" class="sphx-glr-backref-module-builtins sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">np</span><span class="o">.</span><span class="n">pi</span></a><span class="p">,</span> <span class="mi">128</span><span class="p">)</span><span class="o">*</span><a href="../../../api/astropy.units.IrreducibleUnit.html#astropy.units.IrreducibleUnit" title="astropy.units.IrreducibleUnit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">radian</span></a><span class="p">,</span>
                     <span class="n">Beta</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="mi">128</span><span class="p">)</span><span class="o">*</span><a href="../../../api/astropy.units.IrreducibleUnit.html#astropy.units.IrreducibleUnit" title="astropy.units.IrreducibleUnit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">radian</span></a><span class="p">,</span>
                     <span class="n">pm_Lambda_cosBeta</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/random/generated/numpy.random.uniform.html#numpy.random.uniform" title="numpy.random.uniform" class="sphx-glr-backref-module-numpy-random sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span></a><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">128</span><span class="p">)</span><span class="o">*</span><a href="../../../api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">mas</span></a><span class="o">/</span><a href="../../../api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">yr</span></a><span class="p">,</span>
                     <span class="n">pm_Beta</span><span class="o">=</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.zeros.html#numpy.zeros" title="numpy.zeros" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-function"><span class="n">np</span><span class="o">.</span><span class="n">zeros</span></a><span class="p">(</span><span class="mi">128</span><span class="p">)</span><span class="o">*</span><a href="../../../api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">mas</span></a><span class="o">/</span><a href="../../../api/astropy.units.Unit.html#astropy.units.Unit" title="astropy.units.Unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">u</span><span class="o">.</span><span class="n">yr</span></a><span class="p">,</span>
                     <span class="n">frame</span><span class="o">=</span><span class="s1">&#39;sagittarius&#39;</span><span class="p">)</span>
<a href="../../../api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord" title="astropy.coordinates.SkyCoord" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">icrs</span></a> <span class="o">=</span> <a href="../../../api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord.transform_to" title="astropy.coordinates.SkyCoord.transform_to" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-method"><span class="n">sgr</span><span class="o">.</span><span class="n">transform_to</span></a><span class="p">(</span><a href="../../../api/astropy.coordinates.ICRS.html#astropy.coordinates.ICRS" title="astropy.coordinates.ICRS" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class"><span class="n">coord</span><span class="o">.</span><span class="n">ICRS</span></a><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><a href="../../../api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord" title="astropy.coordinates.SkyCoord" class="sphx-glr-backref-module-astropy-coordinates sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">icrs</span></a><span class="p">)</span>

<a href="https://matplotlib.org/stable/api/figure_api.rst.html#matplotlib.figure.Figure" title="matplotlib.figure.Figure" class="sphx-glr-backref-module-matplotlib-figure sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">fig</span></a><span class="p">,</span> <a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes</span></a> <span class="o">=</span> <a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.subplots.rst.html#matplotlib.pyplot.subplots" title="matplotlib.pyplot.subplots" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">subplots</span></a><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">sharex</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;Sagittarius&quot;</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">sgr</span><span class="o">.</span><span class="n">Lambda</span><span class="o">.</span><span class="n">degree</span></a><span class="p">,</span>
             <a href="../../../api/astropy.units.Quantity.html#astropy.units.Quantity.value" title="astropy.units.Quantity.value" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-attribute"><span class="n">sgr</span><span class="o">.</span><span class="n">pm_Lambda_cosBeta</span><span class="o">.</span><span class="n">value</span></a><span class="p">,</span>
             <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\Lambda$ [deg]&quot;</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes</span></a><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span>
    <span class="sa">fr</span><span class="s2">&quot;$\mu_\Lambda \, \cos B$ [</span><span class="si">{</span><a href="../../../api/astropy.units.Quantity.html#astropy.units.Quantity.unit" title="astropy.units.Quantity.unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-attribute"><span class="n">sgr</span><span class="o">.</span><span class="n">pm_Lambda_cosBeta</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">to_string</span></a><span class="p">(</span><span class="s1">&#39;latex_inline&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>

<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;ICRS&quot;</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">icrs</span><span class="o">.</span><span class="n">ra</span><span class="o">.</span><span class="n">degree</span></a><span class="p">,</span> <a href="../../../api/astropy.units.Quantity.html#astropy.units.Quantity.value" title="astropy.units.Quantity.value" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-attribute"><span class="n">icrs</span><span class="o">.</span><span class="n">pm_ra_cosdec</span><span class="o">.</span><span class="n">value</span></a><span class="p">,</span>
             <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes</span></a><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span>
    <span class="sa">fr</span><span class="s2">&quot;$\mu_\alpha \, \cos\delta$ [</span><span class="si">{</span><a href="../../../api/astropy.units.Quantity.html#astropy.units.Quantity.unit" title="astropy.units.Quantity.unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-attribute"><span class="n">icrs</span><span class="o">.</span><span class="n">pm_ra_cosdec</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">to_string</span></a><span class="p">(</span><span class="s1">&#39;latex_inline&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>

<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes</span></a><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_title</span><span class="p">(</span><span class="s2">&quot;ICRS&quot;</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes</span></a><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">icrs</span><span class="o">.</span><span class="n">ra</span><span class="o">.</span><span class="n">degree</span></a><span class="p">,</span> <a href="../../../api/astropy.units.Quantity.html#astropy.units.Quantity.value" title="astropy.units.Quantity.value" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-attribute"><span class="n">icrs</span><span class="o">.</span><span class="n">pm_dec</span><span class="o">.</span><span class="n">value</span></a><span class="p">,</span>
             <span class="n">linestyle</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="s1">&#39;.&#39;</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes</span></a><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s2">&quot;RA [deg]&quot;</span><span class="p">)</span>
<a href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="numpy.ndarray" class="sphx-glr-backref-module-numpy sphx-glr-backref-type-py-class sphx-glr-backref-instance"><span class="n">axes</span></a><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span>
    <span class="sa">fr</span><span class="s2">&quot;$\mu_\delta$ [</span><span class="si">{</span><a href="../../../api/astropy.units.Quantity.html#astropy.units.Quantity.unit" title="astropy.units.Quantity.unit" class="sphx-glr-backref-module-astropy-units sphx-glr-backref-type-py-attribute"><span class="n">icrs</span><span class="o">.</span><span class="n">pm_dec</span><span class="o">.</span><span class="n">unit</span><span class="o">.</span><span class="n">to_string</span></a><span class="p">(</span><span class="s1">&#39;latex_inline&#39;</span><span class="p">)</span><span class="si">}</span><span class="s2">]&quot;</span><span class="p">)</span>

<a href="https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.show.rst.html#matplotlib.pyplot.show" title="matplotlib.pyplot.show" class="sphx-glr-backref-module-matplotlib-pyplot sphx-glr-backref-type-py-function"><span class="n">plt</span><span class="o">.</span><span class="n">show</span></a><span class="p">()</span>
</pre></div>
</div>
<img src="../../../_images/sphx_glr_plot_sgr-coordinate-frame_002.png" srcset="../../../_images/sphx_glr_plot_sgr-coordinate-frame_002.png" alt="Sagittarius, ICRS, ICRS" class = "sphx-glr-single-img"/><p class="sphx-glr-script-out">Out:</p>
<div class="sphx-glr-script-out highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;SkyCoord (ICRS): (ra, dec) in deg
    [(284.03876751, -29.00408353), (287.24685769, -29.44848352),
     (290.48068369, -29.81535572), (293.7357366 , -30.1029631 ),
     (297.00711066, -30.30991693), (300.28958688, -30.43520293),
     (303.57772919, -30.47820084), (306.86598944, -30.43869669),
     (310.14881715, -30.31688708), (313.42076929, -30.11337526),
     (316.67661568, -29.82915917), (319.91143548, -29.46561215),
     (323.12070147, -29.02445708), (326.30034928, -28.50773532),
     (329.44683007, -27.9177717 ), (332.55714589, -27.257137  ),
     (335.62886847, -26.52860943), (338.66014233, -25.73513624),
     (341.64967439, -24.87979679), (344.59671212, -23.96576781),
     (347.50101283, -22.99629167), (350.36280652, -21.97464811),
     (353.18275454, -20.90412969), (355.96190618, -19.78802107),
     (358.70165491, -18.62958199), (  1.40369557, -17.43203397),
     (  4.06998374, -16.19855028), (  6.70269788, -14.93224899),
     (  9.30420479, -13.63618882), ( 11.87702861, -12.31336727),
     ( 14.42382347, -10.96672102), ( 16.94734952,  -9.59912794),
     ( 19.45045241,  -8.21341071), ( 21.93604568,  -6.81234162),
     ( 24.40709589,  -5.39864845), ( 26.86661004,  -3.97502106),
     ( 29.31762493,  -2.54411871), ( 31.76319801,  -1.10857781),
     ( 34.20639942,   0.32898001), ( 36.65030466,   1.76593955),
     ( 39.09798768,   3.19968374), ( 41.55251374,   4.6275852 ),
     ( 44.01693189,   6.04699804), ( 46.49426651,   7.45524993),
     ( 48.98750752,   8.84963453), ( 51.4995989 ,  10.22740448),
     ( 54.03342512,  11.58576509), ( 56.59179508,  12.92186896),
     ( 59.17742314,  14.23281165), ( 61.79290712,  15.51562883),
     ( 64.44070278,  16.76729487), ( 67.12309478,  17.98472356),
     ( 69.84216409,  19.16477088), ( 72.59975183,  20.30424045),
     ( 75.39742013,  21.3998918 ), ( 78.23641033,  22.44845192),
     ( 81.11759966,  23.44663022), ( 84.04145735,  24.39113719),
     ( 87.00800203,  25.27870692), ( 90.01676196,  26.10612335),
     ( 93.06674057,  26.87025019), ( 96.15638947,  27.56806406),
     ( 99.28359159,  28.19669038), (102.44565666,  28.75344107),
     (105.63933131,  29.23585315), (108.86082534,  29.64172698),
     (112.105855  ,  29.96916281), (115.36970341,  30.21659414),
     (118.64729687,  30.38281659), (121.93329519,  30.46701088),
     (125.22219273,  30.46875885), (128.50842634,  30.38805179),
     (131.78648572,  30.22529063), (135.05102157,  29.98127794),
     (138.29694697,  29.6572022 ), (141.51952827,  29.2546151 ),
     (144.71446203,  28.77540295), (147.87793614,  28.22175338),
     (151.00667382,  27.59611901), (154.09796066,  26.90117914),
     (157.14965528,  26.13980125), (160.16018547,  25.31500315),
     (163.12853176,  24.42991703), (166.05420084,  23.48775622),
     (168.93719133,  22.49178507), (171.77795423,  21.44529257),
     (174.57735037,  20.35156967), (177.33660656,  19.21389046),
     (180.05727218,  18.03549704), (182.74117737,  16.81958784),
     (185.39039367,  15.56930924), (188.00719783,  14.28774998),
     (190.59403895,  12.97793826), (193.15350938,  11.64284103),
     (195.68831902,  10.28536518), (198.20127316,   8.90836046),
     (200.69525342,   7.51462369), (203.17320154,   6.10690412),
     (205.63810576,   4.6879097 ), (208.09298919,   3.26031403),
     (210.54090002,   1.82676397), (212.984903  ,   0.38988751),
     (215.42807182,  -1.04769799), (217.87348209,  -2.48337744),
     (220.32420429,  -3.91452965), (222.7832966 ,  -5.338519  ),
     (225.25379684,  -6.75268736), (227.73871349,  -8.15434631),
     (230.24101506,  -9.54076983), (232.76361762, -10.90918763),
     (235.30937003, -12.25677927), (237.88103647, -13.58066929),
     (240.48127601, -14.87792359), (243.11261883, -16.14554723),
     (245.777439  , -17.38048408), (248.47792364, -18.57961852),
     (251.2160385 , -19.7397795 ), (253.9934903 , -20.85774736),
     (256.81168612, -21.93026371), (259.67169071, -22.95404466),
     (262.57418275, -23.92579758), (265.51941137, -24.84224172),
     (268.50715471, -25.70013256), (271.53668252, -26.49628998),
     (274.6067251 , -27.22762983), (277.71545113, -27.89119849),
     (280.86045662, -28.48420985), (284.03876751, -29.00408353)]
 (pm_ra_cosdec, pm_dec) in mas / yr
    [( 0.42038493, -7.26162297e-02), ( 0.90512965, -1.30974817e-01),
     (-4.48727819,  5.21933575e-01), (-0.5486279 ,  4.80821163e-02),
     (-0.047086  ,  2.76643413e-03), ( 1.2981521 , -3.85825768e-02),
     (-3.37233662,  2.07996570e-03), (-0.16879588, -4.80884556e-03),
     (-3.24422648, -1.86625062e-01), ( 0.06234929,  5.38826796e-03),
     (-1.78083779, -2.04982615e-01), (-1.49812935, -2.14991792e-01),
     (-2.65460325, -4.55418090e-01), (-0.66490383, -1.32441589e-01),
     ( 1.73790179,  3.93344276e-01), (-2.34827507, -5.93932182e-01),
     (-0.01514567, -4.22403206e-03), (-2.6778858 , -8.14565041e-01),
     ( 3.85324716,  1.26666332e+00), ( 1.05193121,  3.70769798e-01),
     (-1.82978002, -6.86794925e-01), (-1.01515406, -4.03322168e-01),
     (-3.41648692, -1.42907452e+00), ( 0.70237122,  3.07814453e-01),
     (-0.84547727, -3.86501962e-01), ( 4.34559967,  2.06377770e+00),
     ( 2.48934168,  1.22356461e+00), ( 1.15341048,  5.84695868e-01),
     ( 1.44670873,  7.53870884e-01), (-1.0063789 , -5.37390712e-01),
     (-1.02769985, -5.60680617e-01), (-0.29313972, -1.62932136e-01),
     ( 3.13710575,  1.77154254e+00), (-0.3615132 , -2.06862483e-01),
     (-2.417589  , -1.39813830e+00), ( 1.95480557,  1.13967216e+00),
     ( 0.30442924,  1.78479249e-01), ( 2.31467536,  1.36127164e+00),
     ( 0.64850992,  3.81645089e-01), (-1.4163262 , -8.32014916e-01),
     (-3.85099504, -2.25267304e+00), ( 2.80480006,  1.62970124e+00),
     (-3.99110809, -2.29767913e+00), ( 1.51113168,  8.59758664e-01),
     ( 1.76533678,  9.90015909e-01), ( 3.96884309,  2.18800118e+00),
     ( 3.7302794 ,  2.01595967e+00), (-0.06168553, -3.25851074e-02),
     ( 3.71563182,  1.91268527e+00), (-3.54745342, -1.77382973e+00),
     ( 1.29222332,  6.25522999e-01), ( 3.24023216,  1.51293205e+00),
     ( 0.5160305 ,  2.31507726e-01), (-1.17537408, -5.04523424e-01),
     ( 2.09068911,  8.54689718e-01), ( 4.56030208,  1.76652383e+00),
     (-2.91131612, -1.06258442e+00), (-3.81571492, -1.30385013e+00),
     ( 1.58923791,  5.04726452e-01), (-0.32871151, -9.62131876e-02),
     (-0.9592938 , -2.56217194e-01), (-1.63540853, -3.93850869e-01),
     (-3.5318261 , -7.55724902e-01), (-1.96613393, -3.66881621e-01),
     ( 2.77106872,  4.39959039e-01), ( 2.61528974,  3.41421855e-01),
     ( 1.02160409,  1.04212379e-01), ( 2.29815352,  1.68268813e-01),
     ( 0.39426674,  1.74465060e-02), ( 2.89779482,  4.39699940e-02),
     ( 4.75206298, -6.62458331e-02), (-4.8235738 ,  2.07511899e-01),
     (-3.62173939,  2.60747174e-01), ( 4.82700922, -4.86531048e-01),
     ( 2.65982824, -3.44036241e-01), (-3.78269165,  5.96078675e-01),
     ( 1.51762962, -2.81414383e-01), ( 0.13045134, -2.77634474e-02),
     (-3.5774063 ,  8.57508354e-01), (-3.61710059,  9.62111134e-01),
     (-2.80041402,  8.16676731e-01), (-2.03787399,  6.45091093e-01),
     (-0.65802345,  2.24188752e-01), (-1.49709202,  5.44965038e-01),
     ( 2.55487034, -9.87305100e-01), (-3.05570014,  1.24647930e+00),
     (-2.28611339,  9.79371242e-01), (-3.45987227,  1.54944320e+00),
     ( 2.02503701, -9.44009352e-01), (-3.54397129,  1.71303024e+00),
     ( 3.6626794 , -1.82905923e+00), ( 2.96997241, -1.52706506e+00),
     ( 0.73517934, -3.87954554e-01), ( 0.02051173, -1.10751383e-02),
     (-4.36125271,  2.40244589e+00), (-0.66574132,  3.73103498e-01),
     (-0.18500391,  1.05199401e-01), (-1.63933572,  9.43342769e-01),
     (-2.4744908 ,  1.43728963e+00), ( 2.17873214, -1.27416976e+00),
     ( 4.11787624, -2.41871527e+00), (-1.84868723,  1.08791568e+00),
     (-0.9920448 ,  5.83471684e-01), ( 2.26046329, -1.32549421e+00),
     ( 4.22002611, -2.46102556e+00), (-2.44423161,  1.41410241e+00),
     (-1.6988942 ,  9.72616969e-01), (-3.77819905,  2.13487980e+00),
     (-2.43250736,  1.35301328e+00), (-2.69586911,  1.47202520e+00),
     ( 1.81234219, -9.68700442e-01), (-3.28574221,  1.71405991e+00),
     (-3.19006695,  1.61912929e+00), ( 3.32042386, -1.63430842e+00),
     ( 0.48761599, -2.31929469e-01), ( 0.76014171, -3.48081409e-01),
     ( 2.12013667, -9.30894250e-01), ( 3.90529572, -1.63692250e+00),
     ( 2.693081  , -1.07241345e+00), ( 0.74687429, -2.81042960e-01),
     (-3.20047256,  1.13121634e+00), (-0.88680788,  2.92423721e-01),
     ( 1.04783047, -3.19837135e-01), ( 3.56103931, -9.97017397e-01),
     ( 2.46945087, -6.27329467e-01), ( 0.10359887, -2.35657414e-02),
     ( 1.00242672, -2.00835590e-01), (-0.35201049,  6.08054007e-02)]&gt;
</pre></div>
</div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.327 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-generated-examples-coordinates-plot-sgr-coordinate-frame-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../../_downloads/6751e10a45cdcf610b005c5ae47140cf/plot_sgr-coordinate-frame.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">plot_sgr-coordinate-frame.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../../_downloads/0e3578f5b369aae8cce81830def5f054/plot_sgr-coordinate-frame.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">plot_sgr-coordinate-frame.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Create a new coordinate class (for the Sagittarius stream)</a><ul>
<li><a class="reference internal" href="#see-also">See Also</a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../../../_sources/generated/examples/coordinates/plot_sgr-coordinate-frame.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011–2022, The Astropy Developers.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 3.5.4. &nbsp;
    Last built 09 May 2022. <br/>
  </p>
</footer>
  </body>
</html>