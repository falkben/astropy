


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>FITS File Handling (astropy.io.fits) &#8212; Astropy v5.2.dev96+g04a0cf8bb</title>
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/sg_gallery-rendered-html.css" />
    
    <script id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script src="../../_static/jquery.js"></script>
    <script src="../../_static/underscore.js"></script>
    <script src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/sidebar.js"></script>
    <script type="text/javascript" src="../../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="FITS Headers" href="usage/headers.html" />
    <link rel="prev" title="Unified File Read/Write Interface" href="../unified.html" />
  
  <meta name="robots" content="noindex, nofollow">
  
  
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>


  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="usage/headers.html" title="FITS Headers">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="../unified.html" title="Unified File Read/Write Interface">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../../index.html">Astropy v5.2.dev96+g04a0cf8bb</a>
	 &#187;
      </li>
      
      <li>FITS File Handling (<code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits</span></code>)</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="fits-file-handling-astropy-io-fits">
<span id="astropy-io-fits"></span><h1>FITS File Handling (<a class="reference internal" href="#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits</span></code></a>)<a class="headerlink" href="#fits-file-handling-astropy-io-fits" title="Permalink to this headline">¶</a></h1>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference internal" href="#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-mod docutils literal notranslate"><span class="pre">astropy.io.fits</span></code></a> package provides access to FITS files. FITS
(Flexible Image Transport System) is a portable file standard widely used in
the astronomy community to store images and tables. This subpackage was
originally developed as PyFITS.</p>
</div>
<div class="section" id="getting-started">
<span id="tutorial"></span><h2>Getting Started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<p>This section provides a quick introduction of using <a class="reference internal" href="#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-mod docutils literal notranslate"><span class="pre">astropy.io.fits</span></code></a>. The
goal is to demonstrate the package’s basic features without getting into too
much detail. If you are a first time user or have never used <code class="docutils literal notranslate"><span class="pre">astropy</span></code> or
PyFITS, this is where you should start. See also the <a class="reference internal" href="appendix/faq.html#io-fits-faq"><span class="std std-ref">FAQ</span></a>
for answers to common questions and issues.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to read or write a single table in FITS format, the
recommended method is via the high-level <a class="reference internal" href="../unified.html#table-io"><span class="std std-ref">Unified File Read/Write Interface</span></a>. In particular
see the <a class="reference internal" href="../unified.html#table-io-fits"><span class="std std-ref">Unified I/O FITS</span></a> section.</p>
</div>
<div class="section" id="reading-and-updating-existing-fits-files">
<h3>Reading and Updating Existing FITS Files<a class="headerlink" href="#reading-and-updating-existing-fits-files" title="Permalink to this headline">¶</a></h3>
<div class="section" id="opening-a-fits-file">
<h4>Opening a FITS File<a class="headerlink" href="#opening-a-fits-file" title="Permalink to this headline">¶</a></h4>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The <code class="docutils literal notranslate"><span class="pre">astropy.io.fits.util.get_testdata_filepath()</span></code> function,
used in the examples here, is for accessing data shipped with <code class="docutils literal notranslate"><span class="pre">astropy</span></code>.
To work with your own data instead, please use <a class="reference internal" href="api/files.html#astropy.io.fits.open" title="astropy.io.fits.open"><code class="xref py py-func docutils literal notranslate"><span class="pre">astropy.io.fits.open()</span></code></a>,
which takes either the relative or absolute path.</p>
</div>
<p>Once the <a class="reference internal" href="#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits</span></code></a> package is loaded using the standard convention
<a class="footnote-reference brackets" href="#f1" id="id1">1</a>, we can open an existing FITS file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fits_image_filename</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">get_testdata_filepath</span><span class="p">(</span><span class="s1">&#39;test0.fits&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">hdul</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fits_image_filename</span><span class="p">)</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="api/files.html#astropy.io.fits.open" title="astropy.io.fits.open"><code class="xref py py-func docutils literal notranslate"><span class="pre">open()</span></code></a> function has several optional arguments which will be
discussed in a later chapter. The default mode, as in the above example, is
“readonly”. The open function returns an object called an <a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList" title="astropy.io.fits.HDUList"><code class="xref py py-class docutils literal notranslate"><span class="pre">HDUList</span></code></a>
which is a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">list</span></code></a>-like collection of HDU objects. An HDU (Header Data Unit) is
the highest level component of the FITS file structure, consisting of a header
and (typically) a data array or table.</p>
<p>After the above open call, <code class="docutils literal notranslate"><span class="pre">hdul[0]</span></code> is the primary HDU, <code class="docutils literal notranslate"><span class="pre">hdul[1]</span></code> is
the first extension HDU, etc. (if there are any extensions), and so on. It
should be noted that <code class="docutils literal notranslate"><span class="pre">astropy</span></code> uses zero-based indexing when referring to
HDUs and header cards, though the FITS standard (which was designed with
Fortran in mind) uses one-based indexing.</p>
<p>The <a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList" title="astropy.io.fits.HDUList"><code class="xref py py-class docutils literal notranslate"><span class="pre">HDUList</span></code></a> has a useful method <a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList.info" title="astropy.io.fits.HDUList.info"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HDUList.info()</span></code></a>, which
summarizes the content of the opened FITS file:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hdul</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="go">Filename: ...test0.fits</span>
<span class="go">No.    Name      Ver    Type      Cards   Dimensions   Format</span>
<span class="go">  0  PRIMARY       1 PrimaryHDU     138   ()</span>
<span class="go">  1  SCI           1 ImageHDU        61   (40, 40)   int16</span>
<span class="go">  2  SCI           2 ImageHDU        61   (40, 40)   int16</span>
<span class="go">  3  SCI           3 ImageHDU        61   (40, 40)   int16</span>
<span class="go">  4  SCI           4 ImageHDU        61   (40, 40)   int16</span>
</pre></div>
</div>
<p>After you are done with the opened file, close it with the
<a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList.close" title="astropy.io.fits.HDUList.close"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HDUList.close()</span></code></a> method:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hdul</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>You can avoid closing the file manually by using <a class="reference internal" href="api/files.html#astropy.io.fits.open" title="astropy.io.fits.open"><code class="xref py py-func docutils literal notranslate"><span class="pre">open()</span></code></a> as context
manager:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fits_image_filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdul</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">hdul</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="go">Filename: ...test0.fits</span>
<span class="go">No.    Name      Ver    Type      Cards   Dimensions   Format</span>
<span class="go">  0  PRIMARY       1 PrimaryHDU     138   ()</span>
<span class="go">  1  SCI           1 ImageHDU        61   (40, 40)   int16</span>
<span class="go">  2  SCI           2 ImageHDU        61   (40, 40)   int16</span>
<span class="go">  3  SCI           3 ImageHDU        61   (40, 40)   int16</span>
<span class="go">  4  SCI           4 ImageHDU        61   (40, 40)   int16</span>
</pre></div>
</div>
<p>After exiting the <code class="docutils literal notranslate"><span class="pre">with</span></code> scope the file will be closed automatically. That is
(generally) the preferred way to open a file in Python, because it will close
the file even if an exception happens.</p>
<p>If the file is opened with <code class="docutils literal notranslate"><span class="pre">lazy_load_hdus=False</span></code>, all of the headers will
still be accessible after the HDUList is closed. The headers and data may or
may not be accessible depending on whether the data are touched and if they
are memory-mapped; see later chapters for detail.</p>
<div class="section" id="working-with-large-files">
<span id="fits-large-files"></span><h5>Working with large files<a class="headerlink" href="#working-with-large-files" title="Permalink to this headline">¶</a></h5>
<p>The <a class="reference internal" href="api/files.html#astropy.io.fits.open" title="astropy.io.fits.open"><code class="xref py py-func docutils literal notranslate"><span class="pre">open()</span></code></a> function supports a <code class="docutils literal notranslate"><span class="pre">memmap=True</span></code> argument that allows the
array data of each HDU to be accessed with mmap, rather than being read into
memory all at once. This is particularly useful for working with very large
arrays that cannot fit entirely into physical memory. Here <code class="docutils literal notranslate"><span class="pre">memmap=True</span></code> by
default, and this value is obtained from the configuration item <code class="docutils literal notranslate"><span class="pre">astropy.io.fits.Conf.use_memmap</span></code>.</p>
<p>This has minimal impact on smaller files as well, though some operations, such
as reading the array data sequentially, may incur some additional overhead. On
32-bit systems, arrays larger than 2 to 3 GB cannot be mmap’d (which is fine,
because by that point you are likely to run out of physical memory anyways), but
64-bit systems are much less limited in this respect.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When opening a file with <code class="docutils literal notranslate"><span class="pre">memmap=True</span></code>, because of how mmap works this
means that when the HDU data is accessed (i.e., <code class="docutils literal notranslate"><span class="pre">hdul[0].data</span></code>) another
handle to the FITS file is opened by mmap. This means that even after
calling <code class="docutils literal notranslate"><span class="pre">hdul.close()</span></code> the mmap still holds an open handle to the data so
that it can still be accessed by unwary programs that were built with the
assumption that the .data attribute has all of the data in-memory.</p>
<p>In order to force the mmap to close, either wait for the containing
<code class="docutils literal notranslate"><span class="pre">HDUList</span></code> object to go out of scope, or manually call
<code class="docutils literal notranslate"><span class="pre">del</span> <span class="pre">hdul[0].data</span></code>. (This works so long as there are no other references
held to the data array.)</p>
</div>
</div>
<div class="section" id="working-with-remote-and-cloud-hosted-files">
<span id="fits-cloud-files"></span><h5>Working with remote and cloud-hosted files<a class="headerlink" href="#working-with-remote-and-cloud-hosted-files" title="Permalink to this headline">¶</a></h5>
<p>The <a class="reference internal" href="api/files.html#astropy.io.fits.open" title="astropy.io.fits.open"><code class="xref py py-func docutils literal notranslate"><span class="pre">open()</span></code></a> function supports a <code class="docutils literal notranslate"><span class="pre">use_fsspec</span></code> argument which allows file
paths to be opened using <a class="reference external" href="https://filesystem-spec.readthedocs.io">fsspec</a>.
The <code class="docutils literal notranslate"><span class="pre">fsspec</span></code> package supports a range of remote and distributed storage
backends such as Amazon and Google Cloud Storage. For example, you can access a
Hubble Space Telescope image located in the Hubble’s public
Amazon S3 bucket as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="c1"># Location of a large Hubble archive image in Amazon S3 (213 MB)</span>
<span class="n">uri</span> <span class="o">=</span> <span class="s2">&quot;s3://stpubdata/hst/public/j8pu/j8pu0y010/j8pu0y010_drc.fits&quot;</span>

<span class="c1"># Extract a 10-by-20 pixel cutout image</span>
<span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">uri</span><span class="p">,</span> <span class="n">use_fsspec</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fsspec_kwargs</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;anon&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">})</span> <span class="k">as</span> <span class="n">hdul</span><span class="p">:</span>
    <span class="n">cutout</span> <span class="o">=</span> <span class="n">hdul</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">section</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">20</span><span class="p">,</span> <span class="mi">30</span><span class="p">:</span><span class="mi">50</span><span class="p">]</span>
</pre></div>
</div>
<p>Note that the example above obtains a cutout image using the <a class="reference internal" href="api/images.html#astropy.io.fits.ImageHDU.section" title="astropy.io.fits.ImageHDU.section"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ImageHDU.section</span></code></a>
attribute rather than the traditional <a class="reference internal" href="api/images.html#astropy.io.fits.ImageHDU.data" title="astropy.io.fits.ImageHDU.data"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ImageHDU.data</span></code></a> attribute.
The use of <a class="reference internal" href="api/hdus.html#astropy.io.fits.PrimaryHDU.section" title="astropy.io.fits.PrimaryHDU.section"><code class="xref py py-obj docutils literal notranslate"><span class="pre">section</span></code></a> ensures that only the necessary parts of the FITS
image are transferred from the server, rather than downloading the entire data array.
This trick can significantly speed up your code if you require small subsets of
large FITS files located on slow (remote) storage systems.
See <a class="reference internal" href="usage/cloud.html#fits-io-cloud"><span class="std std-ref">Obtaining subsets from cloud-hosted FITS files</span></a> for additional information on working with remote FITS files in this way.</p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p><a class="reference internal" href="usage/cloud.html#fits-io-cloud"><span class="std std-ref">Obtaining subsets from cloud-hosted FITS files</span></a>.</p>
</div>
</div>
<div class="section" id="unsigned-integers">
<h5>Unsigned integers<a class="headerlink" href="#unsigned-integers" title="Permalink to this headline">¶</a></h5>
<p>Due to the FITS format’s Fortran origins, FITS does not natively support
unsigned integer data in images or tables. However, there is a common
convention to store unsigned integers as signed integers, along with a
<em>shift</em> instruction (a <code class="docutils literal notranslate"><span class="pre">BZERO</span></code> keyword with value <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">**</span> <span class="pre">(BITPIX</span> <span class="pre">-</span> <span class="pre">1)</span></code>) to
shift up all signed integers to unsigned integers. For example, when writing
the value <code class="docutils literal notranslate"><span class="pre">0</span></code> as an unsigned 32-bit integer, it is stored in the FITS
file as <code class="docutils literal notranslate"><span class="pre">-32768</span></code>, along with the header keyword <code class="docutils literal notranslate"><span class="pre">BZERO</span> <span class="pre">=</span> <span class="pre">32768</span></code>.</p>
<p><code class="docutils literal notranslate"><span class="pre">astropy</span></code> recognizes and applies this convention by default, so that all data
that looks like it should be interpreted as unsigned integers is automatically
converted (this applies to both images and tables).</p>
<p>Even with <code class="docutils literal notranslate"><span class="pre">uint=False</span></code>, the <code class="docutils literal notranslate"><span class="pre">BZERO</span></code> shift is still applied, but the
returned array is of “float64” type. To disable scaling/shifting entirely, use
<code class="docutils literal notranslate"><span class="pre">do_not_scale_image_data=True</span></code> (see <a class="reference internal" href="appendix/faq.html#fits-scaled-data-faq"><span class="std std-ref">Why is an image containing integer data being converted unexpectedly to floats?</span></a> in the FAQ
for more details).</p>
</div>
<div class="section" id="working-with-compressed-files">
<h5>Working with compressed files<a class="headerlink" href="#working-with-compressed-files" title="Permalink to this headline">¶</a></h5>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Files that use compressed HDUs within the FITS file are discussed
in <a class="reference internal" href="usage/unfamiliar.html#astropy-io-fits-compressedimagedata"><span class="std std-ref">Compressed Image Data</span></a>.</p>
</div>
<p>The <a class="reference internal" href="api/files.html#astropy.io.fits.open" title="astropy.io.fits.open"><code class="xref py py-func docutils literal notranslate"><span class="pre">open()</span></code></a> function will seamlessly open FITS files that have been
compressed with gzip, bzip2 or pkzip. Note that in this context we are talking
about a FITS file that has been compressed with one of these utilities (e.g., a
.fits.gz file).</p>
<p>There are some limitations when working with compressed files. For example,
with Zip files that contain multiple compressed files, only the first file will
be accessible. Also bzip2 does not support the append or update access modes.</p>
<p>When writing a file (e.g., with the <a class="reference internal" href="api/files.html#astropy.io.fits.writeto" title="astropy.io.fits.writeto"><code class="xref py py-func docutils literal notranslate"><span class="pre">writeto()</span></code></a> function), compression will
be determined based on the filename extension given, or the compression used in
a pre-existing file that is being written to.</p>
</div>
<div class="section" id="working-with-non-standard-files">
<h5>Working with non-standard files<a class="headerlink" href="#working-with-non-standard-files" title="Permalink to this headline">¶</a></h5>
<p>When <a class="reference internal" href="#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits</span></code></a> reads a FITS file which does not conform to the FITS
standard it will try to make an educated interpretation of non-compliant fields.
This may not always succeed and may trigger warnings when accessing headers or
exceptions when writing to file. Verification of fields written to an output
file can be controlled with the <code class="docutils literal notranslate"><span class="pre">output_verify</span></code> parameter of <a class="reference internal" href="api/files.html#astropy.io.fits.open" title="astropy.io.fits.open"><code class="xref py py-func docutils literal notranslate"><span class="pre">open()</span></code></a>.
Files opened for reading can be verified and fixed with method
<code class="docutils literal notranslate"><span class="pre">HDUList.verify</span></code>. This method is typically invoked after opening the file
but before accessing any headers or data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fits_image_filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdul</span><span class="p">:</span>
<span class="gp">... </span>   <span class="n">hdul</span><span class="o">.</span><span class="n">verify</span><span class="p">(</span><span class="s1">&#39;fix&#39;</span><span class="p">)</span>
<span class="gp">... </span>   <span class="n">data</span> <span class="o">=</span> <span class="n">hdul</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
<p>In the above example, the call to <code class="docutils literal notranslate"><span class="pre">hdul.verify(&quot;fix&quot;)</span></code> requests that <a class="reference internal" href="#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits</span></code></a>
fix non-compliant fields and print informative messages. Other options in addition to <code class="docutils literal notranslate"><span class="pre">&quot;fix&quot;</span></code>
are described under FITS <a class="reference internal" href="usage/verification.html#fits-io-verification"><span class="std std-ref">Verification</span></a></p>
<div class="admonition seealso">
<p class="admonition-title">See also</p>
<p>FITS <a class="reference internal" href="usage/verification.html#fits-io-verification"><span class="std std-ref">Verification</span></a>.</p>
</div>
</div>
</div>
<div class="section" id="working-with-fits-headers">
<h4>Working with FITS Headers<a class="headerlink" href="#working-with-fits-headers" title="Permalink to this headline">¶</a></h4>
<p>As mentioned earlier, each element of an <a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList" title="astropy.io.fits.HDUList"><code class="xref py py-class docutils literal notranslate"><span class="pre">HDUList</span></code></a> is an HDU object with
<code class="docutils literal notranslate"><span class="pre">.header</span></code> and <code class="docutils literal notranslate"><span class="pre">.data</span></code> attributes, which can be used to access the header
and data portions of the HDU.</p>
<p>For those unfamiliar with FITS headers, they consist of a list of 80 byte
“cards”, where a card contains a keyword, a value, and a comment. The keyword
and comment must both be strings, whereas the value can be a string or an
integer, floating point number, complex number, or <code class="docutils literal notranslate"><span class="pre">True</span></code>/<code class="docutils literal notranslate"><span class="pre">False</span></code>. Keywords
are usually unique within a header, except in a few special cases.</p>
<p>The header attribute is a <a class="reference internal" href="api/headers.html#astropy.io.fits.Header" title="astropy.io.fits.Header"><code class="xref py py-class docutils literal notranslate"><span class="pre">Header</span></code></a> instance, another <code class="docutils literal notranslate"><span class="pre">astropy</span></code> object.
To get the value associated with a header keyword, do (à la Python dicts):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hdul</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fits_image_filename</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdul</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;DATE&#39;</span><span class="p">]</span>
<span class="go">&#39;01/04/99&#39;</span>
</pre></div>
</div>
<p>to get the value of the keyword “DATE”, which is a string ‘01/04/99’.</p>
<p>Although keyword names are always in upper case inside the FITS file,
specifying a keyword name with <code class="docutils literal notranslate"><span class="pre">astropy</span></code> is case-insensitive for the user’s
convenience. If the specified keyword name does not exist, it will raise a
<a class="reference external" href="https://docs.python.org/3/library/exceptions.html#KeyError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">KeyError</span></code></a> exception.</p>
<p>We can also get the keyword value by indexing (à la Python lists):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hdul</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span>
<span class="go">32768.0</span>
</pre></div>
</div>
<p>This example returns the eighth (like Python lists, it is 0-indexed) keyword’s
value — a float — 32768.0.</p>
<p>Similarly, it is possible to update a keyword’s value in <code class="docutils literal notranslate"><span class="pre">astropy</span></code>, either
through keyword name or index:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span> <span class="o">=</span> <span class="n">hdul</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;targname&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;NGC121-a&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span><span class="p">[</span><span class="mi">27</span><span class="p">]</span> <span class="o">=</span> <span class="mi">99</span>
</pre></div>
</div>
<p>Please note however that almost all application code should update header
values via their keyword name and not via their positional index. This is
because most FITS keywords may appear at any position in the header.</p>
<p>It is also possible to update both the value and comment associated with a
keyword by assigning them as a tuple:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span> <span class="o">=</span> <span class="n">hdul</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">header</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;targname&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="s1">&#39;NGC121-a&#39;</span><span class="p">,</span> <span class="s1">&#39;the observation target&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;targname&#39;</span><span class="p">]</span>
<span class="go">&#39;NGC121-a&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span><span class="o">.</span><span class="n">comments</span><span class="p">[</span><span class="s1">&#39;targname&#39;</span><span class="p">]</span>
<span class="go">&#39;the observation target&#39;</span>
</pre></div>
</div>
<p>Like a dict, you may also use the above syntax to add a new keyword/value pair
(and optionally a comment as well). In this case the new card is appended to
the end of the header (unless it is a commentary keyword such as COMMENT or
HISTORY, in which case it is appended after the last card with that keyword).</p>
<p>Another way to either update an existing card or append a new one is to use the
<a class="reference internal" href="api/headers.html#astropy.io.fits.Header.set" title="astropy.io.fits.Header.set"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Header.set()</span></code></a> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;observer&#39;</span><span class="p">,</span> <span class="s1">&#39;Edwin Hubble&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Comment or history records are added like normal cards, though in their case a
new card is always created, rather than updating an existing HISTORY or COMMENT
card:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;history&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;I updated this file 2/26/09&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;comment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Edwin Hubble really knew his stuff&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;comment&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;I like using HST observations&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;history&#39;</span><span class="p">]</span>
<span class="go">I updated this file 2/26/09</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;comment&#39;</span><span class="p">]</span>
<span class="go">Edwin Hubble really knew his stuff</span>
<span class="go">I like using HST observations</span>
</pre></div>
</div>
<p>Note: Be careful not to confuse COMMENT cards with the comment value for normal
cards.</p>
<p>To update existing COMMENT or HISTORY cards, reference them by index:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;history&#39;</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;I updated this file on 2/27/09&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;history&#39;</span><span class="p">]</span>
<span class="go">I updated this file on 2/27/09</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;comment&#39;</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;I like using JWST observations&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;comment&#39;</span><span class="p">]</span>
<span class="go">Edwin Hubble really knew his stuff</span>
<span class="go">I like using JWST observations</span>
</pre></div>
</div>
<p>To see the entire header as it appears in the FITS file (with the END card and
padding stripped), enter the header object by itself, or
<code class="docutils literal notranslate"><span class="pre">print(repr(hdr))</span></code>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span>  
<span class="go">SIMPLE  =                    T / file does conform to FITS standard</span>
<span class="go">BITPIX  =                   16 / number of bits per data pixel</span>
<span class="go">NAXIS   =                    0 / number of data axes</span>
<span class="gp">...</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">hdr</span><span class="p">))</span>  
<span class="go">SIMPLE  =                    T / file does conform to FITS standard</span>
<span class="go">BITPIX  =                   16 / number of bits per data pixel</span>
<span class="go">NAXIS   =                    0 / number of data axes</span>
<span class="gp">...</span>
</pre></div>
</div>
<p>Entering only <code class="docutils literal notranslate"><span class="pre">print(hdr)</span></code> will also work, but may not be very legible
on most displays, as this displays the header as it is written in the FITS file
itself, which means there are no line breaks between cards. This is a common
source of confusion for new users.</p>
<p>It is also possible to view a slice of the header:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span class="go">SIMPLE  =                    T / file does conform to FITS standard</span>
<span class="go">BITPIX  =                   16 / number of bits per data pixel</span>
</pre></div>
</div>
<p>Only the first two cards are shown above.</p>
<p>To get a list of all keywords, use the <a class="reference internal" href="api/headers.html#astropy.io.fits.Header.keys" title="astropy.io.fits.Header.keys"><code class="xref py py-meth docutils literal notranslate"><span class="pre">Header.keys()</span></code></a> method just as you
would with a dict:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">list</span><span class="p">(</span><span class="n">hdr</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span>  
<span class="go">[&#39;SIMPLE&#39;, &#39;BITPIX&#39;, &#39;NAXIS&#39;, ...]</span>
</pre></div>
</div>
<div class="topic">
<p class="topic-title">Examples:</p>
<p>See also <a class="reference internal" href="../../generated/examples/io/modify-fits-header.html#sphx-glr-generated-examples-io-modify-fits-header-py"><span class="std std-ref">Edit a FITS header</span></a>.</p>
</div>
<div class="section" id="structural-keywords">
<span id="id2"></span><h5>Structural Keywords<a class="headerlink" href="#structural-keywords" title="Permalink to this headline">¶</a></h5>
<p>FITS keywords mix up both metadata and critical information about the file structure
that is needed to parse the file. These <em>structural</em> keywords are managed internally by
<a class="reference internal" href="#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-mod docutils literal notranslate"><span class="pre">astropy.io.fits</span></code></a> and, in general, should not be touched by the user. Instead one
should use  the related attributes of the <a class="reference internal" href="#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits</span></code></a> classes (see examples below).</p>
<p>The specific set of structural keywords used by the FITS standard varies with HDU type.
The following table lists which keywords are associated with each HDU type:</p>
<table class="colwidths-given docutils align-default" id="id3">
<caption><span class="caption-text">Structural Keywords</span><a class="headerlink" href="#id3" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>HDU Type</p></th>
<th class="head"><p>Structural Keywords</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>All</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">SIMPLE</span></code>, <code class="docutils literal notranslate"><span class="pre">BITPIX</span></code>, <code class="docutils literal notranslate"><span class="pre">NAXIS</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/hdus.html#astropy.io.fits.PrimaryHDU" title="astropy.io.fits.PrimaryHDU"><code class="xref py py-class docutils literal notranslate"><span class="pre">PrimaryHDU</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">EXTEND</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/images.html#astropy.io.fits.ImageHDU" title="astropy.io.fits.ImageHDU"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageHDU</span></code></a>, <a class="reference internal" href="api/tables.html#astropy.io.fits.TableHDU" title="astropy.io.fits.TableHDU"><code class="xref py py-class docutils literal notranslate"><span class="pre">TableHDU</span></code></a>, <a class="reference internal" href="api/tables.html#astropy.io.fits.BinTableHDU" title="astropy.io.fits.BinTableHDU"><code class="xref py py-class docutils literal notranslate"><span class="pre">BinTableHDU</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">PCOUNT</span></code>, <code class="docutils literal notranslate"><span class="pre">GCOUNT</span></code></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference internal" href="api/hdus.html#astropy.io.fits.GroupsHDU" title="astropy.io.fits.GroupsHDU"><code class="xref py py-class docutils literal notranslate"><span class="pre">GroupsHDU</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">NAXIS1</span></code>, <code class="docutils literal notranslate"><span class="pre">GCOUNT</span></code>, <code class="docutils literal notranslate"><span class="pre">PCOUNT</span></code>, <code class="docutils literal notranslate"><span class="pre">GROUPS</span></code></p></td>
</tr>
<tr class="row-even"><td><p><a class="reference internal" href="api/tables.html#astropy.io.fits.TableHDU" title="astropy.io.fits.TableHDU"><code class="xref py py-class docutils literal notranslate"><span class="pre">TableHDU</span></code></a>, <a class="reference internal" href="api/tables.html#astropy.io.fits.BinTableHDU" title="astropy.io.fits.BinTableHDU"><code class="xref py py-class docutils literal notranslate"><span class="pre">BinTableHDU</span></code></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">TFIELDS</span></code>, <code class="docutils literal notranslate"><span class="pre">TFORM</span></code>, <code class="docutils literal notranslate"><span class="pre">TBCOL</span></code></p></td>
</tr>
</tbody>
</table>
<p>There are many other reserved keywords, for instance for the data scaling, or for table’s column
attributes, as described in the  <a class="reference external" href="https://fits.gsfc.nasa.gov/fits_standard.html">FITS Standard</a>.
Most of these are accessible via attributes of the <a class="reference internal" href="api/tables.html#astropy.io.fits.Column" title="astropy.io.fits.Column"><code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code></a> or HDU objects, for instance
<code class="docutils literal notranslate"><span class="pre">hdu.name</span></code> to set <code class="docutils literal notranslate"><span class="pre">EXTNAME</span></code>, or <code class="docutils literal notranslate"><span class="pre">hdu.ver</span></code> for <code class="docutils literal notranslate"><span class="pre">EXTVER</span></code>. Structural keywords are checked
and/or updated as a consequence of common operations. For example, when:</p>
<ol class="arabic simple">
<li><p>Setting the data. The <code class="docutils literal notranslate"><span class="pre">NAXIS*</span></code> keywords are set from the data shape (<code class="docutils literal notranslate"><span class="pre">.data.shape</span></code>), and <code class="docutils literal notranslate"><span class="pre">BITPIX</span></code>
from the data type (<code class="docutils literal notranslate"><span class="pre">.data.dtype</span></code>).</p></li>
<li><p>Setting the header. Its keywords are updated based on the data properties (as above).</p></li>
<li><p>Writing a file. All the necessary keywords are deleted, updated or added to the header.</p></li>
<li><p>Calling an HDU’s verify method (e.g., <a class="reference internal" href="api/hdus.html#astropy.io.fits.PrimaryHDU.verify" title="astropy.io.fits.PrimaryHDU.verify"><code class="xref py py-func docutils literal notranslate"><span class="pre">PrimaryHDU.verify()</span></code></a>). Some keywords can be fixed automatically.</p></li>
</ol>
<p>In these cases any hand-written values users might assign to those keywords will be overwrittten.</p>
</div>
</div>
<div class="section" id="working-with-image-data">
<h4>Working with Image Data<a class="headerlink" href="#working-with-image-data" title="Permalink to this headline">¶</a></h4>
<p>If an HDU’s data is an image, the data attribute of the HDU object will return
a <code class="docutils literal notranslate"><span class="pre">numpy</span></code> <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code></a> object. Refer to the <code class="docutils literal notranslate"><span class="pre">numpy</span></code> documentation for
details on manipulating these numerical arrays:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">hdul</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
<p>Here, <code class="docutils literal notranslate"><span class="pre">data</span></code> points to the data object in the second HDU (the first HDU,
<code class="docutils literal notranslate"><span class="pre">hdul[0]</span></code>, being the primary HDU) which corresponds to the ‘SCI’
extension. Alternatively, you can access the extension by its extension name
(specified in the EXTNAME keyword):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">hdul</span><span class="p">[</span><span class="s1">&#39;SCI&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
<p>If there is more than one extension with the same EXTNAME, the EXTVER value
needs to be specified along with the EXTNAME as a tuple; for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">hdul</span><span class="p">[</span><span class="s1">&#39;sci&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
<p>Note that the EXTNAME is also case-insensitive.</p>
<p>The returned <code class="docutils literal notranslate"><span class="pre">numpy</span></code> object has many attributes and methods for a user to get
information about the array, for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">shape</span>
<span class="go">(40, 40)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;int16&#39;</span>
</pre></div>
</div>
<p>Since image data is a <code class="docutils literal notranslate"><span class="pre">numpy</span></code> object, we can slice it, view it, and perform
mathematical operations on it. To see the pixel value at x=5, y=2:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span>
<span class="go">348</span>
</pre></div>
</div>
<p>Note that, like C (and unlike Fortran), Python is 0-indexed and the indices
have the slowest axis first and fastest changing axis last; that is, for a 2D
image, the fast axis (X-axis) which corresponds to the FITS NAXIS1 keyword, is
the second index. Similarly, the 1-indexed subsection of x=11 to 20
(inclusive) and y=31 to 40 (inclusive) would be given in Python as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="mi">30</span><span class="p">:</span><span class="mi">40</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span><span class="mi">20</span><span class="p">]</span>
<span class="go">array([[350, 349, 349, 348, 349, 348, 349, 347, 350, 348],</span>
<span class="go">       [348, 348, 348, 349, 348, 349, 347, 348, 348, 349],</span>
<span class="go">       [348, 348, 347, 349, 348, 348, 349, 349, 349, 349],</span>
<span class="go">       [349, 348, 349, 349, 350, 349, 349, 347, 348, 348],</span>
<span class="go">       [348, 348, 348, 348, 349, 348, 350, 349, 348, 349],</span>
<span class="go">       [348, 347, 349, 349, 350, 348, 349, 348, 349, 347],</span>
<span class="go">       [347, 348, 347, 348, 349, 349, 350, 349, 348, 348],</span>
<span class="go">       [349, 349, 350, 348, 350, 347, 349, 349, 349, 348],</span>
<span class="go">       [349, 348, 348, 348, 348, 348, 349, 347, 349, 348],</span>
<span class="go">       [349, 349, 349, 348, 350, 349, 349, 350, 348, 350]], dtype=int16)</span>
</pre></div>
</div>
<p>To update the value of a pixel or a subsection:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="mi">30</span><span class="p">:</span><span class="mi">40</span><span class="p">,</span> <span class="mi">10</span><span class="p">:</span><span class="mi">20</span><span class="p">]</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span> <span class="o">=</span> <span class="mi">999</span>
</pre></div>
</div>
<p>This example changes the values of both the pixel [1, 4] and the subsection
[30:40, 10:20] to the new value of 999. See the <a class="reference external" href="https://numpy.org/doc/stable/reference/arrays.indexing.html">Numpy documentation</a> for
more details on Python-style array indexing and slicing.</p>
<p>The next example of array manipulation is to convert the image data from counts
to flux:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">photflam</span> <span class="o">=</span> <span class="n">hdul</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;photflam&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exptime</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;exptime&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">data</span> <span class="o">*</span> <span class="n">photflam</span> <span class="o">/</span> <span class="n">exptime</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdul</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Note that performing an operation like this on an entire image requires holding
the entire image in memory. This example performs the multiplication in-place
so that no copies are made, but the original image must first be able to fit in
main memory. For most observations this should not be an issue on modern
personal computers.</p>
<p>If at this point you want to preserve all of the changes you made and write it
to a new file, you can use the <a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList.writeto" title="astropy.io.fits.HDUList.writeto"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HDUList.writeto()</span></code></a> method (see below).</p>
<div class="topic">
<p class="topic-title">Examples:</p>
<p>See also <a class="reference internal" href="../../generated/examples/io/plot_fits-image.html#sphx-glr-generated-examples-io-plot-fits-image-py"><span class="std std-ref">Read and plot an image from a FITS file</span></a>.</p>
</div>
</div>
<div class="section" id="working-with-table-data">
<h4>Working with Table Data<a class="headerlink" href="#working-with-table-data" title="Permalink to this headline">¶</a></h4>
<p>This section describes reading and writing table data in the FITS format using
the <a class="reference internal" href="#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fits</span></code></a> package directly. For some cases, however, the
high-level <a class="reference internal" href="../unified.html#table-io"><span class="std std-ref">Unified File Read/Write Interface</span></a> will often suffice and is somewhat more convenient
to use. See the <a class="reference internal" href="../unified.html#table-io-fits"><span class="std std-ref">Unified I/O FITS</span></a> section for details.</p>
<p>Like images, the data portion of a FITS table extension is in the <code class="docutils literal notranslate"><span class="pre">.data</span></code>
attribute:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fits_table_filename</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">get_testdata_filepath</span><span class="p">(</span><span class="s1">&#39;tb.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdul</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fits_table_filename</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">hdul</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span> <span class="c1"># assuming the first extension is a table</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdul</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>If you are familiar with <code class="docutils literal notranslate"><span class="pre">numpy</span></code> <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.recarray.html#numpy.recarray" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">recarray</span></code></a> (record array) objects, you
will find the table data is basically a record array with some extra
properties. But familiarity with record arrays is not a prerequisite for this
guide.</p>
<p>To see the first row of the table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="go">(1, &#39;abc&#39;, 3.7000000715255736, False)</span>
</pre></div>
</div>
<p>Each row in the table is a <a class="reference internal" href="api/tables.html#astropy.io.fits.FITS_record" title="astropy.io.fits.FITS_record"><code class="xref py py-class docutils literal notranslate"><span class="pre">FITS_record</span></code></a> object which looks like a
(Python) tuple containing elements of heterogeneous data types. In this
example: an integer, a string, a floating point number, and a Boolean value. So
the table data are just an array of such records. More commonly, a user is
likely to access the data in a column-wise way. This is accomplished by using
the <a class="reference internal" href="api/tables.html#astropy.io.fits.FITS_rec.field" title="astropy.io.fits.FITS_rec.field"><code class="xref py py-meth docutils literal notranslate"><span class="pre">field()</span></code></a> method. To get the first column (or “field” in
NumPy parlance — it is used here interchangeably with “column”) of the table,
use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="go">array([1, 2]...)</span>
</pre></div>
</div>
<p>A <code class="docutils literal notranslate"><span class="pre">numpy</span></code> object with the data type of the specified field is returned.</p>
<p>Like header keywords, a column can be referred either by index, as above, or by
name:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="s1">&#39;c1&#39;</span><span class="p">)</span>
<span class="go">array([1, 2]...)</span>
</pre></div>
</div>
<p>When accessing a column by name, dict-like access is also possible (and even
preferable):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;c1&#39;</span><span class="p">]</span>
<span class="go">array([1, 2]...)</span>
</pre></div>
</div>
<p>In most cases it is preferable to access columns by their name, as the column
name is entirely independent of its physical order in the table. As with
header keywords, column names are case-insensitive.</p>
<p>But how do we know what columns we have in a table? First, we will introduce
another attribute of the table HDU: the <a class="reference internal" href="api/tables.html#astropy.io.fits.BinTableHDU.columns" title="astropy.io.fits.BinTableHDU.columns"><code class="xref py py-attr docutils literal notranslate"><span class="pre">columns</span></code></a>
attribute:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cols</span> <span class="o">=</span> <span class="n">hdul</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span>
</pre></div>
</div>
<p>This attribute is a <a class="reference internal" href="api/tables.html#astropy.io.fits.ColDefs" title="astropy.io.fits.ColDefs"><code class="xref py py-class docutils literal notranslate"><span class="pre">ColDefs</span></code></a> (column definitions) object. If we use the
<a class="reference internal" href="api/tables.html#astropy.io.fits.ColDefs.info" title="astropy.io.fits.ColDefs.info"><code class="xref py py-meth docutils literal notranslate"><span class="pre">ColDefs.info()</span></code></a> method from the interactive prompt:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cols</span><span class="o">.</span><span class="n">info</span><span class="p">()</span>
<span class="go">name:</span>
<span class="go">    [&#39;c1&#39;, &#39;c2&#39;, &#39;c3&#39;, &#39;c4&#39;]</span>
<span class="go">format:</span>
<span class="go">    [&#39;1J&#39;, &#39;3A&#39;, &#39;1E&#39;, &#39;1L&#39;]</span>
<span class="go">unit:</span>
<span class="go">    [&#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]</span>
<span class="go">null:</span>
<span class="go">    [-2147483647, &#39;&#39;, &#39;&#39;, &#39;&#39;]</span>
<span class="go">bscale:</span>
<span class="go">    [&#39;&#39;, &#39;&#39;, 3, &#39;&#39;]</span>
<span class="go">bzero:</span>
<span class="go">    [&#39;&#39;, &#39;&#39;, 0.4, &#39;&#39;]</span>
<span class="go">disp:</span>
<span class="go">    [&#39;I11&#39;, &#39;A3&#39;, &#39;G15.7&#39;, &#39;L6&#39;]</span>
<span class="go">start:</span>
<span class="go">    [&#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]</span>
<span class="go">dim:</span>
<span class="go">    [&#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]</span>
<span class="go">coord_type:</span>
<span class="go">    [&#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]</span>
<span class="go">coord_unit:</span>
<span class="go">    [&#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]</span>
<span class="go">coord_ref_point:</span>
<span class="go">    [&#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]</span>
<span class="go">coord_ref_value:</span>
<span class="go">    [&#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]</span>
<span class="go">coord_inc:</span>
<span class="go">    [&#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]</span>
<span class="go">time_ref_pos:</span>
<span class="go">    [&#39;&#39;, &#39;&#39;, &#39;&#39;, &#39;&#39;]</span>
</pre></div>
</div>
<p>it will show the attributes of all columns in the table, such as their names,
formats, bscales, bzeros, etc. A similar output that will display the column
names and their formats can be printed from within a script with:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hdul</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span>
<span class="go">ColDefs(</span>
<span class="go">    name = &#39;c1&#39;; format = &#39;1J&#39;; null = -2147483647; disp = &#39;I11&#39;</span>
<span class="go">    name = &#39;c2&#39;; format = &#39;3A&#39;; disp = &#39;A3&#39;</span>
<span class="go">    name = &#39;c3&#39;; format = &#39;1E&#39;; bscale = 3; bzero = 0.4; disp = &#39;G15.7&#39;</span>
<span class="go">    name = &#39;c4&#39;; format = &#39;1L&#39;; disp = &#39;L6&#39;</span>
<span class="go">)</span>
</pre></div>
</div>
<p>We can also get these properties individually; for example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cols</span><span class="o">.</span><span class="n">names</span>
<span class="go">[&#39;c1&#39;, &#39;c2&#39;, &#39;c3&#39;, &#39;c4&#39;]</span>
</pre></div>
</div>
<p>returns a (Python) list of field names.</p>
<p>Since each field is a <code class="docutils literal notranslate"><span class="pre">numpy</span></code> object, we will have the entire arsenal of
<code class="docutils literal notranslate"><span class="pre">numpy</span></code> tools to use. We can reassign (update) the values:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;c4&#39;</span><span class="p">][:]</span> <span class="o">=</span> <span class="mi">0</span>
</pre></div>
</div>
<p>take the mean of a column:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;c3&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>  
<span class="go">5.19999989271164</span>
</pre></div>
</div>
<p>and so on.</p>
<div class="topic">
<p class="topic-title">Examples:</p>
<p>See also <a class="reference internal" href="../../generated/examples/io/fits-tables.html#sphx-glr-generated-examples-io-fits-tables-py"><span class="std std-ref">Accessing data stored as a table in a multi-extension FITS (MEF) file</span></a>.</p>
</div>
</div>
<div class="section" id="save-file-changes">
<h4>Save File Changes<a class="headerlink" href="#save-file-changes" title="Permalink to this headline">¶</a></h4>
<p>As mentioned earlier, after a user opened a file, made a few changes to either
header or data, the user can use <a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList.writeto" title="astropy.io.fits.HDUList.writeto"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HDUList.writeto()</span></code></a> to save the changes.
This takes the version of headers and data in memory and writes them to a new
FITS file on disk. Subsequent operations can be performed to the data in memory
and written out to yet another different file, all without recopying the
original data to (more) memory:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hdul</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s1">&#39;newtable.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>will write the current content of <code class="docutils literal notranslate"><span class="pre">hdulist</span></code> to a new disk file newfile.fits.
If a file was opened with the update mode, the <a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList.flush" title="astropy.io.fits.HDUList.flush"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HDUList.flush()</span></code></a> method can
also be used to write all of the changes made since <a class="reference internal" href="api/files.html#astropy.io.fits.open" title="astropy.io.fits.open"><code class="xref py py-func docutils literal notranslate"><span class="pre">open()</span></code></a>, back to the
original file. The <a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList.close" title="astropy.io.fits.HDUList.close"><code class="xref py py-meth docutils literal notranslate"><span class="pre">close()</span></code></a> method will do the same for a FITS
file opened with update mode:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s1">&#39;original.fits&#39;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s1">&#39;update&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdul</span><span class="p">:</span>
    <span class="c1"># Change something in hdul.</span>
    <span class="n">hdul</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>  <span class="c1"># changes are written back to original.fits</span>

<span class="c1"># closing the file will also flush any changes and prevent further writing</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="creating-a-new-fits-file">
<h3>Creating a New FITS File<a class="headerlink" href="#creating-a-new-fits-file" title="Permalink to this headline">¶</a></h3>
<div class="section" id="creating-a-new-image-file">
<h4>Creating a New Image File<a class="headerlink" href="#creating-a-new-image-file" title="Permalink to this headline">¶</a></h4>
<p>So far we have demonstrated how to read and update an existing FITS file. But
how about creating a new FITS file from scratch? Such tasks are very convenient
in <code class="docutils literal notranslate"><span class="pre">astropy</span></code> for an image HDU. We will first demonstrate how to create a FITS
file consisting of only the primary HDU with image data.</p>
<p>First, we create a <code class="docutils literal notranslate"><span class="pre">numpy</span></code> object for the data part:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">100.0</span><span class="p">)</span> <span class="c1"># a simple sequence of floats from 0.0 to 99.9</span>
</pre></div>
</div>
<p>Next, we create a <a class="reference internal" href="api/hdus.html#astropy.io.fits.PrimaryHDU" title="astropy.io.fits.PrimaryHDU"><code class="xref py py-class docutils literal notranslate"><span class="pre">PrimaryHDU</span></code></a> object to encapsulate the data:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">PrimaryHDU</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
<p>We then create an <a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList" title="astropy.io.fits.HDUList"><code class="xref py py-class docutils literal notranslate"><span class="pre">HDUList</span></code></a> to contain the newly created primary HDU, and write to
a new file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hdul</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">HDUList</span><span class="p">([</span><span class="n">hdu</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdul</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s1">&#39;new1.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>That is it! In fact, <code class="docutils literal notranslate"><span class="pre">astropy</span></code> even provides a shortcut for the last two
lines to accomplish the same behavior:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hdu</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s1">&#39;new2.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This will write a single HDU to a FITS file without having to manually
encapsulate it in an <a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList" title="astropy.io.fits.HDUList"><code class="xref py py-class docutils literal notranslate"><span class="pre">HDUList</span></code></a> object first.</p>
</div>
<div class="section" id="creating-a-new-table-file">
<h4>Creating a New Table File<a class="headerlink" href="#creating-a-new-table-file" title="Permalink to this headline">¶</a></h4>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to create a <strong>binary</strong> FITS table with no other HDUs,
you can use <a class="reference internal" href="../../api/astropy.table.Table.html#astropy.table.Table" title="astropy.table.Table"><code class="xref py py-class docutils literal notranslate"><span class="pre">Table</span></code></a> instead and then write to FITS.
This is less complicated than “lower-level” FITS interface:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.table</span> <span class="kn">import</span> <span class="n">Table</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">Table</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]],</span> <span class="n">names</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="s1">&#39;c&#39;</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="s1">&#39;table1.fits&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>The equivalent code using <code class="docutils literal notranslate"><span class="pre">astropy.io.fits</span></code> would look like this:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c1</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;K&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c2</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;K&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c3</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]),</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;K&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">BinTableHDU</span><span class="o">.</span><span class="n">from_columns</span><span class="p">([</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s1">&#39;table2.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>To create a table HDU is a little more involved than an image HDU, because a
table’s structure needs more information. First of all, tables can only be an
extension HDU, not a primary. There are two kinds of FITS table extensions:
ASCII and binary. We will use binary table examples here.</p>
<p>To create a table from scratch, we need to define columns first, by
constructing the <a class="reference internal" href="api/tables.html#astropy.io.fits.Column" title="astropy.io.fits.Column"><code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code></a> objects and their data. Suppose we have two
columns, the first containing strings, and the second containing floating point
numbers:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;NGC1001&#39;</span><span class="p">,</span> <span class="s1">&#39;NGC1002&#39;</span><span class="p">,</span> <span class="s1">&#39;NGC1003&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">a2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">11.1</span><span class="p">,</span> <span class="mf">12.3</span><span class="p">,</span> <span class="mf">15.2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">col1</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;20A&#39;</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="n">a1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">col2</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;V_mag&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="n">a2</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>It is not necessary to create a <a class="reference internal" href="api/tables.html#astropy.io.fits.Column" title="astropy.io.fits.Column"><code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code></a> object explicitly
if the data is stored in a
<a class="reference external" href="https://numpy.org/doc/stable/user/basics.rec.html">structured array</a>.</p>
</div>
<p>Next, create a <a class="reference internal" href="api/tables.html#astropy.io.fits.ColDefs" title="astropy.io.fits.ColDefs"><code class="xref py py-class docutils literal notranslate"><span class="pre">ColDefs</span></code></a> (column-definitions) object for all columns:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">cols</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">ColDefs</span><span class="p">([</span><span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="p">])</span>
</pre></div>
</div>
<p>Now, create a new binary table HDU object by using the
<a class="reference internal" href="api/tables.html#astropy.io.fits.BinTableHDU.from_columns" title="astropy.io.fits.BinTableHDU.from_columns"><code class="xref py py-func docutils literal notranslate"><span class="pre">BinTableHDU.from_columns()</span></code></a> function:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">BinTableHDU</span><span class="o">.</span><span class="n">from_columns</span><span class="p">(</span><span class="n">cols</span><span class="p">)</span>
</pre></div>
</div>
<p>This function returns (in this case) a <a class="reference internal" href="api/tables.html#astropy.io.fits.BinTableHDU" title="astropy.io.fits.BinTableHDU"><code class="xref py py-class docutils literal notranslate"><span class="pre">BinTableHDU</span></code></a>.</p>
<p>The data structure used to represent FITS tables is called a <a class="reference internal" href="api/tables.html#astropy.io.fits.FITS_rec" title="astropy.io.fits.FITS_rec"><code class="xref py py-class docutils literal notranslate"><span class="pre">FITS_rec</span></code></a>
and is derived from the <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.recarray.html#numpy.recarray" title="(in NumPy v1.22)"><code class="xref py py-class docutils literal notranslate"><span class="pre">numpy.recarray</span></code></a> interface. When creating
a new table HDU the individual column arrays will be assembled into a single
<a class="reference internal" href="api/tables.html#astropy.io.fits.FITS_rec" title="astropy.io.fits.FITS_rec"><code class="xref py py-class docutils literal notranslate"><span class="pre">FITS_rec</span></code></a> array.</p>
<p>You can create a <a class="reference internal" href="api/tables.html#astropy.io.fits.BinTableHDU" title="astropy.io.fits.BinTableHDU"><code class="xref py py-class docutils literal notranslate"><span class="pre">BinTableHDU</span></code></a> more concisely without creating intermediate
variables for the individual columns and without manually creating a
<a class="reference internal" href="api/tables.html#astropy.io.fits.ColDefs" title="astropy.io.fits.ColDefs"><code class="xref py py-class docutils literal notranslate"><span class="pre">ColDefs</span></code></a> object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">BinTableHDU</span><span class="o">.</span><span class="n">from_columns</span><span class="p">(</span>
<span class="gp">... </span>    <span class="p">[</span><span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;20A&#39;</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="n">a1</span><span class="p">),</span>
<span class="gp">... </span>     <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;V_mag&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;E&#39;</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="n">a2</span><span class="p">)])</span>
</pre></div>
</div>
<p>Now you may write this new table HDU directly to a FITS file like so:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hdu</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s1">&#39;table3.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>This shortcut will automatically create a minimal primary HDU with no data and
prepend it to the table HDU to create a valid FITS file. If you require
additional data or header keywords in the primary HDU you may still create a
<a class="reference internal" href="api/hdus.html#astropy.io.fits.PrimaryHDU" title="astropy.io.fits.PrimaryHDU"><code class="xref py py-class docutils literal notranslate"><span class="pre">PrimaryHDU</span></code></a> object and build up the FITS file manually using an
<a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList" title="astropy.io.fits.HDUList"><code class="xref py py-class docutils literal notranslate"><span class="pre">HDUList</span></code></a>, as described in the next section.</p>
</div>
<div class="section" id="creating-a-file-with-multiple-extensions">
<h4>Creating a File with Multiple Extensions<a class="headerlink" href="#creating-a-file-with-multiple-extensions" title="Permalink to this headline">¶</a></h4>
<p>In the previous examples we created files with a single meaningful extension (a
<a class="reference internal" href="api/hdus.html#astropy.io.fits.PrimaryHDU" title="astropy.io.fits.PrimaryHDU"><code class="xref py py-class docutils literal notranslate"><span class="pre">PrimaryHDU</span></code></a> or <a class="reference internal" href="api/tables.html#astropy.io.fits.BinTableHDU" title="astropy.io.fits.BinTableHDU"><code class="xref py py-class docutils literal notranslate"><span class="pre">BinTableHDU</span></code></a>). To create a file with multiple
extensions we need to create extension HDUs and append them to an <a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList" title="astropy.io.fits.HDUList"><code class="xref py py-class docutils literal notranslate"><span class="pre">HDUList</span></code></a>.</p>
<p>First, we create some data for Image extensions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">100</span><span class="p">,</span> <span class="mi">100</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">n3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
<p>Note that the data shapes of the different extensions do not need to be the same.
Next, place the data into separate <a class="reference internal" href="api/hdus.html#astropy.io.fits.PrimaryHDU" title="astropy.io.fits.PrimaryHDU"><code class="xref py py-class docutils literal notranslate"><span class="pre">PrimaryHDU</span></code></a> and <a class="reference internal" href="api/images.html#astropy.io.fits.ImageHDU" title="astropy.io.fits.ImageHDU"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageHDU</span></code></a>
objects:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">primary_hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">PrimaryHDU</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">ImageHDU</span><span class="p">(</span><span class="n">n2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image_hdu2</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">ImageHDU</span><span class="p">(</span><span class="n">n3</span><span class="p">)</span>
</pre></div>
</div>
<p>A multi-extension FITS file is not constrained to be only imaging or table data, we
can mix them. To show this we’ll use the example from the previous section to make a
<a class="reference internal" href="api/tables.html#astropy.io.fits.BinTableHDU" title="astropy.io.fits.BinTableHDU"><code class="xref py py-class docutils literal notranslate"><span class="pre">BinTableHDU</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c1</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;a&#39;</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]),</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;K&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c2</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;b&#39;</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">]),</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;K&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">c3</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;c&#39;</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]),</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;K&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">table_hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">BinTableHDU</span><span class="o">.</span><span class="n">from_columns</span><span class="p">([</span><span class="n">c1</span><span class="p">,</span> <span class="n">c2</span><span class="p">,</span> <span class="n">c3</span><span class="p">])</span>
</pre></div>
</div>
<p>Now when we create the <a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList" title="astropy.io.fits.HDUList"><code class="xref py py-class docutils literal notranslate"><span class="pre">HDUList</span></code></a> we list all extensions we want to
include:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hdul</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">HDUList</span><span class="p">([</span><span class="n">primary_hdu</span><span class="p">,</span> <span class="n">image_hdu</span><span class="p">,</span> <span class="n">table_hdu</span><span class="p">])</span>
</pre></div>
</div>
<p>Because <a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList" title="astropy.io.fits.HDUList"><code class="xref py py-class docutils literal notranslate"><span class="pre">HDUList</span></code></a> acts like a <a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.10)"><code class="xref py py-class docutils literal notranslate"><span class="pre">list</span></code></a> we can also append, for example,
an <a class="reference internal" href="api/images.html#astropy.io.fits.ImageHDU" title="astropy.io.fits.ImageHDU"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageHDU</span></code></a> to an already existing <a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList" title="astropy.io.fits.HDUList"><code class="xref py py-class docutils literal notranslate"><span class="pre">HDUList</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hdul</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">image_hdu2</span><span class="p">)</span>
</pre></div>
</div>
<p>Multi-extension <a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList" title="astropy.io.fits.HDUList"><code class="xref py py-class docutils literal notranslate"><span class="pre">HDUList</span></code></a> are treated just like those with only a
<a class="reference internal" href="api/hdus.html#astropy.io.fits.PrimaryHDU" title="astropy.io.fits.PrimaryHDU"><code class="xref py py-class docutils literal notranslate"><span class="pre">PrimaryHDU</span></code></a>, so to save the file use <a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList.writeto" title="astropy.io.fits.HDUList.writeto"><code class="xref py py-func docutils literal notranslate"><span class="pre">HDUList.writeto()</span></code></a> as shown above.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The FITS standard enforces all files to have exactly one <a class="reference internal" href="api/hdus.html#astropy.io.fits.PrimaryHDU" title="astropy.io.fits.PrimaryHDU"><code class="xref py py-class docutils literal notranslate"><span class="pre">PrimaryHDU</span></code></a> that
is the first HDU present in the file. This standard is enforced during the call to
<a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList.writeto" title="astropy.io.fits.HDUList.writeto"><code class="xref py py-func docutils literal notranslate"><span class="pre">HDUList.writeto()</span></code></a> and an error will be raised if it is not met. See the
<code class="docutils literal notranslate"><span class="pre">output_verify</span></code> option in <a class="reference internal" href="api/hdulists.html#astropy.io.fits.HDUList.writeto" title="astropy.io.fits.HDUList.writeto"><code class="xref py py-func docutils literal notranslate"><span class="pre">HDUList.writeto()</span></code></a> for ways to fix or ignore these
warnings.</p>
</div>
<p>In the previous example the <a class="reference internal" href="api/hdus.html#astropy.io.fits.PrimaryHDU" title="astropy.io.fits.PrimaryHDU"><code class="xref py py-class docutils literal notranslate"><span class="pre">PrimaryHDU</span></code></a> contained actual data. In some cases it
is desirable to have a minimal <a class="reference internal" href="api/hdus.html#astropy.io.fits.PrimaryHDU" title="astropy.io.fits.PrimaryHDU"><code class="xref py py-class docutils literal notranslate"><span class="pre">PrimaryHDU</span></code></a> with only basic header information.
To do this, first create a new <a class="reference internal" href="api/headers.html#astropy.io.fits.Header" title="astropy.io.fits.Header"><code class="xref py py-class docutils literal notranslate"><span class="pre">Header</span></code></a> object to encapsulate any keywords you want
to include in the primary HDU, then as before create a <a class="reference internal" href="api/hdus.html#astropy.io.fits.PrimaryHDU" title="astropy.io.fits.PrimaryHDU"><code class="xref py py-class docutils literal notranslate"><span class="pre">PrimaryHDU</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">Header</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;OBSERVER&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;Edwin Hubble&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;COMMENT&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Here&#39;s some commentary about this FITS file.&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">empty_primary</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">PrimaryHDU</span><span class="p">(</span><span class="n">header</span><span class="o">=</span><span class="n">hdr</span><span class="p">)</span>
</pre></div>
</div>
<p>When we create a new primary HDU with a custom header as in the above example,
this will automatically include any additional header keywords that are
<em>required</em> by the FITS format (keywords such as <code class="docutils literal notranslate"><span class="pre">SIMPLE</span></code> and <code class="docutils literal notranslate"><span class="pre">NAXIS</span></code> for
example). In general, users should not have to manually manage such keywords,
and should only create and modify observation-specific informational keywords.</p>
<p>We then create an HDUList containing both the primary HDU and any other HDUs want:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hdul</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">HDUList</span><span class="p">([</span><span class="n">empty_primary</span><span class="p">,</span> <span class="n">image_hdu2</span><span class="p">,</span> <span class="n">table_hdu</span><span class="p">])</span>
</pre></div>
</div>
<div class="topic">
<p class="topic-title">Examples:</p>
<p>See also <a class="reference internal" href="../../generated/examples/io/create-mef.html#sphx-glr-generated-examples-io-create-mef-py"><span class="std std-ref">Create a multi-extension FITS (MEF) file from scratch</span></a>.</p>
</div>
</div>
</div>
<div class="section" id="convenience-functions">
<h3>Convenience Functions<a class="headerlink" href="#convenience-functions" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits</span></code></a> also provides several high-level (“convenience”) functions.
Such a convenience function is a “canned” operation to achieve one task.
By using these “convenience” functions, a user does not have to worry about
opening or closing a file; all of the housekeeping is done implicitly.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>These functions are useful for interactive Python sessions and less complex
analysis scripts, but should not be used for application code, as they
are highly inefficient. For example, each call to <a class="reference internal" href="api/files.html#astropy.io.fits.getval" title="astropy.io.fits.getval"><code class="xref py py-func docutils literal notranslate"><span class="pre">getval()</span></code></a>
requires re-parsing the entire FITS file. Code that makes repeated use
of these functions should instead open the file with <a class="reference internal" href="api/files.html#astropy.io.fits.open" title="astropy.io.fits.open"><code class="xref py py-func docutils literal notranslate"><span class="pre">open()</span></code></a>
and access the data structures directly.</p>
</div>
<p>The first of these functions is <a class="reference internal" href="api/files.html#astropy.io.fits.getheader" title="astropy.io.fits.getheader"><code class="xref py py-func docutils literal notranslate"><span class="pre">getheader()</span></code></a>, to get the header of an HDU.
Here are several examples of getting the header. Only the file name is required
for this function. The rest of the arguments are optional and flexible to
specify which HDU the user wants to access:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io.fits</span> <span class="kn">import</span> <span class="n">getheader</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span> <span class="o">=</span> <span class="n">getheader</span><span class="p">(</span><span class="n">fits_image_filename</span><span class="p">)</span>  <span class="c1"># get default HDU (=0), i.e. primary HDU&#39;s header</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span> <span class="o">=</span> <span class="n">getheader</span><span class="p">(</span><span class="n">fits_image_filename</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>  <span class="c1"># get primary HDU&#39;s header</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span> <span class="o">=</span> <span class="n">getheader</span><span class="p">(</span><span class="n">fits_image_filename</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># the second extension</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span> <span class="o">=</span> <span class="n">getheader</span><span class="p">(</span><span class="n">fits_image_filename</span><span class="p">,</span> <span class="s1">&#39;sci&#39;</span><span class="p">)</span>  <span class="c1"># the first HDU with EXTNAME=&#39;SCI&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span> <span class="o">=</span> <span class="n">getheader</span><span class="p">(</span><span class="n">fits_image_filename</span><span class="p">,</span> <span class="s1">&#39;sci&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>  <span class="c1"># HDU with EXTNAME=&#39;SCI&#39; and EXTVER=2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span> <span class="o">=</span> <span class="n">getheader</span><span class="p">(</span><span class="n">fits_image_filename</span><span class="p">,</span> <span class="p">(</span><span class="s1">&#39;sci&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>  <span class="c1"># use a tuple to do the same</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span> <span class="o">=</span> <span class="n">getheader</span><span class="p">(</span><span class="n">fits_image_filename</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># the second extension</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span> <span class="o">=</span> <span class="n">getheader</span><span class="p">(</span><span class="n">fits_image_filename</span><span class="p">,</span> <span class="n">extname</span><span class="o">=</span><span class="s1">&#39;sci&#39;</span><span class="p">)</span>  <span class="c1"># first HDU with EXTNAME=&#39;SCI&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span> <span class="o">=</span> <span class="n">getheader</span><span class="p">(</span><span class="n">fits_image_filename</span><span class="p">,</span> <span class="n">extname</span><span class="o">=</span><span class="s1">&#39;sci&#39;</span><span class="p">,</span> <span class="n">extver</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>Ambiguous specifications will raise an exception:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">getheader</span><span class="p">(</span><span class="n">fits_image_filename</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;sci&#39;</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">extname</span><span class="o">=</span><span class="s1">&#39;err&#39;</span><span class="p">,</span> <span class="n">extver</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">TypeError</span>: <span class="n">Redundant/conflicting extension arguments(s): ...</span>
</pre></div>
</div>
<p>After you get the header, you can access the information in it, such as getting
and modifying a keyword value:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fits_image_2_filename</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">get_testdata_filepath</span><span class="p">(</span><span class="s1">&#39;o4sp040b0_raw.fits&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span> <span class="o">=</span> <span class="n">getheader</span><span class="p">(</span><span class="n">fits_image_2_filename</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>    <span class="c1"># get primary hdu&#39;s header</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">filter</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;filter&#39;</span><span class="p">]</span>                       <span class="c1"># get the value of the keyword &quot;filter&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">val</span> <span class="o">=</span> <span class="n">hdr</span><span class="p">[</span><span class="mi">10</span><span class="p">]</span>                                <span class="c1"># get the 11th keyword&#39;s value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdr</span><span class="p">[</span><span class="s1">&#39;filter&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;FW555&#39;</span>                      <span class="c1"># change the keyword value</span>
</pre></div>
</div>
<p>For the header keywords, the header is like a dictionary, as well as a list.
The user can access the keywords either by name or by numeric index, as
explained earlier in this chapter.</p>
<p>If a user only needs to read one keyword, the  <a class="reference internal" href="api/files.html#astropy.io.fits.getval" title="astropy.io.fits.getval"><code class="xref py py-func docutils literal notranslate"><span class="pre">getval()</span></code></a> function can
further simplify to just one call, instead of two as shown in the above
examples:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io.fits</span> <span class="kn">import</span> <span class="n">getval</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># get 0th extension&#39;s keyword FILTER&#39;s value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flt</span> <span class="o">=</span> <span class="n">getval</span><span class="p">(</span><span class="n">fits_image_2_filename</span><span class="p">,</span> <span class="s1">&#39;filter&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">flt</span>
<span class="go">&#39;Clear&#39;</span>

<span class="gp">&gt;&gt;&gt; </span><span class="c1"># get the 2nd sci extension&#39;s 11th keyword&#39;s value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">val</span> <span class="o">=</span> <span class="n">getval</span><span class="p">(</span><span class="n">fits_image_2_filename</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="s1">&#39;sci&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">val</span>
<span class="go">False</span>
</pre></div>
</div>
<p>The function <a class="reference internal" href="api/files.html#astropy.io.fits.getdata" title="astropy.io.fits.getdata"><code class="xref py py-func docutils literal notranslate"><span class="pre">getdata()</span></code></a> gets the data of an HDU. Similar to
<a class="reference internal" href="api/files.html#astropy.io.fits.getheader" title="astropy.io.fits.getheader"><code class="xref py py-func docutils literal notranslate"><span class="pre">getheader()</span></code></a>, it only requires the input FITS file name while the
extension is specified through the optional arguments. It does have one extra
optional argument header. If header is set to True, this function will return
both data and header, otherwise only data is returned:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io.fits</span> <span class="kn">import</span> <span class="n">getdata</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># get 3rd sci extension&#39;s data:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="n">fits_image_filename</span><span class="p">,</span> <span class="s1">&#39;sci&#39;</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># get 1st extension&#39;s data AND header:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="p">,</span> <span class="n">hdr</span> <span class="o">=</span> <span class="n">getdata</span><span class="p">(</span><span class="n">fits_image_filename</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<p>The functions introduced above are for reading. The next few functions
demonstrate convenience functions for writing:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fits</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s1">&#39;out.fits&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">hdr</span><span class="p">)</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="api/files.html#astropy.io.fits.writeto" title="astropy.io.fits.writeto"><code class="xref py py-func docutils literal notranslate"><span class="pre">writeto()</span></code></a> function uses the provided data and an optional header to
write to an output FITS file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fits</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;out.fits&#39;</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="n">hdr</span><span class="p">)</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="api/files.html#astropy.io.fits.append" title="astropy.io.fits.append"><code class="xref py py-func docutils literal notranslate"><span class="pre">append()</span></code></a> function will use the provided data and the optional header
to append to an existing FITS file. If the specified output file does not
exist, it will create one.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">astropy.io.fits</span> <span class="kn">import</span> <span class="n">update</span>
<span class="n">update</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">dat</span><span class="p">,</span> <span class="n">hdr</span><span class="p">,</span> <span class="s1">&#39;sci&#39;</span><span class="p">)</span>         <span class="c1"># update the &#39;sci&#39; extension</span>
<span class="n">update</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">dat</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>                  <span class="c1"># update the 3rd extension</span>
<span class="n">update</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">dat</span><span class="p">,</span> <span class="n">hdr</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>             <span class="c1"># update the 3rd extension</span>
<span class="n">update</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">dat</span><span class="p">,</span> <span class="s1">&#39;sci&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>           <span class="c1"># update the 2nd SCI extension</span>
<span class="n">update</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">dat</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">hdr</span><span class="p">)</span>      <span class="c1"># update the 3rd extension</span>
<span class="n">update</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">dat</span><span class="p">,</span> <span class="n">header</span><span class="o">=</span><span class="n">hdr</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>  <span class="c1"># update the 5th extension</span>
</pre></div>
</div>
<p>The <a class="reference internal" href="api/files.html#astropy.io.fits.update" title="astropy.io.fits.update"><code class="xref py py-func docutils literal notranslate"><span class="pre">update()</span></code></a> function will update the specified extension with the input
data/header. The third argument can be the header associated with the data. If
the third argument is not a header, it (and other positional arguments) are
assumed to be the extension specification(s). Header and extension specs can
also be keyword arguments.</p>
<p>The <a class="reference internal" href="api/files.html#astropy.io.fits.printdiff" title="astropy.io.fits.printdiff"><code class="xref py py-func docutils literal notranslate"><span class="pre">printdiff()</span></code></a> function will print a difference report of two FITS files,
including headers and data. The first two arguments must be two FITS
filenames or FITS file objects with matching data types (i.e., if using strings
to specify filenames, both inputs must be strings). The third
argument is an optional extension specification, with the same call format
of <a class="reference internal" href="api/files.html#astropy.io.fits.getheader" title="astropy.io.fits.getheader"><code class="xref py py-func docutils literal notranslate"><span class="pre">getheader()</span></code></a> and <a class="reference internal" href="api/files.html#astropy.io.fits.getdata" title="astropy.io.fits.getdata"><code class="xref py py-func docutils literal notranslate"><span class="pre">getdata()</span></code></a>. In addition you can add any keywords
accepted by the <a class="reference internal" href="api/diff.html#astropy.io.fits.FITSDiff" title="astropy.io.fits.FITSDiff"><code class="xref py py-class docutils literal notranslate"><span class="pre">FITSDiff</span></code></a> class.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">astropy.io.fits</span> <span class="kn">import</span> <span class="n">printdiff</span>
<span class="c1"># get a difference report of ext 2 of inA and inB</span>
<span class="n">printdiff</span><span class="p">(</span><span class="s1">&#39;inA.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;inB.fits&#39;</span><span class="p">,</span> <span class="n">ext</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="c1"># ignore HISTORY and COMMENT keywords</span>
<span class="n">printdiff</span><span class="p">(</span><span class="s1">&#39;inA.fits&#39;</span><span class="p">,</span> <span class="s1">&#39;inB.fits&#39;</span><span class="p">,</span> <span class="n">ignore_keywords</span><span class="o">=</span><span class="p">(</span><span class="s1">&#39;HISTORY&#39;</span><span class="p">,</span><span class="s1">&#39;COMMENT&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Finally, the <a class="reference internal" href="api/files.html#astropy.io.fits.info" title="astropy.io.fits.info"><code class="xref py py-func docutils literal notranslate"><span class="pre">info()</span></code></a> function will print out information of the specified
FITS file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fits</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">fits_image_filename</span><span class="p">)</span>
<span class="go">Filename: ...test0.fits</span>
<span class="go">No.    Name      Ver    Type      Cards   Dimensions   Format</span>
<span class="go">  0  PRIMARY       1 PrimaryHDU     138   ()</span>
<span class="go">  1  SCI           1 ImageHDU        61   (40, 40)   int16</span>
<span class="go">  2  SCI           2 ImageHDU        61   (40, 40)   int16</span>
<span class="go">  3  SCI           3 ImageHDU        61   (40, 40)   int16</span>
<span class="go">  4  SCI           4 ImageHDU        61   (40, 40)   int16</span>
</pre></div>
</div>
<p>This is one of the most useful convenience functions for getting an overview of
what a given file contains without looking at any of the details.</p>
</div>
</div>
<div class="section" id="using-astropy-io-fits">
<h2>Using <a class="reference internal" href="#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits</span></code></a><a class="headerlink" href="#using-astropy-io-fits" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="usage/headers.html">FITS Headers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="usage/headers.html#header-of-an-hdu">Header of an HDU</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/headers.html#the-header-attribute">The Header Attribute</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/headers.html#card-images">Card Images</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/headers.html#continue-cards">CONTINUE Cards</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/headers.html#hierarch-cards">HIERARCH Cards</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage/image.html">Image Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="usage/image.html#image-data-as-an-array">Image Data as an Array</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/image.html#scaled-data">Scaled Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/image.html#data-sections">Data Sections</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage/table.html">Table Data</a><ul>
<li class="toctree-l2"><a class="reference internal" href="usage/table.html#table-data-as-a-record-array">Table Data as a Record Array</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/table.html#table-operations">Table Operations</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/table.html#scaled-data-in-tables">Scaled Data in Tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/table.html#creating-a-fits-table">Creating a FITS Table</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/table.html#fits-tables-with-time-columns">FITS Tables with Time Columns</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage/verification.html">Verification</a><ul>
<li class="toctree-l2"><a class="reference internal" href="usage/verification.html#fits-standard">FITS Standard</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/verification.html#verification-options">Verification Options</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/verification.html#verifications-at-different-data-object-levels">Verifications at Different Data Object Levels</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/verification.html#verification-using-the-fits-checksum-keyword-convention">Verification Using the FITS Checksum Keyword Convention</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage/unfamiliar.html">Less Familiar Objects</a><ul>
<li class="toctree-l2"><a class="reference internal" href="usage/unfamiliar.html#ascii-tables">ASCII Tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/unfamiliar.html#variable-length-array-tables">Variable Length Array Tables</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/unfamiliar.html#random-access-groups">Random Access Groups</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/unfamiliar.html#compressed-image-data">Compressed Image Data</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage/scripts.html">Executable Scripts</a><ul>
<li class="toctree-l2"><a class="reference internal" href="usage/scripts.html#module-astropy.io.fits.scripts.fitsinfo">fitsinfo</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/scripts.html#module-astropy.io.fits.scripts.fitsheader">fitsheader</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/scripts.html#module-astropy.io.fits.scripts.fitscheck">fitscheck</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/scripts.html#fitsdiff">fitsdiff</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage/misc.html">Miscellaneous Features</a><ul>
<li class="toctree-l2"><a class="reference internal" href="usage/misc.html#differs">Differs</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="usage/cloud.html">Obtaining subsets from cloud-hosted FITS files</a><ul>
<li class="toctree-l2"><a class="reference internal" href="usage/cloud.html#subsetting-fits-files-hosted-on-an-http-web-server">Subsetting FITS files hosted on an HTTP web server</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/cloud.html#subsetting-fits-files-hosted-in-amazon-s3-cloud-storage">Subsetting FITS files hosted in Amazon S3 cloud storage</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/cloud.html#using-cutout2d-with-cloud-hosted-fits-files">Using <code class="xref py py-class docutils literal notranslate"><span class="pre">Cutout2D</span></code> with cloud-hosted FITS files</a></li>
<li class="toctree-l2"><a class="reference internal" href="usage/cloud.html#performance-improvement-tips-for-subsetting-remote-fits-files">Performance improvement tips for subsetting remote FITS files</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="command-line-utilities">
<h2>Command-Line Utilities<a class="headerlink" href="#command-line-utilities" title="Permalink to this headline">¶</a></h2>
<p>For convenience, several of <code class="docutils literal notranslate"><span class="pre">astropy</span></code>’s sub-packages install utility programs
on your system which allow common tasks to be performed without having
to open a Python interpreter. These utilities include:</p>
<ul class="simple">
<li><p><a class="reference internal" href="usage/scripts.html#module-astropy.io.fits.scripts.fitsheader" title="astropy.io.fits.scripts.fitsheader"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fitsheader</span></code></a>: prints the headers of a FITS file.</p></li>
<li><p><a class="reference internal" href="usage/scripts.html#module-astropy.io.fits.scripts.fitscheck" title="astropy.io.fits.scripts.fitscheck"><code class="xref py py-obj docutils literal notranslate"><span class="pre">fitscheck</span></code></a>: verifies and optionally rewrites
the CHECKSUM and DATASUM keywords of a FITS file.</p></li>
<li><p><a class="reference internal" href="usage/scripts.html#fitsdiff"><span class="std std-ref">fitsdiff</span></a>: compares two FITS files and reports the differences.</p></li>
<li><p><a class="reference internal" href="../../visualization/index.html#fits2bitmap"><span class="std std-ref">Scripts</span></a>: converts FITS images to bitmaps, including scaling and
stretching.</p></li>
<li><p><a class="reference internal" href="../../wcs/index.html#wcslint"><span class="std std-ref">wcslint</span></a>: checks the <a class="reference internal" href="../../wcs/index.html#astropy-wcs"><span class="std std-ref">WCS</span></a> keywords in a
FITS file for compliance against the standards.</p></li>
</ul>
</div>
<div class="section" id="other-information">
<h2>Other Information<a class="headerlink" href="#other-information" title="Permalink to this headline">¶</a></h2>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="appendix/faq.html">astropy.io.fits FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix/header_transition.html">Header Interface Transition Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="appendix/history.html">astropy.io.fits History</a></li>
</ul>
</div>
</div>
<div class="section" id="performance-tips">
<span id="astropy-io-fits-performance"></span><h2>Performance Tips<a class="headerlink" href="#performance-tips" title="Permalink to this headline">¶</a></h2>
<p>It is possible to set the data array for <a class="reference internal" href="api/hdus.html#astropy.io.fits.PrimaryHDU" title="astropy.io.fits.PrimaryHDU"><code class="xref py py-class docutils literal notranslate"><span class="pre">PrimaryHDU</span></code></a>
and <a class="reference internal" href="api/images.html#astropy.io.fits.ImageHDU" title="astropy.io.fits.ImageHDU"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageHDU</span></code></a> to a <a class="reference external" href="https://dask.org/">dask</a> array.
If this is written to disk, the dask array will be computed as it is being
written, which will avoid using excessive memory:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">dask.array</span> <span class="k">as</span> <span class="nn">da</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">array</span> <span class="o">=</span> <span class="n">da</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">1000</span><span class="p">,</span> <span class="mi">1000</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">PrimaryHDU</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">array</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdu</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s1">&#39;test_dask.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="module-astropy.io.fits">
<span id="reference-api"></span><h2>Reference/API<a class="headerlink" href="#module-astropy.io.fits" title="Permalink to this headline">¶</a></h2>
<p>A package for reading and writing FITS files and manipulating their
contents.</p>
<p>A module for reading and writing Flexible Image Transport System
(FITS) files.  This file format was endorsed by the International
Astronomical Union in 1999 and mandated by NASA as the standard format
for storing high energy astrophysics data.  For details of the FITS
standard, see the NASA/Science Office of Standards and Technology
publication, NOST 100-2.0.</p>
<div class="toctree-wrapper compound">
<ul>
<li class="toctree-l1"><a class="reference internal" href="api/files.html">File Handling and Convenience Functions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/files.html#open"><code class="xref py py-func docutils literal notranslate"><span class="pre">open()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/files.html#writeto"><code class="xref py py-func docutils literal notranslate"><span class="pre">writeto()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/files.html#info"><code class="xref py py-func docutils literal notranslate"><span class="pre">info()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/files.html#printdiff"><code class="xref py py-func docutils literal notranslate"><span class="pre">printdiff()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/files.html#append"><code class="xref py py-func docutils literal notranslate"><span class="pre">append()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/files.html#update"><code class="xref py py-func docutils literal notranslate"><span class="pre">update()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/files.html#getdata"><code class="xref py py-func docutils literal notranslate"><span class="pre">getdata()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/files.html#getheader"><code class="xref py py-func docutils literal notranslate"><span class="pre">getheader()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/files.html#getval"><code class="xref py py-func docutils literal notranslate"><span class="pre">getval()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/files.html#setval"><code class="xref py py-func docutils literal notranslate"><span class="pre">setval()</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/files.html#delval"><code class="xref py py-func docutils literal notranslate"><span class="pre">delval()</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/hdulists.html">HDU Lists</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/hdulists.html#hdulist"><code class="xref py py-class docutils literal notranslate"><span class="pre">HDUList</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/hdus.html">Header Data Unit</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/hdus.html#primaryhdu"><code class="xref py py-class docutils literal notranslate"><span class="pre">PrimaryHDU</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/hdus.html#groupshdu"><code class="xref py py-class docutils literal notranslate"><span class="pre">GroupsHDU</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/hdus.html#groupdata"><code class="xref py py-class docutils literal notranslate"><span class="pre">GroupData</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/hdus.html#group"><code class="xref py py-class docutils literal notranslate"><span class="pre">Group</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="api/hdus.html#streaminghdu"><code class="xref py py-class docutils literal notranslate"><span class="pre">StreamingHDU</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/headers.html">Headers</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/headers.html#header"><code class="xref py py-class docutils literal notranslate"><span class="pre">Header</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/cards.html">Cards</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/cards.html#card"><code class="xref py py-class docutils literal notranslate"><span class="pre">Card</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/tables.html">Tables</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/tables.html#bintablehdu"><code class="xref py py-class docutils literal notranslate"><span class="pre">BinTableHDU</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/tables.html#tablehdu"><code class="xref py py-class docutils literal notranslate"><span class="pre">TableHDU</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/tables.html#column"><code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/tables.html#coldefs"><code class="xref py py-class docutils literal notranslate"><span class="pre">ColDefs</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/tables.html#fits-rec"><code class="xref py py-class docutils literal notranslate"><span class="pre">FITS_rec</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/tables.html#fits-record"><code class="xref py py-class docutils literal notranslate"><span class="pre">FITS_record</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/tables.html#table-functions">Table Functions</a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/tables.html#tabledump"><code class="xref py py-func docutils literal notranslate"><span class="pre">tabledump()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api/tables.html#tableload"><code class="xref py py-func docutils literal notranslate"><span class="pre">tableload()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="api/tables.html#table-to-hdu"><code class="xref py py-func docutils literal notranslate"><span class="pre">table_to_hdu()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/images.html">Images</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/images.html#imagehdu"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ImageHDU</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/images.html#compimagehdu"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CompImageHDU</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="api/images.html#section"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Section</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/diff.html">Differs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/diff.html#fitsdiff"><code class="xref py py-class docutils literal notranslate"><span class="pre">FITSDiff</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/diff.html#hdudiff"><code class="xref py py-class docutils literal notranslate"><span class="pre">HDUDiff</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/diff.html#headerdiff"><code class="xref py py-class docutils literal notranslate"><span class="pre">HeaderDiff</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/diff.html#imagedatadiff"><code class="xref py py-class docutils literal notranslate"><span class="pre">ImageDataDiff</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/diff.html#rawdatadiff"><code class="xref py py-class docutils literal notranslate"><span class="pre">RawDataDiff</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/diff.html#tabledatadiff"><code class="xref py py-class docutils literal notranslate"><span class="pre">TableDataDiff</span></code></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api/verification.html">Verification Options</a><ul>
<li class="toctree-l2"><a class="reference internal" href="api/verification.html#exception"><code class="docutils literal notranslate"><span class="pre">'exception'</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/verification.html#ignore"><code class="docutils literal notranslate"><span class="pre">'ignore'</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/verification.html#fix"><code class="docutils literal notranslate"><span class="pre">'fix'</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/verification.html#silentfix"><code class="docutils literal notranslate"><span class="pre">'silentfix'</span></code></a></li>
<li class="toctree-l2"><a class="reference internal" href="api/verification.html#warn"><code class="docutils literal notranslate"><span class="pre">'warn'</span></code></a></li>
</ul>
</li>
</ul>
</div>
<p class="rubric">Footnotes</p>
<dl class="footnote brackets">
<dt class="label" id="f1"><span class="brackets"><a class="fn-backref" href="#id1">1</a></span></dt>
<dd><p>For legacy code only that already depends on PyFITS, it’s acceptable to continue using “from astropy.io import fits as pyfits”.</p>
</dd>
</dl>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">FITS File Handling (<code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits</span></code>)</a><ul>
<li><a class="reference internal" href="#introduction">Introduction</a></li>
<li><a class="reference internal" href="#getting-started">Getting Started</a><ul>
<li><a class="reference internal" href="#reading-and-updating-existing-fits-files">Reading and Updating Existing FITS Files</a><ul>
<li><a class="reference internal" href="#opening-a-fits-file">Opening a FITS File</a><ul>
<li><a class="reference internal" href="#working-with-large-files">Working with large files</a></li>
<li><a class="reference internal" href="#working-with-remote-and-cloud-hosted-files">Working with remote and cloud-hosted files</a></li>
<li><a class="reference internal" href="#unsigned-integers">Unsigned integers</a></li>
<li><a class="reference internal" href="#working-with-compressed-files">Working with compressed files</a></li>
<li><a class="reference internal" href="#working-with-non-standard-files">Working with non-standard files</a></li>
</ul>
</li>
<li><a class="reference internal" href="#working-with-fits-headers">Working with FITS Headers</a><ul>
<li><a class="reference internal" href="#structural-keywords">Structural Keywords</a></li>
</ul>
</li>
<li><a class="reference internal" href="#working-with-image-data">Working with Image Data</a></li>
<li><a class="reference internal" href="#working-with-table-data">Working with Table Data</a></li>
<li><a class="reference internal" href="#save-file-changes">Save File Changes</a></li>
</ul>
</li>
<li><a class="reference internal" href="#creating-a-new-fits-file">Creating a New FITS File</a><ul>
<li><a class="reference internal" href="#creating-a-new-image-file">Creating a New Image File</a></li>
<li><a class="reference internal" href="#creating-a-new-table-file">Creating a New Table File</a></li>
<li><a class="reference internal" href="#creating-a-file-with-multiple-extensions">Creating a File with Multiple Extensions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#convenience-functions">Convenience Functions</a></li>
</ul>
</li>
<li><a class="reference internal" href="#using-astropy-io-fits">Using <code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits</span></code></a></li>
<li><a class="reference internal" href="#command-line-utilities">Command-Line Utilities</a></li>
<li><a class="reference internal" href="#other-information">Other Information</a></li>
<li><a class="reference internal" href="#performance-tips">Performance Tips</a></li>
<li><a class="reference internal" href="#module-astropy.io.fits">Reference/API</a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../../_sources/io/fits/index.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011–2022, The Astropy Developers.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 3.5.4. &nbsp;
    Last built 09 May 2022. <br/>
  </p>
</footer>
  </body>
</html>