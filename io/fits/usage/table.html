


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Table Data &#8212; Astropy v5.2.dev96+g04a0cf8bb</title>
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-rendered-html.css" />
    
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/sidebar.js"></script>
    <script type="text/javascript" src="../../../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../../../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Verification" href="verification.html" />
    <link rel="prev" title="Image Data" href="image.html" />
  
  <meta name="robots" content="noindex, nofollow">
  
  
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>


  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="verification.html" title="Verification">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="image.html" title="Image Data">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../../../index.html">Astropy v5.2.dev96+g04a0cf8bb</a>
	 &#187;
      </li>
      <li><a href="../index.html" accesskey="U">FITS File Handling (<code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits</span></code>)</a> &#187;</li>
      
      <li>Table Data</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="table-data">
<h1>Table Data<a class="headerlink" href="#table-data" title="Permalink to this headline">¶</a></h1>
<p>In this chapter, we will discuss the data component in a table HDU. A table will
always be in an extension HDU, never in a primary HDU.</p>
<p>There are two kinds of tables in the FITS standard: binary tables and ASCII
tables. Binary tables are more economical in storage and faster in data access
and manipulation. ASCII tables store the data in a “human readable” form and
therefore take up more storage space as well as more processing time since the
ASCII text needs to be parsed into numerical values.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to read or write a single table in FITS format then the
most convenient method is often via the high-level <a class="reference internal" href="../../unified.html#table-io"><span class="std std-ref">Unified File Read/Write Interface</span></a>. In
particular see the <a class="reference internal" href="../../unified.html#table-io-fits"><span class="std std-ref">Unified I/O FITS</span></a> section.</p>
</div>
<div class="section" id="table-data-as-a-record-array">
<h2>Table Data as a Record Array<a class="headerlink" href="#table-data-as-a-record-array" title="Permalink to this headline">¶</a></h2>
<div class="section" id="what-is-a-record-array">
<h3>What is a Record Array?<a class="headerlink" href="#what-is-a-record-array" title="Permalink to this headline">¶</a></h3>
<p>A record array is an array which contains records (i.e., rows) of heterogeneous
data types. Record arrays are available through the records module in the NumPy
library.</p>
<p>Here is a sample record array:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">bright</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">rec</span><span class="o">.</span><span class="n">array</span><span class="p">([(</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;Sirius&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">1.45</span><span class="p">,</span> <span class="s1">&#39;A1V&#39;</span><span class="p">),</span>
<span class="gp">... </span>                       <span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;Canopus&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.73</span><span class="p">,</span> <span class="s1">&#39;F0Ib&#39;</span><span class="p">),</span>
<span class="gp">... </span>                       <span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="s1">&#39;Rigil Kent&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="s1">&#39;G2V&#39;</span><span class="p">)],</span>
<span class="gp">... </span>                      <span class="n">formats</span><span class="o">=</span><span class="s1">&#39;int16,a20,float32,a10&#39;</span><span class="p">,</span>
<span class="gp">... </span>                      <span class="n">names</span><span class="o">=</span><span class="s1">&#39;order,name,mag,Sp&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>In this example, there are three records (rows) and four fields (columns). The
first field is a short integer, the second a character string (of length 20),
the third a floating point number, and the fourth a character string (of length
10). Each record has the same (heterogeneous) data structure.</p>
<p>The underlying data structure used for FITS tables is a class called
<a class="reference internal" href="../api/tables.html#astropy.io.fits.FITS_rec" title="astropy.io.fits.FITS_rec"><code class="xref py py-class docutils literal notranslate"><span class="pre">FITS_rec</span></code></a> which is a specialized subclass of <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.recarray.html#numpy.recarray" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">numpy.recarray</span></code></a>. A
<a class="reference internal" href="../api/tables.html#astropy.io.fits.FITS_rec" title="astropy.io.fits.FITS_rec"><code class="xref py py-class docutils literal notranslate"><span class="pre">FITS_rec</span></code></a> can be instantiated directly using the same initialization
format presented for plain recarrays as in the example above. You may also
instantiate a new <a class="reference internal" href="../api/tables.html#astropy.io.fits.FITS_rec" title="astropy.io.fits.FITS_rec"><code class="xref py py-class docutils literal notranslate"><span class="pre">FITS_rec</span></code></a> from a list of <a class="reference internal" href="../api/tables.html#astropy.io.fits.Column" title="astropy.io.fits.Column"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits.Column</span></code></a>
objects using the <a class="reference internal" href="../api/tables.html#astropy.io.fits.FITS_rec.from_columns" title="astropy.io.fits.FITS_rec.from_columns"><code class="xref py py-meth docutils literal notranslate"><span class="pre">FITS_rec.from_columns()</span></code></a> class method. This has the
exact same semantics as <a class="reference internal" href="../api/tables.html#astropy.io.fits.BinTableHDU.from_columns" title="astropy.io.fits.BinTableHDU.from_columns"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BinTableHDU.from_columns()</span></code></a> and
<a class="reference internal" href="../api/tables.html#astropy.io.fits.TableHDU.from_columns" title="astropy.io.fits.TableHDU.from_columns"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TableHDU.from_columns()</span></code></a>, except that it only returns an actual FITS_rec
array and not a whole HDU object.</p>
</div>
<div class="section" id="metadata-of-a-table">
<h3>Metadata of a Table<a class="headerlink" href="#metadata-of-a-table" title="Permalink to this headline">¶</a></h3>
<p>The data in a FITS table HDU is basically a record array with added
attributes. The metadata (i.e., information about the table data) are stored in
the header. For example, the keyword TFORM1 contains the format of the first
field, TTYPE2 the name of the second field, etc. NAXIS2 gives the number of
records (rows) and TFIELDS gives the number of fields (columns). For FITS
tables, the maximum number of fields is 999. The data type specified in TFORM
is represented by letter codes for binary tables and a Fortran-like format
string for ASCII tables. Note that this is different from the format
specifications when constructing a record array.</p>
</div>
<div class="section" id="reading-a-fits-table">
<h3>Reading a FITS Table<a class="headerlink" href="#reading-a-fits-table" title="Permalink to this headline">¶</a></h3>
<p>Like images, the <code class="docutils literal notranslate"><span class="pre">.data</span></code> attribute of a table HDU contains the data of the
table.</p>
<div class="section" id="example">
<h4>Example<a class="headerlink" href="#example" title="Permalink to this headline">¶</a></h4>
<p>To read a FITS Table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fits_table_filename</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">get_testdata_filepath</span><span class="p">(</span><span class="s1">&#39;btable.fits&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">hdul</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fits_table_filename</span><span class="p">)</span>  <span class="c1"># open a FITS file</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">hdul</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>  <span class="c1"># assume the first extension is a table</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># show the first two rows</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">first_two_rows</span> <span class="o">=</span> <span class="n">data</span><span class="p">[:</span><span class="mi">2</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">first_two_rows</span>  
<span class="go">[(1, &#39;Sirius&#39;, -1.45000005, &#39;A1V&#39;) (2, &#39;Canopus&#39;, -0.73000002, &#39;F0Ib&#39;)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># show the values in field &quot;mag&quot;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">magnitudes</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">magnitudes</span>  
<span class="go">array([-1.45000005, -0.73000002, -0.1       ], dtype=float32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># columns can be referenced by index too</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">names</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">field</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">names</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span> 
<span class="go">[&#39;Sirius&#39;, &#39;Canopus&#39;, &#39;Rigil Kent&#39;]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdul</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Note that in <code class="docutils literal notranslate"><span class="pre">astropy</span></code>, when using the <code class="docutils literal notranslate"><span class="pre">field()</span></code> method, it is 0-indexed
while the suffixes in header keywords such as TFORM is 1-indexed. So,
<code class="docutils literal notranslate"><span class="pre">data.field(0)</span></code> is the data in the column with the name specified in TTYPE1
and format in TFORM1.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The FITS format allows table columns with a zero-width data format, such as
<code class="docutils literal notranslate"><span class="pre">'0D'</span></code>. This is probably intended as a space-saving measure on files in
which that column contains no data. In such files, the zero-width columns
are omitted when accessing the table data, so the indexes of fields might
change when using the <code class="docutils literal notranslate"><span class="pre">field()</span></code> method. For this reason, if you expect
to encounter files containing zero-width columns it is recommended to access
fields by name rather than by index.</p>
</div>
</div>
</div>
</div>
<div class="section" id="table-operations">
<h2>Table Operations<a class="headerlink" href="#table-operations" title="Permalink to this headline">¶</a></h2>
<div class="section" id="selecting-records-in-a-table">
<h3>Selecting Records in a Table<a class="headerlink" href="#selecting-records-in-a-table" title="Permalink to this headline">¶</a></h3>
<p>Like image data, we can use the same “mask array” idea to pick out desired
records from a table and make a new table out of it.</p>
<div class="section" id="examples">
<h4>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h4>
<p>Assuming the table’s second field as having the name ‘magnitude’, an output
table containing all the records of magnitude &gt; -0.5 from the input table is
generated:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fits_table_filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdul</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">data</span> <span class="o">=</span> <span class="n">hdul</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="gp">... </span>    <span class="n">mask</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mf">0.5</span>
<span class="gp">... </span>    <span class="n">newdata</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="gp">... </span>    <span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">BinTableHDU</span><span class="p">(</span><span class="n">data</span><span class="o">=</span><span class="n">newdata</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">hdu</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s1">&#39;newtable.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>It is also possible to update the data from the HDU object in-place:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fits_table_filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdul</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">hdu</span> <span class="o">=</span> <span class="n">hdul</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">... </span>    <span class="n">mask</span> <span class="o">=</span> <span class="n">hdu</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;mag&#39;</span><span class="p">]</span> <span class="o">&gt;</span> <span class="o">-</span><span class="mf">0.5</span>
<span class="gp">... </span>    <span class="n">hdu</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">hdu</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">mask</span><span class="p">]</span>
<span class="gp">... </span>    <span class="n">hdu</span><span class="o">.</span><span class="n">writeto</span><span class="p">(</span><span class="s1">&#39;newtable2.fits&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="merging-tables">
<h3>Merging Tables<a class="headerlink" href="#merging-tables" title="Permalink to this headline">¶</a></h3>
<p>Merging different tables is very convenient in <code class="docutils literal notranslate"><span class="pre">astropy</span></code>.</p>
<div class="section" id="id1">
<h4>Examples<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h4>
<p>To merge the column definitions of the input tables:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fits_other_table_filename</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">get_testdata_filepath</span><span class="p">(</span><span class="s1">&#39;table.fits&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fits_table_filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdul1</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fits_other_table_filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdul2</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">new_columns</span> <span class="o">=</span> <span class="n">hdul1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span> <span class="o">+</span> <span class="n">hdul2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span>
<span class="gp">... </span>        <span class="n">new_hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">BinTableHDU</span><span class="o">.</span><span class="n">from_columns</span><span class="p">(</span><span class="n">new_columns</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_columns</span>
<span class="go">ColDefs(</span>
<span class="go">        name = &#39;order&#39;; format = &#39;I&#39;</span>
<span class="go">        name = &#39;name&#39;; format = &#39;20A&#39;</span>
<span class="go">        name = &#39;mag&#39;; format = &#39;E&#39;</span>
<span class="go">        name = &#39;Sp&#39;; format = &#39;10A&#39;</span>
<span class="go">        name = &#39;target&#39;; format = &#39;20A&#39;</span>
<span class="go">        name = &#39;V_mag&#39;; format = &#39;E&#39;</span>
<span class="go">    )</span>
</pre></div>
</div>
<p>The number of fields in the output table will be the sum of numbers of fields
of the input tables. Users have to make sure the input tables do not share any
common field names. The number of records in the output table will be the
largest number of records of all input tables. The expanded slots for the
originally shorter table(s) will be zero (or blank) filled.</p>
<p>Another version of this example can be used to append a new column to a
table. Updating an existing table with a new column is generally more
difficult than it is worth, but you can “append” a column to a table by creating
a new table with columns from the existing table plus the new column(s):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fits_table_filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdul</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">orig_table</span> <span class="o">=</span> <span class="n">hdul</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
<span class="gp">... </span>    <span class="n">orig_cols</span> <span class="o">=</span> <span class="n">orig_table</span><span class="o">.</span><span class="n">columns</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">new_cols</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">ColDefs</span><span class="p">([</span>
<span class="gp">... </span>    <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;NEWCOL1&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">orig_table</span><span class="p">))),</span>
<span class="gp">... </span>    <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;NEWCOL2&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;D&#39;</span><span class="p">,</span>
<span class="gp">... </span>                <span class="n">array</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">orig_table</span><span class="p">)))])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">BinTableHDU</span><span class="o">.</span><span class="n">from_columns</span><span class="p">(</span><span class="n">orig_cols</span> <span class="o">+</span> <span class="n">new_cols</span><span class="p">)</span>
</pre></div>
</div>
<p>Now <code class="docutils literal notranslate"><span class="pre">newtable.fits</span></code> contains a new table with the original table, plus the
two new columns filled with zeros.</p>
</div>
</div>
<div class="section" id="appending-tables">
<h3>Appending Tables<a class="headerlink" href="#appending-tables" title="Permalink to this headline">¶</a></h3>
<p>Appending one table after another is slightly trickier, since the two tables
may have different field attributes.</p>
<div class="section" id="id2">
<h4>Examples<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>Here, the first example is to append by field indices, and the second one is to
append by field names. In both cases, the output table will inherit the column
attributes (name, format, etc.) of the first table:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fits_table_filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdul1</span><span class="p">:</span>
<span class="gp">... </span>    <span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fits_table_filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdul2</span><span class="p">:</span>
<span class="gp">... </span>        <span class="n">nrows1</span> <span class="o">=</span> <span class="n">hdul1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">... </span>        <span class="n">nrows2</span> <span class="o">=</span> <span class="n">hdul2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">... </span>        <span class="n">nrows</span> <span class="o">=</span> <span class="n">nrows1</span> <span class="o">+</span> <span class="n">nrows2</span>
<span class="gp">... </span>        <span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">BinTableHDU</span><span class="o">.</span><span class="n">from_columns</span><span class="p">(</span><span class="n">hdul1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="n">nrows</span><span class="o">=</span><span class="n">nrows</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">for</span> <span class="n">colname</span> <span class="ow">in</span> <span class="n">hdul1</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">names</span><span class="p">:</span>
<span class="gp">... </span>            <span class="n">hdu</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">colname</span><span class="p">][</span><span class="n">nrows1</span><span class="p">:]</span> <span class="o">=</span> <span class="n">hdul2</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">data</span><span class="p">[</span><span class="n">colname</span><span class="p">]</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="scaled-data-in-tables">
<h2>Scaled Data in Tables<a class="headerlink" href="#scaled-data-in-tables" title="Permalink to this headline">¶</a></h2>
<p>A table field’s data, like an image, can also be scaled. Scaling in a table has
a more generalized meaning than in images. In images, the physical data is a
simple linear transformation from the storage data. The table fields do have
such a construct too, where BSCALE and BZERO are stored in the header as TSCALn
and TZEROn. In addition, boolean columns and ASCII tables’ numeric fields are
also generalized “scaled” fields, but without TSCAL and TZERO.</p>
<p>All scaled fields, like the image case, will take extra memory space as well as
processing. So, if high performance is desired, try to minimize the use of
scaled fields.</p>
<p>All of the scalings are done for the user, so the user only sees the physical
data. Thus, there is no need to worry about scaling back and forth between the
physical and storage column values.</p>
</div>
<div class="section" id="creating-a-fits-table">
<h2>Creating a FITS Table<a class="headerlink" href="#creating-a-fits-table" title="Permalink to this headline">¶</a></h2>
<div class="section" id="column-creation">
<span id="id3"></span><h3>Column Creation<a class="headerlink" href="#column-creation" title="Permalink to this headline">¶</a></h3>
<p>To create a table from scratch, it is necessary to create individual columns
first. A <a class="reference internal" href="../api/tables.html#astropy.io.fits.Column" title="astropy.io.fits.Column"><code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code></a> constructor needs the minimal information of column
name and format. Here is a summary of all allowed formats for a binary table:</p>
<pre class="literal-block"><strong>FITS format code         Description                     8-bit bytes</strong>

L                        logical (Boolean)               1
X                        bit                             *
B                        Unsigned byte                   1
I                        16-bit integer                  2
J                        32-bit integer                  4
K                        64-bit integer                  8
A                        character                       1
E                        single precision float (32-bit) 4
D                        double precision float (64-bit) 8
C                        single precision complex        8
M                        double precision complex        16
P                        array descriptor                8
Q                        array descriptor                16</pre>
<p>We will concentrate on binary tables in this chapter. ASCII tables will be
discussed in a later chapter. The less frequently used X format (bit array) and
P format (used in variable length tables) will also be discussed in a later
chapter.</p>
<p>Besides the required name and format arguments in constructing a
<a class="reference internal" href="../api/tables.html#astropy.io.fits.Column" title="astropy.io.fits.Column"><code class="xref py py-class docutils literal notranslate"><span class="pre">Column</span></code></a>, there are many optional arguments which can be used in
creating a column. Here is a list of these arguments and their corresponding
header keywords and descriptions:</p>
<pre class="literal-block"><strong>Argument        Corresponding         Description</strong>
<strong>in Column()     header keyword</strong>

name            TTYPE                 column name
format          TFORM                 column format
unit            TUNIT                 unit
null            TNULL                 null value (only for B, I, and J)
bscale          TSCAL                 scaling factor for data
bzero           TZERO                 zero point for data scaling
disp            TDISP                 display format
dim             TDIM                  multi-dimensional array spec
start           TBCOL                 starting position for ASCII table
coord_type      TCTYP                 coordinate/axis type
coord_unit      TCUNI                 coordinate/axis unit
coord_ref_point TCRPX                 pixel coordinate of the reference point
coord_ref_value TCRVL                 coordinate value at reference point
coord_inc       TCDLT                 coordinate increment at reference point
time_ref_pos    TRPOS                 reference position for a time coordinate column
ascii                                 specifies a column for an ASCII table
array                                 the data of the column</pre>
<div class="section" id="id4">
<h4>Examples<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<p>Here are a few Columns using various combinations of the optional arguments:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">counts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">312</span><span class="p">,</span> <span class="mi">334</span><span class="p">,</span> <span class="mi">308</span><span class="p">,</span> <span class="mi">317</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">names</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="s1">&#39;NGC1&#39;</span><span class="p">,</span> <span class="s1">&#39;NGC2&#39;</span><span class="p">,</span> <span class="s1">&#39;NGC3&#39;</span><span class="p">,</span> <span class="s1">&#39;NGC4&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">values</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="mi">2</span><span class="o">*</span><span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">col1</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;10A&#39;</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="n">names</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">col2</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;counts&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;J&#39;</span><span class="p">,</span> <span class="n">unit</span><span class="o">=</span><span class="s1">&#39;count&#39;</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="n">counts</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">col3</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;notes&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;A10&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">col4</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;spectrum&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;10E&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">col5</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;flag&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;L&#39;</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="p">[</span><span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">True</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">col6</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;intarray&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;4I&#39;</span><span class="p">,</span> <span class="n">dim</span><span class="o">=</span><span class="s1">&#39;(2, 2)&#39;</span><span class="p">,</span> <span class="n">array</span><span class="o">=</span><span class="n">values</span><span class="p">)</span>
</pre></div>
</div>
<p>In this example, formats are specified with the FITS letter codes. When there
is a number (&gt;1) preceding a (numeric type) letter code, it means each cell in
that field is a one-dimensional array. In the case of column “col4”, each cell
is an array (a NumPy array) of 10 elements. And in the case of column “col6”,
with the use of the “dim” argument, each cell is a multi-dimensional array of
2x2 elements.</p>
<p>For character string fields, the number should be to the <em>left</em> of the letter
‘A’ when creating binary tables, and should be to the <em>right</em> when creating
ASCII tables. However, as this is a common confusion, both formats are
understood when creating binary tables (note, however, that upon writing to a
file the correct format will be written in the header). So, for columns “col1”
and “col3”, they both have 10 characters in each of their cells. For numeric
data type, the dimension number must be before the letter code, not after.</p>
<p>After the columns are constructed, the <a class="reference internal" href="../api/tables.html#astropy.io.fits.BinTableHDU.from_columns" title="astropy.io.fits.BinTableHDU.from_columns"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BinTableHDU.from_columns()</span></code></a> class
method can be used to construct a table HDU. We can either go through the
column definition object:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">coldefs</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">ColDefs</span><span class="p">([</span><span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="p">,</span> <span class="n">col3</span><span class="p">,</span> <span class="n">col4</span><span class="p">,</span> <span class="n">col5</span><span class="p">,</span> <span class="n">col6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">BinTableHDU</span><span class="o">.</span><span class="n">from_columns</span><span class="p">(</span><span class="n">coldefs</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">coldefs</span>
<span class="go">ColDefs(</span>
<span class="go">    name = &#39;target&#39;; format = &#39;10A&#39;</span>
<span class="go">    name = &#39;counts&#39;; format = &#39;J&#39;; unit = &#39;count&#39;</span>
<span class="go">    name = &#39;notes&#39;; format = &#39;10A&#39;</span>
<span class="go">    name = &#39;spectrum&#39;; format = &#39;10E&#39;</span>
<span class="go">    name = &#39;flag&#39;; format = &#39;L&#39;</span>
<span class="go">    name = &#39;intarray&#39;; format = &#39;4I&#39;; dim = &#39;(2, 2)&#39;</span>
<span class="go">)</span>
</pre></div>
</div>
<p>or directly use the <a class="reference internal" href="../api/tables.html#astropy.io.fits.BinTableHDU.from_columns" title="astropy.io.fits.BinTableHDU.from_columns"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BinTableHDU.from_columns()</span></code></a> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">BinTableHDU</span><span class="o">.</span><span class="n">from_columns</span><span class="p">([</span><span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="p">,</span> <span class="n">col3</span><span class="p">,</span> <span class="n">col4</span><span class="p">,</span> <span class="n">col5</span><span class="p">,</span> <span class="n">col6</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdu</span><span class="o">.</span><span class="n">columns</span>
<span class="go">ColDefs(</span>
<span class="go">    name = &#39;target&#39;; format = &#39;10A&#39;</span>
<span class="go">    name = &#39;counts&#39;; format = &#39;J&#39;; unit = &#39;count&#39;</span>
<span class="go">    name = &#39;notes&#39;; format = &#39;10A&#39;</span>
<span class="go">    name = &#39;spectrum&#39;; format = &#39;10E&#39;</span>
<span class="go">    name = &#39;flag&#39;; format = &#39;L&#39;</span>
<span class="go">    name = &#39;intarray&#39;; format = &#39;4I&#39;; dim = &#39;(2, 2)&#39;</span>
<span class="go">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Users familiar with older versions of <code class="docutils literal notranslate"><span class="pre">astropy</span></code> will wonder what
happened to <code class="docutils literal notranslate"><span class="pre">astropy.io.fits.new_table</span></code>. <a class="reference internal" href="../api/tables.html#astropy.io.fits.BinTableHDU.from_columns" title="astropy.io.fits.BinTableHDU.from_columns"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BinTableHDU.from_columns()</span></code></a>
and its companion for ASCII tables <a class="reference internal" href="../api/tables.html#astropy.io.fits.TableHDU.from_columns" title="astropy.io.fits.TableHDU.from_columns"><code class="xref py py-meth docutils literal notranslate"><span class="pre">TableHDU.from_columns()</span></code></a> are the
same in the arguments they accept and their behavior, but make it
more explicit as to what type of table HDU they create.</p>
</div>
<p>A look at the newly created HDU’s header will show that relevant keywords are
properly populated:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hdu</span><span class="o">.</span><span class="n">header</span>
<span class="go">XTENSION= &#39;BINTABLE&#39;           / binary table extension</span>
<span class="go">BITPIX  =                    8 / array data type</span>
<span class="go">NAXIS   =                    2 / number of array dimensions</span>
<span class="go">NAXIS1  =                   73 / length of dimension 1</span>
<span class="go">NAXIS2  =                    4 / length of dimension 2</span>
<span class="go">PCOUNT  =                    0 / number of group parameters</span>
<span class="go">GCOUNT  =                    1 / number of groups</span>
<span class="go">TFIELDS =                    6 / number of table fields</span>
<span class="go">TTYPE1  = &#39;target  &#39;</span>
<span class="go">TFORM1  = &#39;10A     &#39;</span>
<span class="go">TTYPE2  = &#39;counts  &#39;</span>
<span class="go">TFORM2  = &#39;J       &#39;</span>
<span class="go">TUNIT2  = &#39;count   &#39;</span>
<span class="go">TTYPE3  = &#39;notes   &#39;</span>
<span class="go">TFORM3  = &#39;10A     &#39;</span>
<span class="go">TTYPE4  = &#39;spectrum&#39;</span>
<span class="go">TFORM4  = &#39;10E     &#39;</span>
<span class="go">TTYPE5  = &#39;flag    &#39;</span>
<span class="go">TFORM5  = &#39;L       &#39;</span>
<span class="go">TTYPE6  = &#39;intarray&#39;</span>
<span class="go">TFORM6  = &#39;4I      &#39;</span>
<span class="go">TDIM6   = &#39;(2, 2)  &#39;</span>
</pre></div>
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>It should be noted that when creating a new table with
<a class="reference internal" href="../api/tables.html#astropy.io.fits.BinTableHDU.from_columns" title="astropy.io.fits.BinTableHDU.from_columns"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BinTableHDU.from_columns()</span></code></a>, an in-memory copy of all of the input
column arrays is created. This is because it is not guaranteed that the
columns are arranged contiguously in memory in row-major order (in fact,
they are most likely not), so they have to be combined into a new array.</p>
</div>
<p>However, if the array data <em>is</em> already contiguous in memory, such as in an
existing record array, a kludge can be used to create a new table HDU without
any copying. First, create the Columns as before, but without using the
<code class="docutils literal notranslate"><span class="pre">array=</span></code> argument:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">col1</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">Column</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s1">&#39;target&#39;</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="s1">&#39;10A&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>Then call <a class="reference internal" href="../api/tables.html#astropy.io.fits.BinTableHDU.from_columns" title="astropy.io.fits.BinTableHDU.from_columns"><code class="xref py py-meth docutils literal notranslate"><span class="pre">BinTableHDU.from_columns()</span></code></a>:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hdu</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">BinTableHDU</span><span class="o">.</span><span class="n">from_columns</span><span class="p">([</span><span class="n">col1</span><span class="p">,</span> <span class="n">col2</span><span class="p">,</span> <span class="n">col3</span><span class="p">,</span> <span class="n">col4</span><span class="p">,</span> <span class="n">col5</span><span class="p">])</span>
</pre></div>
</div>
<p>This will create a new table HDU as before, with the correct column
definitions, but an empty data section. Now you can assign your array directly
to the HDU’s data attribute:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hdu</span><span class="o">.</span><span class="n">data</span> <span class="o">=</span> <span class="n">mydata</span>
</pre></div>
</div>
<p>In a future version of <code class="docutils literal notranslate"><span class="pre">astropy</span></code>, table creation will be simplified and this
process will not be necessary.</p>
</div>
</div>
</div>
<div class="section" id="fits-tables-with-time-columns">
<span id="fits-time-column"></span><h2>FITS Tables with Time Columns<a class="headerlink" href="#fits-tables-with-time-columns" title="Permalink to this headline">¶</a></h2>
<p>The <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2015A%26A...574A..36R/">FITS Time standard paper</a> defines the formats
and keywords used to represent timing information in FITS files. The <code class="docutils literal notranslate"><span class="pre">astropy</span></code>
FITS package provides support for reading and writing native
<a class="reference internal" href="../../../api/astropy.time.Time.html#astropy.time.Time" title="astropy.time.Time"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Time</span></code></a> columns and objects using this format. This is done
within the <a class="reference internal" href="../../unified.html#table-io-fits"><span class="std std-ref">FITS</span></a> unified I/O interface and examples of usage can
be found in the <a class="reference internal" href="../../unified.html#fits-astropy-native"><span class="std std-ref">TDISPn Keyword</span></a> section. The support is not
complete and only a subset of the full standard is implemented.</p>
<div class="section" id="id5">
<h3>Example<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h3>
<p>The following is an example of a Header extract of a binary table (event list)
with a time column:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>COMMENT      ---------- Globally valid key words ----------------
TIMESYS = ’TT      ’          / Time system
MJDREF  = 50814.000000000000  / MJD zero point for (native) TT (= 1998-01-01)
MJD-OBS = 53516.257939301￼￼     / MJD for observation in (native) TT

COMMENT      ---------- Time Column -----------------------
TTYPE1  = ’Time    ’          / S/C TT corresponding to mid-exposure
TFORM1  = ’2D      ’          / format of field
TUNIT1  = ’s       ’
TCTYP1  = ’TT      ’
TCNAM1  = ’Terrestrial Time’  / This is TT
TCUNI1  = ’s       ’
</pre></div>
</div>
<p>However, the FITS standard and the <code class="docutils literal notranslate"><span class="pre">astropy</span></code> Time object are not perfectly
mapped and some compromises must be made. To help the user understand how the
<code class="docutils literal notranslate"><span class="pre">astropy</span></code> code deals with these situations, the following text describes the
approach that <code class="docutils literal notranslate"><span class="pre">astropy</span></code> takes in some detail.</p>
<p>To create FITS columns which adhere to the FITS Time standard, we have taken
into account the following important points stated in the <a class="reference external" href="https://ui.adsabs.harvard.edu/abs/2015A%26A...574A..36R/">FITS Time paper</a>.</p>
<p>The strategy used to store <a class="reference internal" href="../../../api/astropy.time.Time.html#astropy.time.Time" title="astropy.time.Time"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Time</span></code></a> columns in FITS tables is to
create a <a class="reference internal" href="../api/headers.html#astropy.io.fits.Header" title="astropy.io.fits.Header"><code class="xref py py-obj docutils literal notranslate"><span class="pre">Header</span></code></a> with the appropriate time coordinate
global reference keywords and the column-specific override keywords. The
module <code class="docutils literal notranslate"><span class="pre">astropy.io.fits.fitstime</span></code> deals with the reading and writing of
Time columns.</p>
<p>The following keywords set the Time Coordinate Frame:</p>
<ul>
<li><p>TIME SCALE</p>
<p>The most important of all of the metadata is the time scale which is a
specification for measuring time.</p>
<pre class="literal-block"><strong>TIMESYS</strong> (string-valued)
Time scale; default UTC

<strong>TCTYPn</strong> (string-valued)
Column-specific override keyword</pre>
<p>The global time scale may be overridden by a time scale recorded in the table
equivalent keyword <code class="docutils literal notranslate"><span class="pre">TCTYPn</span></code> for time coordinates in FITS table columns.
<code class="docutils literal notranslate"><span class="pre">TCTYna</span></code> is used for alternate coordinates.</p>
</li>
<li><p>TIME REFERENCE</p>
<p>The reference point in time to which all times in the HDU are relative.
Since there are no context-specific reference times in case there are
multiple time columns in the same table, we need to adjust the reference
times for the columns using some other keywords.</p>
<p>The reference point in time shall be specified through one of the three
following keywords, which are listed in decreasing order of preference:</p>
<pre class="literal-block"><strong>MJDREF</strong> (floating-valued)
Reference time in MJD

<strong>JDREF</strong> (floating-valued)
Reference time in JD

<strong>DATEREF</strong> (datetime-valued)
Reference time in ISO-8601</pre>
<p>The time reference keywords (MJDREF, JDREF, DATEREF) are interpreted using the
time scale specified in <code class="docutils literal notranslate"><span class="pre">TIMESYS</span></code>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If none of the three keywords are present, there is no problem as long as
all times in the HDU are expressed in ISO-8601 <code class="docutils literal notranslate"><span class="pre">Datetime</span> <span class="pre">Strings</span></code> format:
<code class="docutils literal notranslate"><span class="pre">CCYY-MM-DD[Thh:mm:ss[.s...]]</span></code> (e.g., <code class="docutils literal notranslate"><span class="pre">&quot;2015-04-05T12:22:33.8&quot;</span></code>);
otherwise MJDREF = 0.0 must be assumed.</p>
<p>The value of the reference time has global validity for all time values,
but it does not have a particular time scale associated with it. Thus we
need to use <code class="docutils literal notranslate"><span class="pre">TCRVLn</span></code> (time coordinate reference value) keyword to
compensate for the time scale differences.</p>
</div>
</li>
<li><p>TIME REFERENCE POSITION</p>
<p>The reference position, specified by the keyword <code class="docutils literal notranslate"><span class="pre">TREFPOS</span></code>, specifies the
spatial location at which the time is valid, either where the observation was
made or the point in space for which light-time corrections have been applied.
This may be a standard location (such as <code class="docutils literal notranslate"><span class="pre">GEOCENTER</span></code> or <code class="docutils literal notranslate"><span class="pre">TOPOCENTER</span></code>) or
a point in space defined by specific coordinates.</p>
<pre class="literal-block"><strong>TREFPOS</strong> (string-valued)
Time reference position; default TOPOCENTER

<strong>TRPOSn</strong> (string-valued)
Column-specific override keyword</pre>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For TOPOCENTER, we need to specify the observatory location
(ITRS Cartesian coordinates or geodetic latitude/longitude/height) in the
<code class="docutils literal notranslate"><span class="pre">OBSGEO-*</span></code> keywords.</p>
</div>
</li>
<li><p>TIME REFERENCE DIRECTION</p>
<p>If any pathlength corrections have been applied to the time stamps (i.e., if
the reference position is not <code class="docutils literal notranslate"><span class="pre">TOPOCENTER</span></code> for observational data), the
reference direction that is used in calculating the pathlength delay should
be provided in order to maintain a proper analysis trail of the data.
However, this is useful only if there is also information available on the
location from where the observation was made (the observatory location).</p>
<p>The reference direction is indicated through a reference to specific keywords.
These keywords may explicitly hold the direction or indicate columns holding
the coordinates.</p>
<pre class="literal-block"><strong>TREFDIR</strong> (string-valued)
Pointer to time reference direction

<strong>TRDIRn</strong> (string-valued)
Column-specific override keyword</pre>
</li>
<li><p>TIME UNIT</p>
<p>The FITS standard recommends the time unit to be one of the allowed ones
in the specification.</p>
<pre class="literal-block"><strong>TIMEUNIT</strong> (string-valued)
Time unit; default s

<strong>TCUNIn</strong> (string-valued)
Column-specific override</pre>
</li>
<li><p>TIME OFFSET</p>
<p>It is sometimes convenient to be able to apply a uniform clock correction
in bulk by putting that number in a single keyword. A second use
for a time offset is to set a zero offset to a relative time series,
allowing zero-relative times, or higher precision, in the time stamps.
Its default value is zero.</p>
<pre class="literal-block"><strong>TIMEOFFS</strong> (floating-valued)
This has global validity</pre>
</li>
<li><p>The absolute, relative errors and time resolution, time binning can be used
when needed.</p></li>
</ul>
<p>The following keywords define the global time informational keywords:</p>
<ul>
<li><p>DATE and DATE-* keywords</p>
<p>These define the date of HDU creation and observation in ISO-8601.
<code class="docutils literal notranslate"><span class="pre">DATE</span></code> is in UTC if the file is constructed on the Earth’s surface
and others are in the time scale given by <code class="docutils literal notranslate"><span class="pre">TIMESYS</span></code>.</p>
</li>
<li><p>MJD-* keywords</p>
<p>These define the same as above, but in <code class="docutils literal notranslate"><span class="pre">MJD</span></code> (Modified Julian Date).</p>
</li>
</ul>
<p>The implementation writes a subset of the above FITS keywords, which map
to the Time metadata. Time is intrinsically a coordinate and hence shares
keywords with the <code class="docutils literal notranslate"><span class="pre">World</span> <span class="pre">Coordinate</span> <span class="pre">System</span></code> specification for spatial
coordinates. Therefore, while reading FITS tables with time columns,
the verification that a coordinate column is indeed time is done using
the FITS WCS standard rules and suggestions.</p>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Table Data</a><ul>
<li><a class="reference internal" href="#table-data-as-a-record-array">Table Data as a Record Array</a><ul>
<li><a class="reference internal" href="#what-is-a-record-array">What is a Record Array?</a></li>
<li><a class="reference internal" href="#metadata-of-a-table">Metadata of a Table</a></li>
<li><a class="reference internal" href="#reading-a-fits-table">Reading a FITS Table</a><ul>
<li><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#table-operations">Table Operations</a><ul>
<li><a class="reference internal" href="#selecting-records-in-a-table">Selecting Records in a Table</a><ul>
<li><a class="reference internal" href="#examples">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#merging-tables">Merging Tables</a><ul>
<li><a class="reference internal" href="#id1">Examples</a></li>
</ul>
</li>
<li><a class="reference internal" href="#appending-tables">Appending Tables</a><ul>
<li><a class="reference internal" href="#id2">Examples</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#scaled-data-in-tables">Scaled Data in Tables</a></li>
<li><a class="reference internal" href="#creating-a-fits-table">Creating a FITS Table</a><ul>
<li><a class="reference internal" href="#column-creation">Column Creation</a><ul>
<li><a class="reference internal" href="#id4">Examples</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference internal" href="#fits-tables-with-time-columns">FITS Tables with Time Columns</a><ul>
<li><a class="reference internal" href="#id5">Example</a></li>
</ul>
</li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../../../_sources/io/fits/usage/table.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011–2022, The Astropy Developers.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 3.5.4. &nbsp;
    Last built 09 May 2022. <br/>
  </p>
</footer>
  </body>
</html>