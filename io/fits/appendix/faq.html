


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>astropy.io.fits FAQ &#8212; Astropy v5.2.dev104+gcdd6a1f81.d20220509</title>
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../../../_static/sg_gallery-rendered-html.css" />
    
    <script id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
    <script src="../../../_static/jquery.js"></script>
    <script src="../../../_static/underscore.js"></script>
    <script src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/sidebar.js"></script>
    <script type="text/javascript" src="../../../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../../../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Header Interface Transition Guide" href="header_transition.html" />
    <link rel="prev" title="Obtaining subsets from cloud-hosted FITS files" href="../usage/cloud.html" />
  
  <meta name="robots" content="noindex, nofollow">
  
  
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>


  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../../../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../../../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../../../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../../../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="header_transition.html" title="Header Interface Transition Guide">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="../usage/cloud.html" title="Obtaining subsets from cloud-hosted FITS files">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../../../index.html">Astropy v5.2.dev104+gcdd6a1f81.d20220509</a>
	 &#187;
      </li>
      <li><a href="../index.html" accesskey="U">FITS File Handling (<code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits</span></code>)</a> &#187;</li>
      
      <li>astropy.io.fits FAQ</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="astropy-io-fits-faq">
<span id="io-fits-faq"></span><h1><a class="toc-backref" href="#id1">astropy.io.fits FAQ</a><a class="headerlink" href="#astropy-io-fits-faq" title="Permalink to this headline">¶</a></h1>
<div class="contents topic" id="contents">
<p class="topic-title">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#astropy-io-fits-faq" id="id1">astropy.io.fits FAQ</a></p>
<ul>
<li><p><a class="reference internal" href="#general-questions" id="id2">General Questions</a></p>
<ul>
<li><p><a class="reference internal" href="#what-is-pyfits-and-how-does-it-relate-to-astropy" id="id3">What is PyFITS and how does it relate to <code class="docutils literal notranslate"><span class="pre">astropy</span></code>?</a></p></li>
<li><p><a class="reference internal" href="#what-is-the-development-status-of-pyfits" id="id4">What is the development status of PyFITS?</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#usage-questions" id="id5">Usage Questions</a></p>
<ul>
<li><p><a class="reference internal" href="#something-did-not-work-as-i-expected-did-i-do-something-wrong" id="id6">Something did not work as I expected. Did I do something wrong?</a></p></li>
<li><p><a class="reference internal" href="#astropy-crashed-and-output-a-long-string-of-code-what-do-i-do" id="id7"><code class="docutils literal notranslate"><span class="pre">astropy</span></code> crashed and output a long string of code. What do I do?</a></p></li>
<li><p><a class="reference internal" href="#why-does-opening-a-file-work-in-cfitsio-ds9-etc-but-not-in-astropy" id="id8">Why does opening a file work in CFITSIO, ds9, etc., but not in <code class="docutils literal notranslate"><span class="pre">astropy</span></code>?</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-turn-off-the-warning-messages-astropy-outputs-to-my-console" id="id9">How do I turn off the warning messages <code class="docutils literal notranslate"><span class="pre">astropy</span></code> outputs to my console?</a></p></li>
<li><p><a class="reference internal" href="#what-convention-does-astropy-use-for-indexing-such-as-of-image-coordinates" id="id10">What convention does <code class="docutils literal notranslate"><span class="pre">astropy</span></code> use for indexing, such as of image coordinates?</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-open-a-very-large-image-that-will-not-fit-in-memory" id="id11">How do I open a very large image that will not fit in memory?</a></p></li>
<li><p><a class="reference internal" href="#how-can-i-create-a-very-large-fits-file-from-scratch" id="id12">How can I create a very large FITS file from scratch?</a></p></li>
<li><p><a class="reference internal" href="#how-do-i-create-a-multi-extension-fits-file-from-scratch" id="id13">How do I create a multi-extension FITS file from scratch?</a></p></li>
<li><p><a class="reference internal" href="#why-is-an-image-containing-integer-data-being-converted-unexpectedly-to-floats" id="id14">Why is an image containing integer data being converted unexpectedly to floats?</a></p></li>
<li><p><a class="reference internal" href="#why-am-i-losing-precision-when-i-assign-floating-point-values-in-the-header" id="id15">Why am I losing precision when I assign floating point values in the header?</a></p></li>
<li><p><a class="reference internal" href="#why-is-reading-rows-out-of-a-fits-table-so-slow" id="id16">Why is reading rows out of a FITS table so slow?</a></p></li>
<li><p><a class="reference internal" href="#i-am-opening-many-fits-files-in-a-loop-and-getting-oserror-too-many-open-files" id="id17">I am opening many FITS files in a loop and getting OSError: Too many open files</a></p></li>
<li><p><a class="reference internal" href="#using-header-naxis2-1-does-not-add-another-row-to-my-table" id="id18">Using header[‘NAXIS2’] += 1 does not add another row to my Table</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#comparison-with-other-fits-readers" id="id19">Comparison with Other FITS Readers</a></p>
<ul>
<li><p><a class="reference internal" href="#what-is-the-difference-between-astropy-io-fits-and-fitsio" id="id20">What is the difference between astropy.io.fits and fitsio?</a></p></li>
<li><p><a class="reference internal" href="#why-did-astropy-adopt-pyfits-as-its-fits-reader-instead-of-fitsio" id="id21">Why did Astropy adopt PyFITS as its FITS reader instead of fitsio?</a></p></li>
<li><p><a class="reference internal" href="#what-performance-differences-are-there-between-astropy-io-fits-and-fitsio" id="id22">What performance differences are there between astropy.io.fits and fitsio?</a></p></li>
<li><p><a class="reference internal" href="#why-is-fitsio-so-much-faster-than-astropy-at-reading-tables" id="id23">Why is fitsio so much faster than <code class="docutils literal notranslate"><span class="pre">astropy</span></code> at reading tables?</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="general-questions">
<h2><a class="toc-backref" href="#id2">General Questions</a><a class="headerlink" href="#general-questions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="what-is-pyfits-and-how-does-it-relate-to-astropy">
<h3><a class="toc-backref" href="#id3">What is PyFITS and how does it relate to <code class="docutils literal notranslate"><span class="pre">astropy</span></code>?</a><a class="headerlink" href="#what-is-pyfits-and-how-does-it-relate-to-astropy" title="Permalink to this headline">¶</a></h3>
<p><a class="reference external" href="https://github.com/spacetelescope/pyfits">PyFITS</a> is a library written in, and for use with the <a class="reference external" href="https://www.python.org/">Python</a> programming
language for reading, writing, and manipulating <a class="reference external" href="https://fits.gsfc.nasa.gov/">FITS</a> formatted files. It
includes a high-level interface to FITS headers with the ability for high- and
low-level manipulation of headers, and it supports reading image and table
data as <a class="reference external" href="https://numpy.org/">Numpy</a> arrays. It also supports more obscure and nonstandard formats
found in some FITS files.</p>
<p>The <a class="reference internal" href="../index.html#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits</span></code></a> module is identical to PyFITS but with the names changed.
When the development of <code class="docutils literal notranslate"><span class="pre">astropy</span></code> began, it was clear that one of the core
requirements would be a FITS reader. Rather than starting from scratch,
PyFITS — being the most flexible FITS reader available for Python — was ported
into <code class="docutils literal notranslate"><span class="pre">astropy</span></code>. There are plans to gradually phase out PyFITS as a stand-alone
module and deprecate it in favor of <a class="reference internal" href="../index.html#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits</span></code></a>. See more about this in
the next question.</p>
<p>Although PyFITS is written mostly in Python, it includes an optional module
written in C that is required to read/write compressed image data. However,
the rest of PyFITS functions without this extension module.</p>
</div>
<div class="section" id="what-is-the-development-status-of-pyfits">
<h3><a class="toc-backref" href="#id4">What is the development status of PyFITS?</a><a class="headerlink" href="#what-is-the-development-status-of-pyfits" title="Permalink to this headline">¶</a></h3>
<p>PyFITS was written and maintained by the Science Software Branch at the <a class="reference external" href="https://www.stsci.edu/">Space
Telescope Science Institute</a>, and is licensed by <a class="reference external" href="https://www.aura-astronomy.org/">AURA</a> under a <a class="reference external" href="https://en.wikipedia.org/wiki/BSD_licenses#3-clause_license_.28.22New_BSD_License.22_or_.22Modified_BSD_License.22.29">3-clause BSD
license</a>.</p>
<p>It is now exclusively developed as a component of <code class="docutils literal notranslate"><span class="pre">astropy</span></code>
(<a class="reference internal" href="../index.html#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits</span></code></a>) rather than as a stand-alone module. There are a few
reasons for this: The first is simply to reduce development effort; the
overhead of maintaining both PyFITS <em>and</em> <a class="reference internal" href="../index.html#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits</span></code></a> in separate code
bases is nontrivial. The second is that there are many features of <code class="docutils literal notranslate"><span class="pre">astropy</span></code>
(units, tables, etc.) from which the <a class="reference internal" href="../index.html#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits</span></code></a> module can benefit
greatly. Since PyFITS is already integrated into <code class="docutils literal notranslate"><span class="pre">astropy</span></code>, it makes more
sense to continue development there rather than make <code class="docutils literal notranslate"><span class="pre">astropy</span></code> a dependency
of PyFITS.</p>
<p>PyFITS’ past primary developer and active maintainer was Erik Bray. There
is a <a class="reference external" href="https://github.com/spacetelescope/PyFITS">GitHub project</a> for PyFITS, but PyFITS is not actively developed anymore
so patches and issue reports should be posted on the Astropy issue tracker.</p>
<p>The current (and last) stable release is 3.4.0.</p>
</div>
</div>
<div class="section" id="usage-questions">
<h2><a class="toc-backref" href="#id5">Usage Questions</a><a class="headerlink" href="#usage-questions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="something-did-not-work-as-i-expected-did-i-do-something-wrong">
<h3><a class="toc-backref" href="#id6">Something did not work as I expected. Did I do something wrong?</a><a class="headerlink" href="#something-did-not-work-as-i-expected-did-i-do-something-wrong" title="Permalink to this headline">¶</a></h3>
<p>Possibly. But if you followed the documentation and things still did not work
as expected, it is entirely possible that there is a mistake in the
documentation, a bug in the code, or both. So feel free to report it as a bug.
There are also many, many corner cases in FITS files, with new ones discovered
almost every week. <a class="reference internal" href="../index.html#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits</span></code></a> is always improving, but does not support
all cases perfectly. There are some features of the FITS format (scaled data,
for example) that are difficult to support correctly and can sometimes cause
unexpected behavior.</p>
<p>For the most common cases, however, such as reading and updating FITS headers,
images, and tables, <a class="reference internal" href="../index.html#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits</span></code></a> is very stable and well-tested. Before
every <code class="docutils literal notranslate"><span class="pre">astropy</span></code> release it is ensured that all of its tests pass on a variety
of platforms, and those tests cover the majority of use cases (until new corner
cases are discovered).</p>
</div>
<div class="section" id="astropy-crashed-and-output-a-long-string-of-code-what-do-i-do">
<h3><a class="toc-backref" href="#id7"><code class="docutils literal notranslate"><span class="pre">astropy</span></code> crashed and output a long string of code. What do I do?</a><a class="headerlink" href="#astropy-crashed-and-output-a-long-string-of-code-what-do-i-do" title="Permalink to this headline">¶</a></h3>
<p>This listing of code is what is known as a <a class="reference external" href="https://en.wikipedia.org/wiki/Stack_trace">stack trace</a> (or in Python
parlance a “traceback”). When an unhandled exception occurs in the code
causing the program to end, this is a way of displaying where the exception
occurred and the path through the code that led to it.</p>
<p>As <code class="docutils literal notranslate"><span class="pre">astropy</span></code> is meant to be used as a piece in other software projects, some
exceptions raised by <code class="docutils literal notranslate"><span class="pre">astropy</span></code> are by design. For example, one of the most
common exceptions is a <a class="reference external" href="https://docs.python.org/3/library/exceptions.html#KeyError" title="(in Python v3.10)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">KeyError</span></code></a> when an attempt is made to read
the value of a nonexistent keyword in a header:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">Header</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="p">[</span><span class="s1">&#39;NAXIS&#39;</span><span class="p">]</span>
<span class="gt">Traceback (most recent call last):</span>
    <span class="o">...</span>
<span class="gr">KeyError</span>: <span class="n">&quot;Keyword &#39;NAXIS&#39; not found.&quot;</span>
</pre></div>
</div>
<p>This indicates that something was looking for a keyword called “NAXIS” that
does not exist. If an error like this occurs in some other software that uses
<code class="docutils literal notranslate"><span class="pre">astropy</span></code>, it may indicate a bug in that software, in that it expected to
find a keyword that did not exist in a file.</p>
<p>Most “expected” exceptions will output a message at the end of the traceback
giving some idea of why the exception occurred and what to do about it. The
more vague and mysterious the error message in an exception appears, the more
likely that it was caused by a bug in <code class="docutils literal notranslate"><span class="pre">astropy</span></code>. So if you are getting an
exception and you really do not know why or what to do about it, feel free to
report it as a bug.</p>
</div>
<div class="section" id="why-does-opening-a-file-work-in-cfitsio-ds9-etc-but-not-in-astropy">
<h3><a class="toc-backref" href="#id8">Why does opening a file work in CFITSIO, ds9, etc., but not in <code class="docutils literal notranslate"><span class="pre">astropy</span></code>?</a><a class="headerlink" href="#why-does-opening-a-file-work-in-cfitsio-ds9-etc-but-not-in-astropy" title="Permalink to this headline">¶</a></h3>
<p>As mentioned elsewhere in this FAQ, there are many unusual corner cases when
dealing with FITS files. It is possible that a file should work, but is not
supported due to a bug. Sometimes it is even possible for a file to work in an
older version of <code class="docutils literal notranslate"><span class="pre">astropy</span></code>, but not a newer version due to a regression
that has not been tested for yet.</p>
<p>Another problem with the FITS format is that, as old as it is, there are many
conventions that appear in files from certain sources that do not meet the FITS
standard. And yet they are so commonplace that it is necessary to support
them in any FITS readers. CONTINUE cards are one such example. There are
nonstandard conventions supported by <code class="docutils literal notranslate"><span class="pre">astropy</span></code> that are not supported by
CFITSIO and possibly vice versa. You may have hit one of those cases.</p>
<p>If <code class="docutils literal notranslate"><span class="pre">astropy</span></code> is having trouble opening a file, a good way to rule out whether
not the problem is with <code class="docutils literal notranslate"><span class="pre">astropy</span></code> is to run the file through the <a class="reference external" href="https://heasarc.gsfc.nasa.gov/docs/software/ftools/fitsverify/">fitsverify</a>
program. For smaller files you can even use the <a class="reference external" href="https://fits.gsfc.nasa.gov/fits_verify.html">online FITS verifier</a>.
These use CFITSIO under the hood, and should give a good indication of whether
or not there is something erroneous about the file. If the file is
malformatted, fitsverify will output errors and warnings.</p>
<p>If fitsverify confirms no problems with a file, and <code class="docutils literal notranslate"><span class="pre">astropy</span></code> is still having
trouble opening it (especially if it produces a traceback), then it is possible
there is a bug in <code class="docutils literal notranslate"><span class="pre">astropy</span></code>.</p>
</div>
<div class="section" id="how-do-i-turn-off-the-warning-messages-astropy-outputs-to-my-console">
<h3><a class="toc-backref" href="#id9">How do I turn off the warning messages <code class="docutils literal notranslate"><span class="pre">astropy</span></code> outputs to my console?</a><a class="headerlink" href="#how-do-i-turn-off-the-warning-messages-astropy-outputs-to-my-console" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">astropy</span></code> uses Python’s built-in <a class="reference external" href="https://docs.python.org/3/library/warnings.html">warnings</a> subsystem for informing about
exceptional conditions in the code that are recoverable, but that the user may
want to be informed of. One of the most common warnings in <a class="reference internal" href="../index.html#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits</span></code></a>
occurs when updating a header value in such a way that the comment must be
truncated to preserve space:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Card</span> <span class="ow">is</span> <span class="n">too</span> <span class="n">long</span><span class="p">,</span> <span class="n">comment</span> <span class="ow">is</span> <span class="n">truncated</span><span class="o">.</span>
</pre></div>
</div>
<p>Any console output generated by <code class="docutils literal notranslate"><span class="pre">astropy</span></code> can be assumed to be from the
warnings subsystem. See Astropy’s documentation on the <a class="reference internal" href="../../../warnings.html#python-warnings"><span class="std std-ref">Python warnings system</span></a>
for more information on how to control and quiet warnings.</p>
</div>
<div class="section" id="what-convention-does-astropy-use-for-indexing-such-as-of-image-coordinates">
<h3><a class="toc-backref" href="#id10">What convention does <code class="docutils literal notranslate"><span class="pre">astropy</span></code> use for indexing, such as of image coordinates?</a><a class="headerlink" href="#what-convention-does-astropy-use-for-indexing-such-as-of-image-coordinates" title="Permalink to this headline">¶</a></h3>
<p>All arrays and sequences in <code class="docutils literal notranslate"><span class="pre">astropy</span></code> use a zero-based indexing scheme. For
example, the first keyword in a header is <code class="docutils literal notranslate"><span class="pre">header[0]</span></code>, not <code class="docutils literal notranslate"><span class="pre">header[1]</span></code>.
This is in accordance with Python itself, as well as C, on which Python is
based.</p>
<p>This may come as a surprise to veteran FITS users coming from IRAF, where
1-based indexing is typically used, due to its origins in Fortran.</p>
<p>Likewise, the top-left pixel in an N x N array is <code class="docutils literal notranslate"><span class="pre">data[0,0]</span></code>. The indices
for 2-dimensional arrays are row-major order, in that the first index is the
row number, and the second index is the column number. Or put in terms of
axes, the first axis is the y-axis, and the second axis is the x-axis. This is
the opposite of column-major order, which is used by Fortran and hence FITS.
For example, the second index refers to the axis specified by NAXIS1 in the
FITS header.</p>
<p>In general, for N-dimensional arrays, row-major orders means that the
right-most axis is the one that varies the fastest while moving over the
array data linearly. For example, the 3-dimensional array:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[[[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span>
  <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]],</span>
 <span class="p">[[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span>
  <span class="p">[</span><span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]]]</span>
</pre></div>
</div>
<p>is represented linearly in row-major order as:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">]</span>
</pre></div>
</div>
<p>Since 2 immediately follows 1, you can see that the right-most (or inner-most)
axis is the one that varies the fastest.</p>
<p>The discrepancy in axis-ordering may take some getting used to, but it is a
necessary evil. Since most other Python and C software assumes row-major
ordering, trying to enforce column-major ordering in arrays returned by
<code class="docutils literal notranslate"><span class="pre">astropy</span></code> is likely to cause more difficulties than it is worth.</p>
</div>
<div class="section" id="how-do-i-open-a-very-large-image-that-will-not-fit-in-memory">
<h3><a class="toc-backref" href="#id11">How do I open a very large image that will not fit in memory?</a><a class="headerlink" href="#how-do-i-open-a-very-large-image-that-will-not-fit-in-memory" title="Permalink to this headline">¶</a></h3>
<p><a class="reference internal" href="../api/files.html#astropy.io.fits.open" title="astropy.io.fits.open"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits.open</span></code></a> has an option to access the data portion of an
HDU by memory mapping using <a class="reference external" href="https://en.wikipedia.org/wiki/Mmap">mmap</a>. In <code class="docutils literal notranslate"><span class="pre">astropy</span></code> this is used by default.</p>
<p>What this means is that accessing the data as in the example above only reads
portions of the data into memory on demand. For example, if we request just a
slice of the image, such as <code class="docutils literal notranslate"><span class="pre">hdul[0].data[100:200]</span></code>, then only rows 100-200
will be read into memory. This happens transparently, as though the entire
image were already in memory. This works the same way for tables. For most
cases this is your best bet for working with large files.</p>
<p>To ensure use of memory mapping, add the <code class="docutils literal notranslate"><span class="pre">memmap=True</span></code> argument to
<a class="reference internal" href="../api/files.html#astropy.io.fits.open" title="astropy.io.fits.open"><code class="xref py py-func docutils literal notranslate"><span class="pre">fits.open</span></code></a>. Likewise, using <code class="docutils literal notranslate"><span class="pre">memmap=False</span></code> will
force data to be read entirely into memory.</p>
<p>The default can also be controlled through a configuration option called
<code class="docutils literal notranslate"><span class="pre">USE_MEMMAP</span></code>. Setting this to <code class="docutils literal notranslate"><span class="pre">0</span></code> will disable mmap by default.</p>
<p>Unfortunately, memory mapping does not currently work as well with scaled
image data, where BSCALE and BZERO factors need to be applied to the data to
yield physical values. Currently this requires enough memory to hold the
entire array, though this is an area that will see improvement in the future.</p>
<p>An alternative, which currently only works for image data (that is, non-tables)
is the sections interface. It is largely replaced by the better support for
mmap, but may still be useful on systems with more limited virtual memory
space, such as on 32-bit systems. Support for scaled image data is flaky with
sections too, though that will be fixed. See the documentation on <a class="reference internal" href="../usage/image.html#data-sections"><span class="std std-ref">image
sections</span></a> for more details on using this interface.</p>
</div>
<div class="section" id="how-can-i-create-a-very-large-fits-file-from-scratch">
<h3><a class="toc-backref" href="#id12">How can I create a very large FITS file from scratch?</a><a class="headerlink" href="#how-can-i-create-a-very-large-fits-file-from-scratch" title="Permalink to this headline">¶</a></h3>
<p>See <a class="reference internal" href="../../../generated/examples/io/skip_create-large-fits.html#sphx-glr-generated-examples-io-skip-create-large-fits-py"><span class="std std-ref">Create a very large FITS file from scratch</span></a>.</p>
<p>For creating very large tables, this method may also be used, though it can be
difficult to determine ahead of time how many rows a table will need. In
general, use of the <a class="reference internal" href="../index.html#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits</span></code></a> module is currently discouraged for the
creation and manipulation of large tables. The FITS format itself is not
designed for efficient on-disk or in-memory manipulation of table structures.
For large, heavy-duty table data it might be better too look into using <a class="reference external" href="https://www.hdfgroup.org/HDF5/">HDF5</a>
through the <a class="reference external" href="http://www.pytables.org/">PyTables</a> library. The <a class="reference internal" href="../../../table/index.html#astropy-table"><span class="std std-ref">Astropy Table</span></a>
interface can provide an abstraction layer between different on-disk table
formats as well (for example, for converting a table between FITS and HDF5).</p>
<p>PyTables makes use of NumPy under the hood, and can be used to write binary
table data to disk in the same format required by FITS. It is then possible
to serialize your table to the FITS format for distribution. At some point
this FAQ might provide an example of how to do this.</p>
</div>
<div class="section" id="how-do-i-create-a-multi-extension-fits-file-from-scratch">
<h3><a class="toc-backref" href="#id13">How do I create a multi-extension FITS file from scratch?</a><a class="headerlink" href="#how-do-i-create-a-multi-extension-fits-file-from-scratch" title="Permalink to this headline">¶</a></h3>
<p>See <a class="reference internal" href="../../../generated/examples/io/create-mef.html#sphx-glr-generated-examples-io-create-mef-py"><span class="std std-ref">Create a multi-extension FITS (MEF) file from scratch</span></a>.</p>
</div>
<div class="section" id="why-is-an-image-containing-integer-data-being-converted-unexpectedly-to-floats">
<span id="fits-scaled-data-faq"></span><h3><a class="toc-backref" href="#id14">Why is an image containing integer data being converted unexpectedly to floats?</a><a class="headerlink" href="#why-is-an-image-containing-integer-data-being-converted-unexpectedly-to-floats" title="Permalink to this headline">¶</a></h3>
<p>If the header for your image contains nontrivial values for the optional
BSCALE and/or BZERO keywords (that is, BSCALE != 1 and/or BZERO != 0), then
the raw data in the file must be rescaled to its physical values according to
the formula:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">physical_value</span> <span class="o">=</span> <span class="n">BZERO</span> <span class="o">+</span> <span class="n">BSCALE</span> <span class="o">*</span> <span class="n">array_value</span>
</pre></div>
</div>
<p>As BZERO and BSCALE are floating point values, the resulting value must be a
float as well. If the original values were 16-bit integers, the resulting
values are single-precision (32-bit) floats. If the original values were
32-bit integers, the resulting values are double-precision (64-bit floats).</p>
<p>This automatic scaling can easily catch you off guard if you are not expecting
it, because it does not happen until the data portion of the HDU is accessed
(to allow for things like updating the header without rescaling the data). For
example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">fits_scaledimage_filename</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">util</span><span class="o">.</span><span class="n">get_testdata_filepath</span><span class="p">(</span><span class="s1">&#39;scale.fits&#39;</span><span class="p">)</span>

<span class="gp">&gt;&gt;&gt; </span><span class="n">hdul</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fits_scaledimage_filename</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">hdul</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;BITPIX&#39;</span><span class="p">]</span>
<span class="go">16</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;BSCALE&#39;</span><span class="p">]</span>
<span class="go">0.045777764213996</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span> <span class="o">=</span> <span class="n">image</span><span class="o">.</span><span class="n">data</span>  <span class="c1"># Read the data into memory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">name</span>    <span class="c1"># Got float32 despite BITPIX = 16 (16-bit int)</span>
<span class="go">&#39;float32&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;BITPIX&#39;</span><span class="p">]</span>  <span class="c1"># The BITPIX will automatically update too</span>
<span class="go">-32</span>
<span class="gp">&gt;&gt;&gt; </span><span class="s1">&#39;BSCALE&#39;</span> <span class="ow">in</span> <span class="n">image</span><span class="o">.</span><span class="n">header</span>  <span class="c1"># And the BSCALE keyword removed</span>
<span class="go">False</span>
</pre></div>
</div>
<p>The reason for this is that once a user accesses the data they may also
manipulate it and perform calculations on it. If the data were forced to
remain as integers, a great deal of precision is lost. So it is best to err
on the side of not losing data, at the cost of causing some confusion at
first.</p>
<p>If the data must be returned to integers before saving, use the
<a class="reference internal" href="../api/images.html#astropy.io.fits.ImageHDU.scale" title="astropy.io.fits.ImageHDU.scale"><code class="xref py py-obj docutils literal notranslate"><span class="pre">scale</span></code></a> method:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">image</span><span class="o">.</span><span class="n">scale</span><span class="p">(</span><span class="s1">&#39;int32&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span><span class="o">.</span><span class="n">header</span><span class="p">[</span><span class="s1">&#39;BITPIX&#39;</span><span class="p">]</span>
<span class="go">32</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdul</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<p>Alternatively, if a file is opened with <code class="docutils literal notranslate"><span class="pre">mode='update'</span></code> along with the
<code class="docutils literal notranslate"><span class="pre">scale_back=True</span></code> argument, the original BSCALE and BZERO scaling will
be automatically reapplied to the data before saving. Usually this is
not desirable, especially when converting from floating point values back to
unsigned integer values. But this may be useful in cases where the raw
data needs to be modified corresponding to changes in the physical values.</p>
<p>To prevent rescaling from occurring at all (which is good for updating headers
— even if you do not intend for the code to access the data, it is good to err
on the side of caution here), use the <code class="docutils literal notranslate"><span class="pre">do_not_scale_image_data</span></code> argument when
opening the file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">hdul</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">fits_scaledimage_filename</span><span class="p">,</span> <span class="n">do_not_scale_image_data</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">hdul</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">dtype</span><span class="o">.</span><span class="n">name</span>
<span class="go">&#39;int16&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">hdul</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="why-am-i-losing-precision-when-i-assign-floating-point-values-in-the-header">
<h3><a class="toc-backref" href="#id15">Why am I losing precision when I assign floating point values in the header?</a><a class="headerlink" href="#why-am-i-losing-precision-when-i-assign-floating-point-values-in-the-header" title="Permalink to this headline">¶</a></h3>
<p>The FITS standard allows two formats for storing floating point numbers in a
header value. The “fixed” format requires the ASCII representation of the
number to be in bytes 11 through 30 of the header card, and to be
right-justified. This leaves a standard number of characters for any comment
string.</p>
<p>The fixed format is not wide enough to represent the full range of values that
can be stored in a 64-bit float with full precision. So FITS also supports a
“free” format in which the ASCII representation can be stored anywhere, using
the full 70 bytes of the card (after the keyword).</p>
<p>Currently <code class="docutils literal notranslate"><span class="pre">astropy</span></code> only supports writing fixed format (it can read both
formats), so all floating point values assigned to a header are stored in the
fixed format. There are plans to add support for more flexible formatting.</p>
<p>In the meantime, it is possible to add or update cards by manually formatting
the card image from a string, as it should appear in the FITS file:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">c</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">Card</span><span class="o">.</span><span class="n">fromstring</span><span class="p">(</span><span class="s1">&#39;FOO     = 1234567890.123456789&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span> <span class="o">=</span> <span class="n">fits</span><span class="o">.</span><span class="n">Header</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h</span>
<span class="go">FOO     = 1234567890.123456789</span>
</pre></div>
</div>
<p>As long as you do not assign new values to ‘FOO’ via <code class="docutils literal notranslate"><span class="pre">h['FOO']</span> <span class="pre">=</span> <span class="pre">123</span></code>, will
maintain the header value exactly as you formatted it (as long as it is valid
according to the FITS standard).</p>
</div>
<div class="section" id="why-is-reading-rows-out-of-a-fits-table-so-slow">
<h3><a class="toc-backref" href="#id16">Why is reading rows out of a FITS table so slow?</a><a class="headerlink" href="#why-is-reading-rows-out-of-a-fits-table-so-slow" title="Permalink to this headline">¶</a></h3>
<p>Underlying every table data array returned by <a class="reference internal" href="../index.html#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits</span></code></a> is a <code class="docutils literal notranslate"><span class="pre">numpy</span></code>
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.recarray.html#numpy.recarray" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">recarray</span></code></a> which is a <code class="docutils literal notranslate"><span class="pre">numpy</span></code> array type specifically for representing
structured array data (i.e., a table). As with normal image arrays, <code class="docutils literal notranslate"><span class="pre">astropy</span></code>
accesses the underlying binary data from the FITS file via mmap (see the
question “<a class="reference internal" href="#what-performance-differences-are-there-between-astropy-io-fits-and-fitsio">What performance differences are there between astropy.io.fits and
fitsio?</a>” for a deeper explanation of this). The underlying mmap is then
exposed as a <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.recarray.html#numpy.recarray" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">recarray</span></code></a> and in general this is a very efficient way to
read the data.</p>
<p>However, for many (if not most) FITS tables it is not all that simple. For
many columns there are conversions that have to take place between the actual
data that is “on disk” (in the FITS file) and the data values that are returned
to the user. For example, FITS binary tables represent boolean values
differently from how <code class="docutils literal notranslate"><span class="pre">numpy</span></code> expects them to be represented, “Logical” columns
need to be converted on the fly to a format <code class="docutils literal notranslate"><span class="pre">numpy</span></code> (and hence the user) can
understand. This issue also applies to data that is linearly scaled via the
<code class="docutils literal notranslate"><span class="pre">TSCALn</span></code> and <code class="docutils literal notranslate"><span class="pre">TZEROn</span></code> header keywords.</p>
<p>Supporting all of these “FITS-isms” introduces a lot of overhead that might
not be necessary for all tables, but are still common nonetheless. That is
not to say it cannot be faster even while supporting the peculiarities of
FITS — CFITSIO, for example, supports all of the same features but is orders of
magnitude faster. <code class="docutils literal notranslate"><span class="pre">astropy</span></code> could do much better here too, and there are many
known issues causing slowdown. There are plenty of opportunities for speedups,
and patches are welcome. In the meantime, for high-performance applications
with FITS tables some users might find the <code class="docutils literal notranslate"><span class="pre">fitsio</span></code> library more to their
liking.</p>
</div>
<div class="section" id="i-am-opening-many-fits-files-in-a-loop-and-getting-oserror-too-many-open-files">
<h3><a class="toc-backref" href="#id17">I am opening many FITS files in a loop and getting OSError: Too many open files</a><a class="headerlink" href="#i-am-opening-many-fits-files-in-a-loop-and-getting-oserror-too-many-open-files" title="Permalink to this headline">¶</a></h3>
<p>Say you have some code like:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>

<span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
    <span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdul</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">hdu</span> <span class="ow">in</span> <span class="n">hdul</span><span class="p">:</span>
            <span class="n">hdu_data</span> <span class="o">=</span> <span class="n">hdul</span><span class="o">.</span><span class="n">data</span>
            <span class="c1"># Do some stuff with the data</span>
</pre></div>
</div>
<p>The details may differ, but the qualitative point is that the data to many
HDUs and/or FITS files are being accessed in a loop. This may result in
an exception like:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Traceback</span> <span class="p">(</span><span class="n">most</span> <span class="n">recent</span> <span class="n">call</span> <span class="n">last</span><span class="p">):</span>
  <span class="n">File</span> <span class="s2">&quot;&lt;stdin&gt;&quot;</span><span class="p">,</span> <span class="n">line</span> <span class="mi">2</span><span class="p">,</span> <span class="ow">in</span> <span class="o">&lt;</span><span class="n">module</span><span class="o">&gt;</span>
<span class="ne">OSError</span><span class="p">:</span> <span class="p">[</span><span class="n">Errno</span> <span class="mi">24</span><span class="p">]</span> <span class="n">Too</span> <span class="n">many</span> <span class="nb">open</span> <span class="n">files</span><span class="p">:</span> <span class="s1">&#39;my_data.fits&#39;</span>
</pre></div>
</div>
<p>As explained in the <a class="reference internal" href="../index.html#fits-large-files"><span class="std std-ref">note on working with large files</span></a>,
because <code class="docutils literal notranslate"><span class="pre">astropy</span></code> uses mmap by default to read the data in a FITS file, even
if you correctly close a file with <a class="reference internal" href="../api/hdulists.html#astropy.io.fits.HDUList.close" title="astropy.io.fits.HDUList.close"><code class="xref py py-meth docutils literal notranslate"><span class="pre">HDUList.close</span></code></a> a handle is kept open to that file so
that the memory-mapped data array can still continue to be read transparently.</p>
<p>The way <code class="docutils literal notranslate"><span class="pre">numpy</span></code> supports mmap is such that the file mapping is not closed
until the overlying <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code></a> object has no references to it and is freed
memory. However, when looping over a large number of files (or even just HDUs)
rapidly, this may not happen immediately. Or in some cases if the HDU object
persists, the data array attached to it may persist too. The recommended
workaround is to <em>manually</em> delete the <code class="docutils literal notranslate"><span class="pre">.data</span></code> attribute on the HDU object so
that the <a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code></a> reference is freed and the mmap can be closed:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">astropy.io</span> <span class="kn">import</span> <span class="n">fits</span>

<span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
    <span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdul</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">hdu</span> <span class="ow">in</span> <span class="n">hdul</span><span class="p">:</span>
            <span class="n">hdu_data</span> <span class="o">=</span> <span class="n">hdul</span><span class="o">.</span><span class="n">data</span>
            <span class="c1"># Do some stuff with the data</span>
            <span class="c1"># ...</span>
            <span class="c1"># Don&#39;t need the data anymore; delete all references to it</span>
            <span class="c1"># so that it can be garbage collected</span>
            <span class="k">del</span> <span class="n">hdu_data</span>
            <span class="k">del</span> <span class="n">hdu</span><span class="o">.</span><span class="n">data</span>
</pre></div>
</div>
<p>In some extreme cases files are opened and closed fast enough that Python’s
garbage collector does not free them (and hence free the file handles) often
enough. To mitigate this, your code can manually force a garbage collection
by calling <a class="reference external" href="https://docs.python.org/3/library/gc.html#gc.collect" title="(in Python v3.10)"><code class="xref py py-func docutils literal notranslate"><span class="pre">gc.collect()</span></code></a> at the end of the loop.</p>
<p>In a future release it will be more convenient to automatically perform this
sort of cleanup when closing FITS files, where needed.</p>
</div>
<div class="section" id="using-header-naxis2-1-does-not-add-another-row-to-my-table">
<h3><a class="toc-backref" href="#id18">Using header[‘NAXIS2’] += 1 does not add another row to my Table</a><a class="headerlink" href="#using-header-naxis2-1-does-not-add-another-row-to-my-table" title="Permalink to this headline">¶</a></h3>
<p><code class="docutils literal notranslate"><span class="pre">NAXIS</span></code> and similar keywords are FITS <em>structural</em> keywords and should not be
modified by the user. They are automatically updated by <a class="reference internal" href="../index.html#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-mod docutils literal notranslate"><span class="pre">astropy.io.fits</span></code></a>
when checking the validity of the data and headers. See <a class="reference internal" href="../index.html#structural-keywords"><span class="std std-ref">Structural Keywords</span></a>
for more information.</p>
<p>To add rows to a table, you can modify the actual data.</p>
</div>
</div>
<div class="section" id="comparison-with-other-fits-readers">
<h2><a class="toc-backref" href="#id19">Comparison with Other FITS Readers</a><a class="headerlink" href="#comparison-with-other-fits-readers" title="Permalink to this headline">¶</a></h2>
<div class="section" id="what-is-the-difference-between-astropy-io-fits-and-fitsio">
<h3><a class="toc-backref" href="#id20">What is the difference between astropy.io.fits and fitsio?</a><a class="headerlink" href="#what-is-the-difference-between-astropy-io-fits-and-fitsio" title="Permalink to this headline">¶</a></h3>
<p>The <a class="reference internal" href="../index.html#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits</span></code></a> module (originally PyFITS) is a “pure Python” FITS
reader in that all of the code for parsing the FITS file format is in Python,
though <code class="docutils literal notranslate"><span class="pre">numpy</span></code> is used to provide access to the FITS data via the
<a class="reference external" href="https://numpy.org/doc/stable/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.22)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ndarray</span></code></a> interface. <a class="reference internal" href="../index.html#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits</span></code></a> currently also accesses the
<a class="reference external" href="https://heasarc.gsfc.nasa.gov/fitsio/fitsio.html">CFITSIO</a> to support the
FITS Tile Compression convention, but this feature is optional. It does not
use CFITSIO outside of reading compressed images.</p>
<p><a class="reference external" href="https://github.com/esheldon/fitsio">fitsio</a>, on the other hand, is a Python
wrapper for the CFITSIO library. All of the heavy lifting of reading the FITS
format is handled by CFITSIO, while <code class="docutils literal notranslate"><span class="pre">fitsio</span></code> provides a better way to use
object-oriented API, including providing a <code class="docutils literal notranslate"><span class="pre">numpy</span></code> interface to FITS files
read from CFITSIO. Much of it is written in C (to provide the interface between
Python and CFITSIO), and the rest is in Python. The Python end mostly
provides the documentation and user-level API.</p>
<p>Because <code class="docutils literal notranslate"><span class="pre">fitsio</span></code> wraps CFITSIO it inherits most of its strengths and
weaknesses, though it has an added strength of providing a more convenient
API than if one were to use CFITSIO directly.</p>
</div>
<div class="section" id="why-did-astropy-adopt-pyfits-as-its-fits-reader-instead-of-fitsio">
<h3><a class="toc-backref" href="#id21">Why did Astropy adopt PyFITS as its FITS reader instead of fitsio?</a><a class="headerlink" href="#why-did-astropy-adopt-pyfits-as-its-fits-reader-instead-of-fitsio" title="Permalink to this headline">¶</a></h3>
<p>When the Astropy Project was first started it was clear from the start that
one of its core components should be a submodule for reading and writing FITS
files, as many other components would be likely to depend on this
functionality. At the time, the <code class="docutils literal notranslate"><span class="pre">fitsio</span></code> package was in its infancy (it
goes back to roughly 2011) while PyFITS had already been established (going
back to before the year 2000). It was already a mature package with support
for the vast majority of FITS files found in the wild, including outdated
formats such as “Random Groups” FITS files still used extensively in the
radio astronomy community.</p>
<p>Although many aspects of PyFITS’ interface have evolved over the years, much
of it has also remained the same, and is already familiar to astronomers
working with FITS files in Python. Most of if not all existing training
materials were also based around PyFITS. PyFITS was developed at STScI, which
also put forward significant resources to develop Astropy, with an eye toward
integrating Astropy into STScI’s own software stacks. As most of the Python
software at STScI uses PyFITS, it was the only practical choice for making that
transition.</p>
<p>Finally, although CFITSIO (and by extension <code class="docutils literal notranslate"><span class="pre">fitsio</span></code>) can read any FITS files
that conform to the FITS standard, it does not support all of the nonstandard
conventions that have been added to FITS files in the wild. While it does have
some support for some of these conventions (such as CONTINUE cards and, to a
limited extent, HIERARCH cards), it is not easy to add support for other
conventions to a large and complex C codebase.</p>
<p>PyFITS’ object-oriented design makes supporting nonstandard conventions
somewhat easier in most cases, and as such PyFITS can be more flexible in the
types of FITS files it can read and return <em>useful</em> data from. This includes
better support for files that fail to meet the FITS standard, but still contain
useful data that should be readable enough to correct any violations of the
FITS standard. For example, a common error in non-English speaking regions is
to insert non-ASCII characters into FITS headers. This is not a valid FITS
file, but should still be readable in some sense. Supporting structural errors
such as this is more difficult in CFITSIO which assumes a more rigid structure.</p>
</div>
<div class="section" id="what-performance-differences-are-there-between-astropy-io-fits-and-fitsio">
<h3><a class="toc-backref" href="#id22">What performance differences are there between astropy.io.fits and fitsio?</a><a class="headerlink" href="#what-performance-differences-are-there-between-astropy-io-fits-and-fitsio" title="Permalink to this headline">¶</a></h3>
<p>There are two main performance areas to look at: reading/parsing FITS headers
and reading FITS data (image-like arrays as well as tables).</p>
<p>In the area of headers, <code class="docutils literal notranslate"><span class="pre">fitsio</span></code> is significantly faster in most cases. This
is due in large part to the (almost) pure C implementation (due to the use of
CFITSIO), but also due to fact that it is more rigid and does not support as
many local conventions and other special cases as <a class="reference internal" href="../index.html#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits</span></code></a> tries to
support in its pure Python implementation.</p>
<p>That said, the difference is small and only likely to be a bottleneck either
when opening files containing thousands of HDUs, or reading the headers out
of thousands of FITS files in succession (in either case the difference is
not even an order of magnitude).</p>
<p>Where data is concerned the situation is a little more complicated, and
requires some understanding of how <a class="reference internal" href="../index.html#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits</span></code></a> is implemented versus
CFITSIO and <code class="docutils literal notranslate"><span class="pre">fitsio</span></code>. First, it is important to understand how they differ in
terms of memory management.</p>
<p><a class="reference internal" href="../index.html#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits</span></code></a> uses mmap, by default, to provide access to the raw
binary data in FITS files. Mmap is a system call (or in most cases these days
a wrapper in your libc for a lower-level system call) which allows user-space
applications to essentially do the same thing your OS is doing when it uses a
pagefile (swap space) for virtual memory: it allows data in a file on disk to
be paged into physical memory one page (or in practice usually several pages)
at a time on an as-needed basis. These cached pages of the file are also
accessible from all processes on the system, so multiple processes can read
from the same file with little additional overhead. In the case of reading
over all of the data in the file, the performance difference between using mmap
versus reading the entire data into physical memory at once can vary widely
between systems, hardware, and depending on what else is happening on the
system at the moment, but mmap is almost always going to be better.</p>
<p>In principle, it requires more overhead since accessing each page will result in
a page fault and the system requires more requests to the disk. But in
practice, the OS will optimize this pretty aggressively, especially for the most
common case of sequential access — also in reality, reading the entire thing
into memory is still going to result in a whole lot of page faults too. For
random access, having all of the data in physical memory is always going to be
best, though with mmap it is usually going to be pretty good too. (Most users
do not normally access all of the data in a file in a totally random order —
usually a few sections of it will be accessed most frequently, so the OS will
keep those pages in physical memory as best it can.) For the most general case
of reading FITS files (or most large data on disk) this is therefore the best
choice, especially for casual users, and is hence enabled by default.</p>
<p>CFITSIO/<code class="docutils literal notranslate"><span class="pre">fitsio</span></code>, on the other hand, does not assume the existence of
technologies like mmap and page caching. Thus it implements its own LRU cache
of I/O buffers that store sections of FITS files read from disk in memory in
FITS’ famous 2880 byte chunk size. The I/O buffers are used heavily in
particular for keeping the headers in memory. Though for large data reads (for
example, reading an entire image from a file), it <em>does</em> bypass the cache and
instead does a read directly from disk into a user-provided memory buffer.</p>
<p>However, even when CFITSIO reads direct from the file, this is still largely
less efficient than using mmap. Normally when your OS reads a file from disk,
it caches as much of that read as it can in physical memory (in its page cache)
so that subsequent access to those same pages does not require a subsequent
expensive disk read. This happens when using mmap too, since the data has to
be copied from disk into RAM at some point. The difference is that when using
mmap to access the data, the program is able to read that data <em>directly</em> out
of the OS’s page cache (as long as it is only being read). On the other hand,
when reading data from a file into a local buffer such as with fread(), the
data is first read into the page cache (if not already present) and then copied
from the page cache into the local buffer. So every read performs at least one
additional memory copy per page read (requiring twice as much physical memory,
and possibly lots of paging if the file is large and pages need to dropped from
the cache).</p>
<p>The user API for CFITSIO usually works by having the user allocate a memory
buffer large enough to hold the image/table they want to read (or at least the
section they are interested in). There are some helper functions for
determining the appropriate amount of space to allocate. Then you pass in
a pointer to your buffer and CFITSIO handles all of the reading (usually using
the process described above), and copies the results into your user buffer. For
large reads, it reads directly from the file into your buffer, though if the
data needs to be scaled it makes a stop in CFITSIO’s own buffer first, then
writes the rescaled values out to the user buffer (if rescaling has been
requested). Regardless, this means that if your program wishes to hold an
entire image in memory at once it will use as much RAM as the size of the
data. For most applications it is better (and sufficient) to work on
smaller sections of the data, but this requires extra complexity. Using mmap
on the other hand makes managing this complexity more efficient.</p>
<p>An informal test demonstrates this difference. This test was performed on four
simple FITS images (one of which is a cube) of dimensions 256x256, 1024x1024,
4096x4096, and 256x1024x1024. Each image was generated before the test and
filled with randomized 64-bit floating point values. A similar test was
performed using both <a class="reference internal" href="../index.html#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits</span></code></a> and <code class="docutils literal notranslate"><span class="pre">fitsio</span></code>. A handle to the FITS
file is opened using each library’s basic semantics, and then the entire data
array of the files is copied into a temporary array in memory (for example, if
we were blitting the image to a video buffer). For <code class="docutils literal notranslate"><span class="pre">astropy</span></code> the test is
written:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">read_test_astropy</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">fits</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="n">memmap</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span> <span class="k">as</span> <span class="n">hdul</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">hdul</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">data</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
<p>The test was timed in IPython on a Linux system with kernel version 2.6.32, a
6-core Intel Xeon X5650 CPU clocked at 2.67 GHz per core, and 11.6 GB of RAM
using:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
    <span class="o">%</span><span class="n">timeit</span> <span class="n">read_test_astropy</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">filenames</span></code> is just a list of the aforementioned generated sample
files. The results were:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">256</span><span class="n">x256</span><span class="o">.</span><span class="n">fits</span>
<span class="mi">1000</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span> <span class="mf">1.28</span> <span class="n">ms</span> <span class="n">per</span> <span class="n">loop</span>
<span class="mi">1024</span><span class="n">x1024</span><span class="o">.</span><span class="n">fits</span>
<span class="mi">100</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span> <span class="mf">4.24</span> <span class="n">ms</span> <span class="n">per</span> <span class="n">loop</span>
<span class="mi">4096</span><span class="n">x4096</span><span class="o">.</span><span class="n">fits</span>
<span class="mi">10</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span> <span class="mf">60.6</span> <span class="n">ms</span> <span class="n">per</span> <span class="n">loop</span>
<span class="mi">256</span><span class="n">x1024x1024</span><span class="o">.</span><span class="n">fits</span>
<span class="mi">1</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span> <span class="mf">1.15</span> <span class="n">s</span> <span class="n">per</span> <span class="n">loop</span>
</pre></div>
</div>
<p>For <code class="docutils literal notranslate"><span class="pre">fitsio</span></code> the test was:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">read_test_fitsio</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="k">with</span> <span class="n">fitsio</span><span class="o">.</span><span class="n">FITS</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">data</span> <span class="o">=</span> <span class="n">f</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
        <span class="n">c</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</pre></div>
</div>
<p>This was also run in a loop over all of the sample files, producing the
results:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">256</span><span class="n">x256</span><span class="o">.</span><span class="n">fits</span>
<span class="mi">1000</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">476</span> <span class="n">µs</span> <span class="n">per</span> <span class="n">loop</span>
<span class="mi">1024</span><span class="n">x1024</span><span class="o">.</span><span class="n">fits</span>
<span class="mi">100</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span> <span class="mf">12.2</span> <span class="n">ms</span> <span class="n">per</span> <span class="n">loop</span>
<span class="mi">4096</span><span class="n">x4096</span><span class="o">.</span><span class="n">fits</span>
<span class="mi">10</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span> <span class="mi">136</span> <span class="n">ms</span> <span class="n">per</span> <span class="n">loop</span>
<span class="mi">256</span><span class="n">x1024x1024</span><span class="o">.</span><span class="n">fits</span>
<span class="mi">1</span> <span class="n">loops</span><span class="p">,</span> <span class="n">best</span> <span class="n">of</span> <span class="mi">3</span><span class="p">:</span> <span class="mf">3.65</span> <span class="n">s</span> <span class="n">per</span> <span class="n">loop</span>
</pre></div>
</div>
<p>It should be made clear that the sample files were rewritten with new random
data between the <code class="docutils literal notranslate"><span class="pre">astropy</span></code> test and the fitsio test, so they were not reading
the same data from the OS’s page cache. Fitsio was much faster on the small
(256x256) image because in that case the time is dominated by parsing the
headers. As already explained, this is much faster in CFITSIO. However, as
the data size goes up and the header parsing no longer dominates the time,
<a class="reference internal" href="../index.html#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits</span></code></a> using mmap is roughly twice as fast. This discrepancy is
almost entirely due to it requiring roughly half as many in-memory copies
to read the data, as explained earlier. That said, more extensive benchmarking
could be very interesting.</p>
<p>This is also not to say that <a class="reference internal" href="../index.html#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits</span></code></a> does better in all cases. There
are some cases where it is currently blown away by fitsio. See the subsequent
question.</p>
</div>
<div class="section" id="why-is-fitsio-so-much-faster-than-astropy-at-reading-tables">
<h3><a class="toc-backref" href="#id23">Why is fitsio so much faster than <code class="docutils literal notranslate"><span class="pre">astropy</span></code> at reading tables?</a><a class="headerlink" href="#why-is-fitsio-so-much-faster-than-astropy-at-reading-tables" title="Permalink to this headline">¶</a></h3>
<p>In many cases it is not: there is either no difference, or it may be a little
faster in <code class="docutils literal notranslate"><span class="pre">astropy</span></code> depending on what you are trying to do with the table and
what types of columns or how many columns the table has. There are some
cases, however, where <code class="docutils literal notranslate"><span class="pre">fitsio</span></code> can be radically faster, mostly for reasons
explained above in “<a class="reference internal" href="#why-is-reading-rows-out-of-a-fits-table-so-slow">Why is reading rows out of a FITS table so slow?</a>”</p>
<p>In principle a table is no different from, say, an array of pixels. But
instead of pixels each element of the array is some kind of record structure
(for example, two floats, a boolean, and a 20-character string field). Just as
a 64-bit float is an 8 byte record in an array, a row in such a table can be
thought of as a 37 byte (in the case of the previous example) record in a 1D
array of rows. So in principle everything that was explained in the answer to
the question “<a class="reference internal" href="#what-performance-differences-are-there-between-astropy-io-fits-and-fitsio">What performance differences are there between astropy.io.fits
and fitsio?</a>” applies just as well to tables as it does to any other array.</p>
<p>However, FITS tables have many additional complexities that sometimes preclude
streaming the data directly from disk, and instead require transformation from
the on-disk FITS format to a format more immediately useful to the user. A
common example is how FITS represents boolean values in binary tables.
Another significantly more complicated example, is variable length arrays.</p>
<p>As explained in “<a class="reference internal" href="#why-is-reading-rows-out-of-a-fits-table-so-slow">Why is reading rows out of a FITS table so slow?</a>”,
<a class="reference internal" href="../index.html#module-astropy.io.fits" title="astropy.io.fits"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.io.fits</span></code></a> does not currently handle some of these cases as
efficiently as it could, in particular in cases where a user only wishes to
read a few rows out of a table. Fitsio, on the other hand, has a better
interface for copying one row at a time out of a table and performing the
necessary transformations on that row <em>only</em>, rather than on the entire column
or columns that the row is taken from. As such, for many cases <code class="docutils literal notranslate"><span class="pre">fitsio</span></code> gets
much better performance and should be preferred for many performance-critical
table operations.</p>
<p>Fitsio also exposes a microlanguage (implemented in CFITSIO) for making
efficient SQL-like queries of tables (single tables only though — no joins or
anything like that). This format, described in the <a class="reference external" href="https://heasarc.gsfc.nasa.gov/docs/software/fitsio/c/c_user/node97.html">CFITSIO documentation</a> can
in some cases perform more efficient selections of rows than might be possible
with <code class="docutils literal notranslate"><span class="pre">numpy</span></code> alone, which requires creating an intermediate mask array in
order to perform row selection.</p>
</div>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">astropy.io.fits FAQ</a><ul>
<li><a class="reference internal" href="#general-questions">General Questions</a><ul>
<li><a class="reference internal" href="#what-is-pyfits-and-how-does-it-relate-to-astropy">What is PyFITS and how does it relate to <code class="docutils literal notranslate"><span class="pre">astropy</span></code>?</a></li>
<li><a class="reference internal" href="#what-is-the-development-status-of-pyfits">What is the development status of PyFITS?</a></li>
</ul>
</li>
<li><a class="reference internal" href="#usage-questions">Usage Questions</a><ul>
<li><a class="reference internal" href="#something-did-not-work-as-i-expected-did-i-do-something-wrong">Something did not work as I expected. Did I do something wrong?</a></li>
<li><a class="reference internal" href="#astropy-crashed-and-output-a-long-string-of-code-what-do-i-do"><code class="docutils literal notranslate"><span class="pre">astropy</span></code> crashed and output a long string of code. What do I do?</a></li>
<li><a class="reference internal" href="#why-does-opening-a-file-work-in-cfitsio-ds9-etc-but-not-in-astropy">Why does opening a file work in CFITSIO, ds9, etc., but not in <code class="docutils literal notranslate"><span class="pre">astropy</span></code>?</a></li>
<li><a class="reference internal" href="#how-do-i-turn-off-the-warning-messages-astropy-outputs-to-my-console">How do I turn off the warning messages <code class="docutils literal notranslate"><span class="pre">astropy</span></code> outputs to my console?</a></li>
<li><a class="reference internal" href="#what-convention-does-astropy-use-for-indexing-such-as-of-image-coordinates">What convention does <code class="docutils literal notranslate"><span class="pre">astropy</span></code> use for indexing, such as of image coordinates?</a></li>
<li><a class="reference internal" href="#how-do-i-open-a-very-large-image-that-will-not-fit-in-memory">How do I open a very large image that will not fit in memory?</a></li>
<li><a class="reference internal" href="#how-can-i-create-a-very-large-fits-file-from-scratch">How can I create a very large FITS file from scratch?</a></li>
<li><a class="reference internal" href="#how-do-i-create-a-multi-extension-fits-file-from-scratch">How do I create a multi-extension FITS file from scratch?</a></li>
<li><a class="reference internal" href="#why-is-an-image-containing-integer-data-being-converted-unexpectedly-to-floats">Why is an image containing integer data being converted unexpectedly to floats?</a></li>
<li><a class="reference internal" href="#why-am-i-losing-precision-when-i-assign-floating-point-values-in-the-header">Why am I losing precision when I assign floating point values in the header?</a></li>
<li><a class="reference internal" href="#why-is-reading-rows-out-of-a-fits-table-so-slow">Why is reading rows out of a FITS table so slow?</a></li>
<li><a class="reference internal" href="#i-am-opening-many-fits-files-in-a-loop-and-getting-oserror-too-many-open-files">I am opening many FITS files in a loop and getting OSError: Too many open files</a></li>
<li><a class="reference internal" href="#using-header-naxis2-1-does-not-add-another-row-to-my-table">Using header[‘NAXIS2’] += 1 does not add another row to my Table</a></li>
</ul>
</li>
<li><a class="reference internal" href="#comparison-with-other-fits-readers">Comparison with Other FITS Readers</a><ul>
<li><a class="reference internal" href="#what-is-the-difference-between-astropy-io-fits-and-fitsio">What is the difference between astropy.io.fits and fitsio?</a></li>
<li><a class="reference internal" href="#why-did-astropy-adopt-pyfits-as-its-fits-reader-instead-of-fitsio">Why did Astropy adopt PyFITS as its FITS reader instead of fitsio?</a></li>
<li><a class="reference internal" href="#what-performance-differences-are-there-between-astropy-io-fits-and-fitsio">What performance differences are there between astropy.io.fits and fitsio?</a></li>
<li><a class="reference internal" href="#why-is-fitsio-so-much-faster-than-astropy-at-reading-tables">Why is fitsio so much faster than <code class="docutils literal notranslate"><span class="pre">astropy</span></code> at reading tables?</a></li>
</ul>
</li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../../../_sources/io/fits/appendix/faq.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011–2022, The Astropy Developers.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 3.5.4. &nbsp;
    Last built 09 May 2022. <br/>
  </p>
</footer>
  </body>
</html>