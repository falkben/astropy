


<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Solar System Ephemerides &#8212; Astropy v5.2.dev94+gb1133d712.d20220509</title>
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/bootstrap-astropy.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-binder.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-dataframe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sg_gallery-rendered-html.css" />
    
    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/sidebar.js"></script>
    <script type="text/javascript" src="../_static/copybutton.js"></script>
    <link rel="shortcut icon" href="../_static/astropy_logo.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Working with Earth Satellites Using Astropy Coordinates" href="satellites.html" />
    <link rel="prev" title="Transforming between Systems" href="transforming.html" />
  
  <meta name="robots" content="noindex, nofollow">
  
  
    <link href='https://fonts.googleapis.com/css?family=Source+Sans+Pro:200,600' rel='stylesheet' type='text/css'/>


  </head><body>
<div class="topbar">
  <a class="brand" title="Documentation Home" href="../index.html"><span id="logotext1">astro</span><span id="logotext2">py</span><span id="logotext3">:docs</span></a>
  <ul>
    
    <li><a class="homelink" title="Astropy Homepage" href="http://www.astropy.org"></a></li>
    <li><a title="General Index" href="../genindex.html">Index</a></li>
    <li><a title="Module Index" href="../py-modindex.html">Modules</a></li>
    <li>
      
      
<form action="../search.html" method="get">
  <input type="text" name="q" placeholder="Search" />
  <input type="hidden" name="check_keywords" value="yes" />
  <input type="hidden" name="area" value="default" />
</form>
      
    </li>
  </ul>
</div>

<div class="related">
    <h3>Navigation</h3>
    <ul>
      <li class="right">
	<a href="satellites.html" title="Working with Earth Satellites Using Astropy Coordinates">
	  next &raquo;
	</a>
      </li>
      <li class="right">
	<a href="transforming.html" title="Transforming between Systems">
	  &laquo; previous
	</a>
	 |
      </li>
      <li>
	<a href="../index.html">Astropy v5.2.dev94+gb1133d712.d20220509</a>
	 &#187;
      </li>
      <li><a href="index.html" accesskey="U">Astronomical Coordinate Systems (<code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.coordinates</span></code>)</a> &#187;</li>
      
      <li>Solar System Ephemerides</li> 
    </ul>
</div>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="solar-system-ephemerides">
<span id="astropy-coordinates-solarsystem"></span><h1>Solar System Ephemerides<a class="headerlink" href="#solar-system-ephemerides" title="Permalink to this headline">¶</a></h1>
<p><a class="reference internal" href="index.html#module-astropy.coordinates" title="astropy.coordinates"><code class="xref py py-obj docutils literal notranslate"><span class="pre">astropy.coordinates</span></code></a> can calculate the <a class="reference internal" href="../api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord" title="astropy.coordinates.SkyCoord"><code class="xref py py-class docutils literal notranslate"><span class="pre">SkyCoord</span></code></a> of some of the major solar
system objects. By default, it uses approximate orbital elements calculated
using <a class="reference external" href="http://pyerfa.readthedocs.org/">PyERFA</a> routines, but it can
also use more precise ones using the JPL ephemerides (which are derived from
dynamical models). The default JPL ephemerides (DE430) provide predictions
valid roughly for the years between 1550 and 2650. The file is 115 MB and will
need to be downloaded the first time you use this functionality, but will be
cached after that. Other JPL ephemerides can be requested by name for specific
use cases you may have (see the examples below).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Using JPL ephemerides requires that the <a class="reference external" href="https://pypi.org/project/jplephem/">jplephem</a> package be installed. This is
most conveniently achieved via <code class="docutils literal notranslate"><span class="pre">pip</span> <span class="pre">install</span> <span class="pre">jplephem</span></code>, although whatever
package management system you use might have it as well.</p>
</div>
<p>Three functions are provided; <a class="reference internal" href="../api/astropy.coordinates.get_body.html#astropy.coordinates.get_body" title="astropy.coordinates.get_body"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_body()</span></code></a>,
<a class="reference internal" href="../api/astropy.coordinates.get_moon.html#astropy.coordinates.get_moon" title="astropy.coordinates.get_moon"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_moon()</span></code></a> and
<a class="reference internal" href="../api/astropy.coordinates.get_body_barycentric.html#astropy.coordinates.get_body_barycentric" title="astropy.coordinates.get_body_barycentric"><code class="xref py py-meth docutils literal notranslate"><span class="pre">get_body_barycentric()</span></code></a>. The first two functions
return <a class="reference internal" href="../api/astropy.coordinates.SkyCoord.html#astropy.coordinates.SkyCoord" title="astropy.coordinates.SkyCoord"><code class="xref py py-class docutils literal notranslate"><span class="pre">SkyCoord</span></code></a> objects in the <a class="reference internal" href="../api/astropy.coordinates.GCRS.html#astropy.coordinates.GCRS" title="astropy.coordinates.GCRS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">GCRS</span></code></a> frame, while the
latter returns a <a class="reference internal" href="../api/astropy.coordinates.CartesianRepresentation.html#astropy.coordinates.CartesianRepresentation" title="astropy.coordinates.CartesianRepresentation"><code class="xref py py-obj docutils literal notranslate"><span class="pre">CartesianRepresentation</span></code></a> of the
barycentric position of a body (i.e., in the <a class="reference internal" href="../api/astropy.coordinates.ICRS.html#astropy.coordinates.ICRS" title="astropy.coordinates.ICRS"><code class="xref py py-obj docutils literal notranslate"><span class="pre">ICRS</span></code></a> frame).</p>
<div class="section" id="examples">
<h2>Examples<a class="headerlink" href="#examples" title="Permalink to this headline">¶</a></h2>
<p>Here is an example of using these functions with built-in ephemerides (i.e.,
without the need to download a large ephemerides file):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.time</span> <span class="kn">import</span> <span class="n">Time</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">solar_system_ephemeris</span><span class="p">,</span> <span class="n">EarthLocation</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">astropy.coordinates</span> <span class="kn">import</span> <span class="n">get_body_barycentric</span><span class="p">,</span> <span class="n">get_body</span><span class="p">,</span> <span class="n">get_moon</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">t</span> <span class="o">=</span> <span class="n">Time</span><span class="p">(</span><span class="s2">&quot;2014-09-22 23:22&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loc</span> <span class="o">=</span> <span class="n">EarthLocation</span><span class="o">.</span><span class="n">of_site</span><span class="p">(</span><span class="s1">&#39;greenwich&#39;</span><span class="p">)</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">solar_system_ephemeris</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;builtin&#39;</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">jup</span> <span class="o">=</span> <span class="n">get_body</span><span class="p">(</span><span class="s1">&#39;jupiter&#39;</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">loc</span><span class="p">)</span> 
<span class="gp">&gt;&gt;&gt; </span><span class="n">jup</span>  
<span class="go">&lt;SkyCoord (GCRS: obstime=2014-09-22 23:22:00.000, obsgeoloc=(3949481.69182405, -550931.91022387, 4961151.73597633) m, obsgeovel=(40.159527, 287.47873161, -0.04597922) m / s): (ra, dec, distance) in (deg, deg, AU)</span>
<span class="go">    (136.91116253, 17.02935396, 5.94386022)&gt;</span>
</pre></div>
</div>
<p>Above, we used <code class="docutils literal notranslate"><span class="pre">solar_system_ephemeris</span></code> as a context, which sets the default
ephemeris while in the <code class="docutils literal notranslate"><span class="pre">with</span></code> clause, and resets it at the end.</p>
<p>To get more precise positions than is possible with the built-in ephemeris
(see <a class="reference internal" href="#astropy-coordinates-solarsystem-erfa-precision"><span class="std std-ref">Precision of the Built-In Ephemeris</span></a>), you
could use the <code class="docutils literal notranslate"><span class="pre">de430</span></code> ephemeris mentioned above, or, if you only care about
times between 1950 and 2050, opt for the <code class="docutils literal notranslate"><span class="pre">de432s</span></code> ephemeris, which is stored
in a smaller, ~10 MB, file (which will be downloaded and cached when the
ephemeris is set):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">solar_system_ephemeris</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;de432s&#39;</span><span class="p">)</span> 
<span class="go">&lt;ScienceState solar_system_ephemeris: &#39;de432s&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_body</span><span class="p">(</span><span class="s1">&#39;jupiter&#39;</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">loc</span><span class="p">)</span> 
<span class="go">&lt;SkyCoord (GCRS: obstime=2014-09-22 23:22:00.000, obsgeoloc=(3949481.69182405, -550931.91022387, 4961151.73597633) m, obsgeovel=(40.159527, 287.47873161, -0.04597922) m / s): (ra, dec, distance) in (deg, deg, km)</span>
<span class="go">    (136.90234846, 17.03160654, 8.89196021e+08)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_moon</span><span class="p">(</span><span class="n">t</span><span class="p">,</span> <span class="n">loc</span><span class="p">)</span> 
<span class="go">&lt;SkyCoord (GCRS: obstime=2014-09-22 23:22:00.000, obsgeoloc=(3949481.69182405, -550931.91022387, 4961151.73597633) m, obsgeovel=(40.159527, 287.47873161, -0.04597922) m / s): (ra, dec, distance) in (deg, deg, km)</span>
<span class="go">    (165.51854528, 2.32861794, 407229.55638763)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_body_barycentric</span><span class="p">(</span><span class="s1">&#39;moon&#39;</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span> 
<span class="go">&lt;CartesianRepresentation (x, y, z) in km</span>
<span class="go">    (1.50107535e+08, -866789.11996916, -418963.55218495)&gt;</span>
</pre></div>
</div>
<p>For one-off calculations with a given ephemeris, you can also pass it directly
to the various functions:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">get_body_barycentric</span><span class="p">(</span><span class="s1">&#39;moon&#39;</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">ephemeris</span><span class="o">=</span><span class="s1">&#39;de432s&#39;</span><span class="p">)</span>
<span class="gp">... </span>
<span class="go">&lt;CartesianRepresentation (x, y, z) in km</span>
<span class="go">    (1.50107535e+08, -866789.11996916, -418963.55218495)&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">get_body_barycentric</span><span class="p">(</span><span class="s1">&#39;moon&#39;</span><span class="p">,</span> <span class="n">t</span><span class="p">,</span> <span class="n">ephemeris</span><span class="o">=</span><span class="s1">&#39;builtin&#39;</span><span class="p">)</span>
<span class="gp">... </span>
<span class="go">&lt;CartesianRepresentation (x, y, z) in AU</span>
<span class="go">    (1.00340683, -0.00579417, -0.00280064)&gt;</span>
</pre></div>
</div>
<p>For a list of the bodies for which positions can be calculated, do:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">solar_system_ephemeris</span><span class="o">.</span><span class="n">bodies</span> 
<span class="go">(&#39;sun&#39;,</span>
<span class="go"> &#39;mercury&#39;,</span>
<span class="go"> &#39;venus&#39;,</span>
<span class="go"> &#39;earth-moon-barycenter&#39;,</span>
<span class="go"> &#39;earth&#39;,</span>
<span class="go"> &#39;moon&#39;,</span>
<span class="go"> &#39;mars&#39;,</span>
<span class="go"> &#39;jupiter&#39;,</span>
<span class="go"> &#39;saturn&#39;,</span>
<span class="go"> &#39;uranus&#39;,</span>
<span class="go"> &#39;neptune&#39;,</span>
<span class="go"> &#39;pluto&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solar_system_ephemeris</span><span class="o">.</span><span class="n">set</span><span class="p">(</span><span class="s1">&#39;builtin&#39;</span><span class="p">)</span>
<span class="go">&lt;ScienceState solar_system_ephemeris: &#39;builtin&#39;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">solar_system_ephemeris</span><span class="o">.</span><span class="n">bodies</span>
<span class="go">(&#39;earth&#39;,</span>
<span class="go"> &#39;sun&#39;,</span>
<span class="go"> &#39;moon&#39;,</span>
<span class="go"> &#39;mercury&#39;,</span>
<span class="go"> &#39;venus&#39;,</span>
<span class="go"> &#39;earth-moon-barycenter&#39;,</span>
<span class="go"> &#39;mars&#39;,</span>
<span class="go"> &#39;jupiter&#39;,</span>
<span class="go"> &#39;saturn&#39;,</span>
<span class="go"> &#39;uranus&#39;,</span>
<span class="go"> &#39;neptune&#39;)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>While the sun is included in the these ephemerides, it is important to
recognize that <a class="reference internal" href="../api/astropy.coordinates.get_sun.html#astropy.coordinates.get_sun" title="astropy.coordinates.get_sun"><code class="xref py py-obj docutils literal notranslate"><span class="pre">get_sun</span></code></a> always uses the built-in,
polynomial model (as this requires no special download). So it is not safe
to assume that <code class="docutils literal notranslate"><span class="pre">get_body(time,</span> <span class="pre">'sun')</span></code> and <code class="docutils literal notranslate"><span class="pre">get_sun(time)</span></code> will give
the same result.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>When using JPL ephemerides, be aware that answers may change at levels that
can be surprising if you are not careful about understanding the frame you
are in.  See for example the case of the DE440s ephemerides, which is
described in more detail in
<a class="reference external" href="https://github.com/astropy/astropy/pull/11608">astropy PR #11608</a>. So
it is usually best to stay within the same ephemerides for consistency.</p>
</div>
</div>
<div class="section" id="precision-of-the-built-in-ephemeris">
<span id="astropy-coordinates-solarsystem-erfa-precision"></span><h2>Precision of the Built-In Ephemeris<a class="headerlink" href="#precision-of-the-built-in-ephemeris" title="Permalink to this headline">¶</a></h2>
<p>The algorithm for calculating positions and velocities for planets other than
Earth used by <a class="reference external" href="https://github.com/liberfa/erfa">ERFA</a> is due to J.L. Simon, P. Bretagnon, J. Chapront,
M. Chapront-Touze, G. Francou and J. Laskar (Bureau des Longitudes, Paris,
France).  From comparisons with JPL ephemeris DE102, they quote the maximum
errors over the interval 1800-2050 below. For more details, see the <a class="reference external" href="http://pyerfa.readthedocs.org/">PyERFA</a> routine, <a class="reference external" href="https://pyerfa.readthedocs.io/en/stable/api/erfa.plan94.html#erfa.plan94" title="(in PyERFA v2.0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">erfa.plan94</span></code></a>.
For the Earth, the rms errors in position and velocity are about 4.6 km and
1.4 mm/s, respectively (see <a class="reference external" href="https://pyerfa.readthedocs.io/en/stable/api/erfa.epv00.html#erfa.epv00" title="(in PyERFA v2.0)"><code class="xref py py-obj docutils literal notranslate"><span class="pre">erfa.epv00</span></code></a>).</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>Planet</p></td>
<td><p>L (arcsec)</p></td>
<td><p>B (arcsec)</p></td>
<td><p>R (km)</p></td>
</tr>
<tr class="row-even"><td><p>Mercury</p></td>
<td><p>4</p></td>
<td><p>1</p></td>
<td><p>300</p></td>
</tr>
<tr class="row-odd"><td><p>Venus</p></td>
<td><p>5</p></td>
<td><p>1</p></td>
<td><p>800</p></td>
</tr>
<tr class="row-even"><td><p>EMB</p></td>
<td><p>6</p></td>
<td><p>1</p></td>
<td><p>1000</p></td>
</tr>
<tr class="row-odd"><td><p>Mars</p></td>
<td><p>17</p></td>
<td><p>1</p></td>
<td><p>7700</p></td>
</tr>
<tr class="row-even"><td><p>Jupiter</p></td>
<td><p>71</p></td>
<td><p>5</p></td>
<td><p>76000</p></td>
</tr>
<tr class="row-odd"><td><p>Saturn</p></td>
<td><p>81</p></td>
<td><p>13</p></td>
<td><p>267000</p></td>
</tr>
<tr class="row-even"><td><p>Uranus</p></td>
<td><p>86</p></td>
<td><p>7</p></td>
<td><p>712000</p></td>
</tr>
<tr class="row-odd"><td><p>Neptune</p></td>
<td><p>11</p></td>
<td><p>1</p></td>
<td><p>253000</p></td>
</tr>
</tbody>
</table>
</div>
</div>


            <div class="clearer"></div>
          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper"><h3>Page Contents</h3>
<ul>
<li><a class="reference internal" href="#">Solar System Ephemerides</a><ul>
<li><a class="reference internal" href="#examples">Examples</a></li>
<li><a class="reference internal" href="#precision-of-the-built-in-ephemeris">Precision of the Built-In Ephemeris</a></li>
</ul>
</li>
</ul>


        </div>
      </div>
      <div class="clearer"></div>
    </div>
<footer class="footer">
  <p class="pull-right">
    <a href="../_sources/coordinates/solarsystem.rst.txt"
       rel="nofollow">Page Source</a> &nbsp;
    <a href="#">Back to Top</a></p>
  <p>
    &copy; Copyright 2011–2022, The Astropy Developers.<br/>
    Created using <a href="http://www.sphinx-doc.org/en/stable/">Sphinx</a> 3.5.4. &nbsp;
    Last built 08 May 2022. <br/>
  </p>
</footer>
  </body>
</html>